import{a as _c,c as hr,r as xi,e as w1,h as se,j as b1,w as Bl,k as Vl,l as wc,t as vo,m as E1,n as bi,D as x1,o as I1,N as Z,s as P1,v as hc,x as S1,V as C1,R as O1,y as Lh,K as R1,z as A1,L as T1,A as Fh,$ as N1,B as L1,E as Js,Z as Dh,J as F1,X as D1,_ as Kl,G as Dr,H as $1,I as q1,M as hs,O as Ft,U as tr,Q as wi,S as ur,T as M1,Y as ls,a0 as Gl,a1 as j1,a2 as U1,a3 as z1,a4 as Wl,a5 as k1,a6 as Jl,a7 as Ql,a8 as ps,a9 as lc,aa as uo,ab as gs,ac as H1,ad as ho,ae as B1,af as V1,ag as K1,ah as no,ai as G1,aj as W1,ak as Wa,al as $h,am as J1,an as Q1,ao as Y1,ap as qh,aq as X1,ar as Z1,as as em,at as tm,au as rm,av as im,aw as sm,ax as Ks,ay as Yl,az as Ja,aA as nm,aB as om}from"./index-de26da20.js";var bc={exports:{}},ds=typeof Reflect=="object"?Reflect:null,Mh=ds&&typeof ds.apply=="function"?ds.apply:function(i,r,n){return Function.prototype.apply.call(i,r,n)},lo;ds&&typeof ds.ownKeys=="function"?lo=ds.ownKeys:Object.getOwnPropertySymbols?lo=function(i){return Object.getOwnPropertyNames(i).concat(Object.getOwnPropertySymbols(i))}:lo=function(i){return Object.getOwnPropertyNames(i)};function am(c){console&&console.warn&&console.warn(c)}var Xl=Number.isNaN||function(i){return i!==i};function He(){He.init.call(this)}bc.exports=He;bc.exports.once=lm;He.EventEmitter=He;He.prototype._events=void 0;He.prototype._eventsCount=0;He.prototype._maxListeners=void 0;var jh=10;function mo(c){if(typeof c!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof c)}Object.defineProperty(He,"defaultMaxListeners",{enumerable:!0,get:function(){return jh},set:function(c){if(typeof c!="number"||c<0||Xl(c))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+c+".");jh=c}});He.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};He.prototype.setMaxListeners=function(i){if(typeof i!="number"||i<0||Xl(i))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+i+".");return this._maxListeners=i,this};function Zl(c){return c._maxListeners===void 0?He.defaultMaxListeners:c._maxListeners}He.prototype.getMaxListeners=function(){return Zl(this)};He.prototype.emit=function(i){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var o=i==="error",h=this._events;if(h!==void 0)o=o&&h.error===void 0;else if(!o)return!1;if(o){var p;if(r.length>0&&(p=r[0]),p instanceof Error)throw p;var y=new Error("Unhandled error."+(p?" ("+p.message+")":""));throw y.context=p,y}var _=h[i];if(_===void 0)return!1;if(typeof _=="function")Mh(_,this,r);else for(var C=_.length,L=nf(_,C),n=0;n<C;++n)Mh(L[n],this,r);return!0};function ef(c,i,r,n){var o,h,p;if(mo(r),h=c._events,h===void 0?(h=c._events=Object.create(null),c._eventsCount=0):(h.newListener!==void 0&&(c.emit("newListener",i,r.listener?r.listener:r),h=c._events),p=h[i]),p===void 0)p=h[i]=r,++c._eventsCount;else if(typeof p=="function"?p=h[i]=n?[r,p]:[p,r]:n?p.unshift(r):p.push(r),o=Zl(c),o>0&&p.length>o&&!p.warned){p.warned=!0;var y=new Error("Possible EventEmitter memory leak detected. "+p.length+" "+String(i)+" listeners added. Use emitter.setMaxListeners() to increase limit");y.name="MaxListenersExceededWarning",y.emitter=c,y.type=i,y.count=p.length,am(y)}return c}He.prototype.addListener=function(i,r){return ef(this,i,r,!1)};He.prototype.on=He.prototype.addListener;He.prototype.prependListener=function(i,r){return ef(this,i,r,!0)};function cm(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function tf(c,i,r){var n={fired:!1,wrapFn:void 0,target:c,type:i,listener:r},o=cm.bind(n);return o.listener=r,n.wrapFn=o,o}He.prototype.once=function(i,r){return mo(r),this.on(i,tf(this,i,r)),this};He.prototype.prependOnceListener=function(i,r){return mo(r),this.prependListener(i,tf(this,i,r)),this};He.prototype.removeListener=function(i,r){var n,o,h,p,y;if(mo(r),o=this._events,o===void 0)return this;if(n=o[i],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete o[i],o.removeListener&&this.emit("removeListener",i,n.listener||r));else if(typeof n!="function"){for(h=-1,p=n.length-1;p>=0;p--)if(n[p]===r||n[p].listener===r){y=n[p].listener,h=p;break}if(h<0)return this;h===0?n.shift():um(n,h),n.length===1&&(o[i]=n[0]),o.removeListener!==void 0&&this.emit("removeListener",i,y||r)}return this};He.prototype.off=He.prototype.removeListener;He.prototype.removeAllListeners=function(i){var r,n,o;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[i]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[i]),this;if(arguments.length===0){var h=Object.keys(n),p;for(o=0;o<h.length;++o)p=h[o],p!=="removeListener"&&this.removeAllListeners(p);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[i],typeof r=="function")this.removeListener(i,r);else if(r!==void 0)for(o=r.length-1;o>=0;o--)this.removeListener(i,r[o]);return this};function rf(c,i,r){var n=c._events;if(n===void 0)return[];var o=n[i];return o===void 0?[]:typeof o=="function"?r?[o.listener||o]:[o]:r?hm(o):nf(o,o.length)}He.prototype.listeners=function(i){return rf(this,i,!0)};He.prototype.rawListeners=function(i){return rf(this,i,!1)};He.listenerCount=function(c,i){return typeof c.listenerCount=="function"?c.listenerCount(i):sf.call(c,i)};He.prototype.listenerCount=sf;function sf(c){var i=this._events;if(i!==void 0){var r=i[c];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}He.prototype.eventNames=function(){return this._eventsCount>0?lo(this._events):[]};function nf(c,i){for(var r=new Array(i),n=0;n<i;++n)r[n]=c[n];return r}function um(c,i){for(;i+1<c.length;i++)c[i]=c[i+1];c.pop()}function hm(c){for(var i=new Array(c.length),r=0;r<i.length;++r)i[r]=c[r].listener||c[r];return i}function lm(c,i){return new Promise(function(r,n){function o(p){c.removeListener(i,h),n(p)}function h(){typeof c.removeListener=="function"&&c.removeListener("error",o),r([].slice.call(arguments))}of(c,i,h,{once:!0}),i!=="error"&&fm(c,o,{once:!0})})}function fm(c,i,r){typeof c.on=="function"&&of(c,"error",i,r)}function of(c,i,r,n){if(typeof c.on=="function")n.once?c.once(i,r):c.on(i,r);else if(typeof c.addEventListener=="function")c.addEventListener(i,function o(h){n.once&&c.removeEventListener(i,o),r(h)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof c)}var vr=bc.exports;const Ec=_c(vr);var _o={},Xs={};Object.defineProperty(Xs,"__esModule",{value:!0});function pm(c){if(typeof c!="string")throw new Error(`Cannot safe json parse value of type ${typeof c}`);try{return JSON.parse(c)}catch{return c}}Xs.safeJsonParse=pm;function dm(c){return typeof c=="string"?c:JSON.stringify(c,(i,r)=>typeof r>"u"?null:r)}Xs.safeJsonStringify=dm;var $s={exports:{}},Uh;function gm(){return Uh||(Uh=1,function(){let c;function i(){}c=i,c.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},c.prototype.setItem=function(r,n){this[r]=String(n)},c.prototype.removeItem=function(r){delete this[r]},c.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},c.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},c.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof hr<"u"&&hr.localStorage?$s.exports=hr.localStorage:typeof window<"u"&&window.localStorage?$s.exports=window.localStorage:$s.exports=new i}()),$s.exports}var Qa={},qs={},zh;function ym(){if(zh)return qs;zh=1,Object.defineProperty(qs,"__esModule",{value:!0}),qs.IKeyValueStorage=void 0;class c{}return qs.IKeyValueStorage=c,qs}var Ms={},kh;function vm(){if(kh)return Ms;kh=1,Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.parseEntry=void 0;const c=Xs;function i(r){var n;return[r[0],c.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return Ms.parseEntry=i,Ms}var Hh;function mm(){return Hh||(Hh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0});const i=xi;i.__exportStar(ym(),c),i.__exportStar(vm(),c)}(Qa)),Qa}Object.defineProperty(_o,"__esModule",{value:!0});_o.KeyValueStorage=void 0;const fs=xi,Bh=Xs,_m=fs.__importDefault(gm()),wm=mm();class af{constructor(){this.localStorage=_m.default}getKeys(){return fs.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return fs.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(wm.parseEntry)})}getItem(i){return fs.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(i);if(r!==null)return Bh.safeJsonParse(r)})}setItem(i,r){return fs.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(i,Bh.safeJsonStringify(r))})}removeItem(i){return fs.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(i)})}}_o.KeyValueStorage=af;var bm=_o.default=af,ys={},js={},Ya={},Us={};let ki=class{};const Em=Object.freeze(Object.defineProperty({__proto__:null,IEvents:ki},Symbol.toStringTag,{value:"Module"})),xm=w1(Em);var Vh;function Im(){if(Vh)return Us;Vh=1,Object.defineProperty(Us,"__esModule",{value:!0}),Us.IHeartBeat=void 0;const c=xm;class i extends c.IEvents{constructor(n){super()}}return Us.IHeartBeat=i,Us}var Kh;function cf(){return Kh||(Kh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),xi.__exportStar(Im(),c)}(Ya)),Ya}var Xa={},Ui={},Gh;function Pm(){if(Gh)return Ui;Gh=1,Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.HEARTBEAT_EVENTS=Ui.HEARTBEAT_INTERVAL=void 0;const c=se;return Ui.HEARTBEAT_INTERVAL=c.FIVE_SECONDS,Ui.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Ui}var Wh;function uf(){return Wh||(Wh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),xi.__exportStar(Pm(),c)}(Xa)),Xa}var Jh;function Sm(){if(Jh)return js;Jh=1,Object.defineProperty(js,"__esModule",{value:!0}),js.HeartBeat=void 0;const c=xi,i=vr,r=se,n=cf(),o=uf();class h extends n.IHeartBeat{constructor(y){super(y),this.events=new i.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(y==null?void 0:y.interval)||o.HEARTBEAT_INTERVAL}static init(y){return c.__awaiter(this,void 0,void 0,function*(){const _=new h(y);return yield _.init(),_})}init(){return c.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(y,_){this.events.on(y,_)}once(y,_){this.events.once(y,_)}off(y,_){this.events.off(y,_)}removeListener(y,_){this.events.removeListener(y,_)}initialize(){return c.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return js.HeartBeat=h,js}(function(c){Object.defineProperty(c,"__esModule",{value:!0});const i=xi;i.__exportStar(Sm(),c),i.__exportStar(cf(),c),i.__exportStar(uf(),c)})(ys);var Ae={},Za,Qh;function Cm(){if(Qh)return Za;Qh=1;function c(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Za=i;function i(r,n,o){var h=o&&o.stringify||c,p=1;if(typeof r=="object"&&r!==null){var y=n.length+p;if(y===1)return r;var _=new Array(y);_[0]=h(r);for(var C=1;C<y;C++)_[C]=h(n[C]);return _.join(" ")}if(typeof r!="string")return r;var L=n.length;if(L===0)return r;for(var k="",B=1-p,K=-1,q=r&&r.length||0,W=0;W<q;){if(r.charCodeAt(W)===37&&W+1<q){switch(K=K>-1?K:0,r.charCodeAt(W+1)){case 100:case 102:if(B>=L||n[B]==null)break;K<W&&(k+=r.slice(K,W)),k+=Number(n[B]),K=W+2,W++;break;case 105:if(B>=L||n[B]==null)break;K<W&&(k+=r.slice(K,W)),k+=Math.floor(Number(n[B])),K=W+2,W++;break;case 79:case 111:case 106:if(B>=L||n[B]===void 0)break;K<W&&(k+=r.slice(K,W));var ie=typeof n[B];if(ie==="string"){k+="'"+n[B]+"'",K=W+2,W++;break}if(ie==="function"){k+=n[B].name||"<anonymous>",K=W+2,W++;break}k+=h(n[B]),K=W+2,W++;break;case 115:if(B>=L)break;K<W&&(k+=r.slice(K,W)),k+=String(n[B]),K=W+2,W++;break;case 37:K<W&&(k+=r.slice(K,W)),k+="%",K=W+2,W++,B--;break}++B}++W}return K===-1?r:(K<q&&(k+=r.slice(K)),k)}return Za}var ec,Yh;function Om(){if(Yh)return ec;Yh=1;const c=Cm();ec=o;const i=le().console||{},r={mapHttpRequest:q,mapHttpResponse:q,wrapRequestSerializer:W,wrapResponseSerializer:W,wrapErrorSerializer:W,req:q,res:q,err:B};function n(T,M){return Array.isArray(T)?T.filter(function(ye){return ye!=="!stdSerializers.err"}):T===!0?Object.keys(M):!1}function o(T){T=T||{},T.browser=T.browser||{};const M=T.browser.transmit;if(M&&typeof M.send!="function")throw Error("pino: transmit option must have a send function");const G=T.browser.write||i;T.browser.write&&(T.browser.asObject=!0);const ye=T.serializers||{},re=n(T.browser.serialize,ye);let ue=T.browser.serialize;Array.isArray(T.browser.serialize)&&T.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Te=["error","fatal","warn","info","debug","trace"];typeof G=="function"&&(G.error=G.fatal=G.warn=G.info=G.debug=G.trace=G),T.enabled===!1&&(T.level="silent");const Ue=T.level||"info",v=Object.create(G);v.log||(v.log=ie),Object.defineProperty(v,"levelVal",{get:Y}),Object.defineProperty(v,"level",{get:ce,set:H});const E={transmit:M,serialize:re,asObject:T.browser.asObject,levels:Te,timestamp:K(T)};v.levels=o.levels,v.level=Ue,v.setMaxListeners=v.getMaxListeners=v.emit=v.addListener=v.on=v.prependListener=v.once=v.prependOnceListener=v.removeListener=v.removeAllListeners=v.listeners=v.listenerCount=v.eventNames=v.write=v.flush=ie,v.serializers=ye,v._serialize=re,v._stdErrSerialize=ue,v.child=j,M&&(v._logEvent=k());function Y(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function H(z){if(z!=="silent"&&!this.levels.values[z])throw Error("unknown level "+z);this._level=z,h(E,v,"error","log"),h(E,v,"fatal","error"),h(E,v,"warn","error"),h(E,v,"info","log"),h(E,v,"debug","log"),h(E,v,"trace","log")}function j(z,V){if(!z)throw new Error("missing bindings for child Pino");V=V||{},re&&z.serializers&&(V.serializers=z.serializers);const Qe=V.serializers;if(re&&Qe){var Be=Object.assign({},ye,Qe),qr=T.browser.serialize===!0?Object.keys(Be):re;delete z.serializers,_([z],qr,Be,this._stdErrSerialize)}function xe(It){this._childLevel=(It._childLevel|0)+1,this.error=C(It,z,"error"),this.fatal=C(It,z,"fatal"),this.warn=C(It,z,"warn"),this.info=C(It,z,"info"),this.debug=C(It,z,"debug"),this.trace=C(It,z,"trace"),Be&&(this.serializers=Be,this._serialize=qr),M&&(this._logEvent=k([].concat(It._logEvent.bindings,z)))}return xe.prototype=this,new xe(this)}return v}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:Ee,epochTime:ge,unixTime:pe,isoTime:he});function h(T,M,G,ye){const re=Object.getPrototypeOf(M);M[G]=M.levelVal>M.levels.values[G]?ie:re[G]?re[G]:i[G]||i[ye]||ie,p(T,M,G)}function p(T,M,G){!T.transmit&&M[G]===ie||(M[G]=function(ye){return function(){const ue=T.timestamp(),Te=new Array(arguments.length),Ue=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this;for(var v=0;v<Te.length;v++)Te[v]=arguments[v];if(T.serialize&&!T.asObject&&_(Te,this._serialize,this.serializers,this._stdErrSerialize),T.asObject?ye.call(Ue,y(this,G,Te,ue)):ye.apply(Ue,Te),T.transmit){const E=T.transmit.level||M.level,Y=o.levels.values[E],ce=o.levels.values[G];if(ce<Y)return;L(this,{ts:ue,methodLevel:G,methodValue:ce,transmitLevel:E,transmitValue:o.levels.values[T.transmit.level||M.level],send:T.transmit.send,val:M.levelVal},Te)}}}(M[G]))}function y(T,M,G,ye){T._serialize&&_(G,T._serialize,T.serializers,T._stdErrSerialize);const re=G.slice();let ue=re[0];const Te={};ye&&(Te.time=ye),Te.level=o.levels.values[M];let Ue=(T._childLevel|0)+1;if(Ue<1&&(Ue=1),ue!==null&&typeof ue=="object"){for(;Ue--&&typeof re[0]=="object";)Object.assign(Te,re.shift());ue=re.length?c(re.shift(),re):void 0}else typeof ue=="string"&&(ue=c(re.shift(),re));return ue!==void 0&&(Te.msg=ue),Te}function _(T,M,G,ye){for(const re in T)if(ye&&T[re]instanceof Error)T[re]=o.stdSerializers.err(T[re]);else if(typeof T[re]=="object"&&!Array.isArray(T[re]))for(const ue in T[re])M&&M.indexOf(ue)>-1&&ue in G&&(T[re][ue]=G[ue](T[re][ue]))}function C(T,M,G){return function(){const ye=new Array(1+arguments.length);ye[0]=M;for(var re=1;re<ye.length;re++)ye[re]=arguments[re-1];return T[G].apply(this,ye)}}function L(T,M,G){const ye=M.send,re=M.ts,ue=M.methodLevel,Te=M.methodValue,Ue=M.val,v=T._logEvent.bindings;_(G,T._serialize||Object.keys(T.serializers),T.serializers,T._stdErrSerialize===void 0?!0:T._stdErrSerialize),T._logEvent.ts=re,T._logEvent.messages=G.filter(function(E){return v.indexOf(E)===-1}),T._logEvent.level.label=ue,T._logEvent.level.value=Te,ye(ue,T._logEvent,Ue),T._logEvent=k(v)}function k(T){return{ts:0,messages:[],bindings:T||[],level:{label:"",value:0}}}function B(T){const M={type:T.constructor.name,msg:T.message,stack:T.stack};for(const G in T)M[G]===void 0&&(M[G]=T[G]);return M}function K(T){return typeof T.timestamp=="function"?T.timestamp:T.timestamp===!1?Ee:ge}function q(){return{}}function W(T){return T}function ie(){}function Ee(){return!1}function ge(){return Date.now()}function pe(){return Math.round(Date.now()/1e3)}function he(){return new Date(Date.now()).toISOString()}function le(){function T(M){return typeof M<"u"&&M}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return T(self)||T(window)||T(this)||{}}}return ec}var zi={},Xh;function hf(){return Xh||(Xh=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.PINO_CUSTOM_CONTEXT_KEY=zi.PINO_LOGGER_DEFAULTS=void 0,zi.PINO_LOGGER_DEFAULTS={level:"info"},zi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),zi}var er={},Zh;function Rm(){if(Zh)return er;Zh=1,Object.defineProperty(er,"__esModule",{value:!0}),er.generateChildLogger=er.formatChildLoggerContext=er.getLoggerContext=er.setBrowserLoggerContext=er.getBrowserLoggerContext=er.getDefaultLoggerOptions=void 0;const c=hf();function i(y){return Object.assign(Object.assign({},y),{level:(y==null?void 0:y.level)||c.PINO_LOGGER_DEFAULTS.level})}er.getDefaultLoggerOptions=i;function r(y,_=c.PINO_CUSTOM_CONTEXT_KEY){return y[_]||""}er.getBrowserLoggerContext=r;function n(y,_,C=c.PINO_CUSTOM_CONTEXT_KEY){return y[C]=_,y}er.setBrowserLoggerContext=n;function o(y,_=c.PINO_CUSTOM_CONTEXT_KEY){let C="";return typeof y.bindings>"u"?C=r(y,_):C=y.bindings().context||"",C}er.getLoggerContext=o;function h(y,_,C=c.PINO_CUSTOM_CONTEXT_KEY){const L=o(y,C);return L.trim()?`${L}/${_}`:_}er.formatChildLoggerContext=h;function p(y,_,C=c.PINO_CUSTOM_CONTEXT_KEY){const L=h(y,_,C),k=y.child({context:L});return n(k,L,C)}return er.generateChildLogger=p,er}(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.pino=void 0;const i=xi,r=i.__importDefault(Om());Object.defineProperty(c,"pino",{enumerable:!0,get:function(){return r.default}}),i.__exportStar(hf(),c),i.__exportStar(Rm(),c)})(Ae);class Am extends ki{constructor(i){super(),this.opts=i,this.protocol="wc",this.version=2}}class Tm extends ki{constructor(i,r){super(),this.core=i,this.logger=r,this.records=new Map}}class Nm{constructor(i,r){this.logger=i,this.core=r}}let Lm=class extends ki{constructor(i,r){super(),this.relayer=i,this.logger=r}},Fm=class extends ki{constructor(i){super()}},Dm=class{constructor(i,r,n,o){this.core=i,this.logger=r,this.name=n}};class $m extends ki{constructor(i,r){super(),this.relayer=i,this.logger=r}}let qm=class extends ki{constructor(i,r){super(),this.core=i,this.logger=r}},Mm=class{constructor(i,r){this.projectId=i,this.logger=r}},jm=class{constructor(i){this.opts=i,this.protocol="wc",this.version=2}},Um=class{constructor(i){this.client=i}};const zm=c=>JSON.stringify(c,(i,r)=>typeof r=="bigint"?r.toString()+"n":r),km=c=>{const i=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=c.replace(i,'$1"$2n"$3');return JSON.parse(r,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function xc(c){if(typeof c!="string")throw new Error(`Cannot safe json parse value of type ${typeof c}`);try{return km(c)}catch{return c}}function Qs(c){return typeof c=="string"?c:zm(c)||""}var Ic={},lf={};(function(c){Object.defineProperty(c,"__esModule",{value:!0});var i=b1,r=Bl;c.DIGEST_LENGTH=64,c.BLOCK_SIZE=128;var n=function(){function y(){this.digestLength=c.DIGEST_LENGTH,this.blockSize=c.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return y.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},y.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},y.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},y.prototype.update=function(_,C){if(C===void 0&&(C=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var L=0;if(this._bytesHashed+=C,this._bufferLength>0){for(;this._bufferLength<c.BLOCK_SIZE&&C>0;)this._buffer[this._bufferLength++]=_[L++],C--;this._bufferLength===this.blockSize&&(h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(C>=this.blockSize&&(L=h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,L,C),C%=this.blockSize);C>0;)this._buffer[this._bufferLength++]=_[L++],C--;return this},y.prototype.finish=function(_){if(!this._finished){var C=this._bytesHashed,L=this._bufferLength,k=C/536870912|0,B=C<<3,K=C%128<112?128:256;this._buffer[L]=128;for(var q=L+1;q<K-8;q++)this._buffer[q]=0;i.writeUint32BE(k,this._buffer,K-8),i.writeUint32BE(B,this._buffer,K-4),h(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,K),this._finished=!0}for(var q=0;q<this.digestLength/8;q++)i.writeUint32BE(this._stateHi[q],_,q*8),i.writeUint32BE(this._stateLo[q],_,q*8+4);return this},y.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},y.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},y.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},y.prototype.cleanSavedState=function(_){r.wipe(_.stateHi),r.wipe(_.stateLo),_.buffer&&r.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},y}();c.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function h(y,_,C,L,k,B,K){for(var q=C[0],W=C[1],ie=C[2],Ee=C[3],ge=C[4],pe=C[5],he=C[6],le=C[7],T=L[0],M=L[1],G=L[2],ye=L[3],re=L[4],ue=L[5],Te=L[6],Ue=L[7],v,E,Y,ce,H,j,z,V;K>=128;){for(var Qe=0;Qe<16;Qe++){var Be=8*Qe+B;y[Qe]=i.readUint32BE(k,Be),_[Qe]=i.readUint32BE(k,Be+4)}for(var Qe=0;Qe<80;Qe++){var qr=q,xe=W,It=ie,A=Ee,R=ge,S=pe,u=he,b=le,ee=T,fe=M,we=G,Ne=ye,Fe=re,Se=ue,Pt=Te,mt=Ue;if(v=le,E=Ue,H=E&65535,j=E>>>16,z=v&65535,V=v>>>16,v=(ge>>>14|re<<32-14)^(ge>>>18|re<<32-18)^(re>>>41-32|ge<<32-(41-32)),E=(re>>>14|ge<<32-14)^(re>>>18|ge<<32-18)^(ge>>>41-32|re<<32-(41-32)),H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,v=ge&pe^~ge&he,E=re&ue^~re&Te,H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,v=o[Qe*2],E=o[Qe*2+1],H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,v=y[Qe%16],E=_[Qe%16],H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,Y=z&65535|V<<16,ce=H&65535|j<<16,v=Y,E=ce,H=E&65535,j=E>>>16,z=v&65535,V=v>>>16,v=(q>>>28|T<<32-28)^(T>>>34-32|q<<32-(34-32))^(T>>>39-32|q<<32-(39-32)),E=(T>>>28|q<<32-28)^(q>>>34-32|T<<32-(34-32))^(q>>>39-32|T<<32-(39-32)),H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,v=q&W^q&ie^W&ie,E=T&M^T&G^M&G,H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,b=z&65535|V<<16,mt=H&65535|j<<16,v=A,E=Ne,H=E&65535,j=E>>>16,z=v&65535,V=v>>>16,v=Y,E=ce,H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,A=z&65535|V<<16,Ne=H&65535|j<<16,W=qr,ie=xe,Ee=It,ge=A,pe=R,he=S,le=u,q=b,M=ee,G=fe,ye=we,re=Ne,ue=Fe,Te=Se,Ue=Pt,T=mt,Qe%16===15)for(var Be=0;Be<16;Be++)v=y[Be],E=_[Be],H=E&65535,j=E>>>16,z=v&65535,V=v>>>16,v=y[(Be+9)%16],E=_[(Be+9)%16],H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,Y=y[(Be+1)%16],ce=_[(Be+1)%16],v=(Y>>>1|ce<<32-1)^(Y>>>8|ce<<32-8)^Y>>>7,E=(ce>>>1|Y<<32-1)^(ce>>>8|Y<<32-8)^(ce>>>7|Y<<32-7),H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,Y=y[(Be+14)%16],ce=_[(Be+14)%16],v=(Y>>>19|ce<<32-19)^(ce>>>61-32|Y<<32-(61-32))^Y>>>6,E=(ce>>>19|Y<<32-19)^(Y>>>61-32|ce<<32-(61-32))^(ce>>>6|Y<<32-6),H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,y[Be]=z&65535|V<<16,_[Be]=H&65535|j<<16}v=q,E=T,H=E&65535,j=E>>>16,z=v&65535,V=v>>>16,v=C[0],E=L[0],H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,C[0]=q=z&65535|V<<16,L[0]=T=H&65535|j<<16,v=W,E=M,H=E&65535,j=E>>>16,z=v&65535,V=v>>>16,v=C[1],E=L[1],H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,C[1]=W=z&65535|V<<16,L[1]=M=H&65535|j<<16,v=ie,E=G,H=E&65535,j=E>>>16,z=v&65535,V=v>>>16,v=C[2],E=L[2],H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,C[2]=ie=z&65535|V<<16,L[2]=G=H&65535|j<<16,v=Ee,E=ye,H=E&65535,j=E>>>16,z=v&65535,V=v>>>16,v=C[3],E=L[3],H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,C[3]=Ee=z&65535|V<<16,L[3]=ye=H&65535|j<<16,v=ge,E=re,H=E&65535,j=E>>>16,z=v&65535,V=v>>>16,v=C[4],E=L[4],H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,C[4]=ge=z&65535|V<<16,L[4]=re=H&65535|j<<16,v=pe,E=ue,H=E&65535,j=E>>>16,z=v&65535,V=v>>>16,v=C[5],E=L[5],H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,C[5]=pe=z&65535|V<<16,L[5]=ue=H&65535|j<<16,v=he,E=Te,H=E&65535,j=E>>>16,z=v&65535,V=v>>>16,v=C[6],E=L[6],H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,C[6]=he=z&65535|V<<16,L[6]=Te=H&65535|j<<16,v=le,E=Ue,H=E&65535,j=E>>>16,z=v&65535,V=v>>>16,v=C[7],E=L[7],H+=E&65535,j+=E>>>16,z+=v&65535,V+=v>>>16,j+=H>>>16,z+=j>>>16,V+=z>>>16,C[7]=le=z&65535|V<<16,L[7]=Ue=H&65535|j<<16,B+=128,K-=128}return B}function p(y){var _=new n;_.update(y);var C=_.digest();return _.clean(),C}c.hash=p})(lf);(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.convertSecretKeyToX25519=c.convertPublicKeyToX25519=c.verify=c.sign=c.extractPublicKeyFromSecretKey=c.generateKeyPair=c.generateKeyPairFromSeed=c.SEED_LENGTH=c.SECRET_KEY_LENGTH=c.PUBLIC_KEY_LENGTH=c.SIGNATURE_LENGTH=void 0;const i=Vl,r=lf,n=Bl;c.SIGNATURE_LENGTH=64,c.PUBLIC_KEY_LENGTH=32,c.SECRET_KEY_LENGTH=64,c.SEED_LENGTH=32;function o(A){const R=new Float64Array(16);if(A)for(let S=0;S<A.length;S++)R[S]=A[S];return R}const h=new Uint8Array(32);h[0]=9;const p=o(),y=o([1]),_=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),C=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),L=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),k=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),B=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function K(A,R){for(let S=0;S<16;S++)A[S]=R[S]|0}function q(A){let R=1;for(let S=0;S<16;S++){let u=A[S]+R+65535;R=Math.floor(u/65536),A[S]=u-R*65536}A[0]+=R-1+37*(R-1)}function W(A,R,S){const u=~(S-1);for(let b=0;b<16;b++){const ee=u&(A[b]^R[b]);A[b]^=ee,R[b]^=ee}}function ie(A,R){const S=o(),u=o();for(let b=0;b<16;b++)u[b]=R[b];q(u),q(u),q(u);for(let b=0;b<2;b++){S[0]=u[0]-65517;for(let fe=1;fe<15;fe++)S[fe]=u[fe]-65535-(S[fe-1]>>16&1),S[fe-1]&=65535;S[15]=u[15]-32767-(S[14]>>16&1);const ee=S[15]>>16&1;S[14]&=65535,W(u,S,1-ee)}for(let b=0;b<16;b++)A[2*b]=u[b]&255,A[2*b+1]=u[b]>>8}function Ee(A,R){let S=0;for(let u=0;u<32;u++)S|=A[u]^R[u];return(1&S-1>>>8)-1}function ge(A,R){const S=new Uint8Array(32),u=new Uint8Array(32);return ie(S,A),ie(u,R),Ee(S,u)}function pe(A){const R=new Uint8Array(32);return ie(R,A),R[0]&1}function he(A,R){for(let S=0;S<16;S++)A[S]=R[2*S]+(R[2*S+1]<<8);A[15]&=32767}function le(A,R,S){for(let u=0;u<16;u++)A[u]=R[u]+S[u]}function T(A,R,S){for(let u=0;u<16;u++)A[u]=R[u]-S[u]}function M(A,R,S){let u,b,ee=0,fe=0,we=0,Ne=0,Fe=0,Se=0,Pt=0,mt=0,ot=0,$e=0,Xe=0,Ze=0,at=0,ze=0,et=0,Le=0,Ve=0,ht=0,Me=0,St=0,Dt=0,zt=0,kt=0,Mt=0,Wt=0,rr=0,Mr=0,Jt=0,Kr=0,ui=0,Si=0,lt=S[0],it=S[1],ft=S[2],pt=S[3],ct=S[4],st=S[5],Ct=S[6],Ot=S[7],dt=S[8],Rt=S[9],gt=S[10],_t=S[11],yt=S[12],Ye=S[13],At=S[14],Tt=S[15];u=R[0],ee+=u*lt,fe+=u*it,we+=u*ft,Ne+=u*pt,Fe+=u*ct,Se+=u*st,Pt+=u*Ct,mt+=u*Ot,ot+=u*dt,$e+=u*Rt,Xe+=u*gt,Ze+=u*_t,at+=u*yt,ze+=u*Ye,et+=u*At,Le+=u*Tt,u=R[1],fe+=u*lt,we+=u*it,Ne+=u*ft,Fe+=u*pt,Se+=u*ct,Pt+=u*st,mt+=u*Ct,ot+=u*Ot,$e+=u*dt,Xe+=u*Rt,Ze+=u*gt,at+=u*_t,ze+=u*yt,et+=u*Ye,Le+=u*At,Ve+=u*Tt,u=R[2],we+=u*lt,Ne+=u*it,Fe+=u*ft,Se+=u*pt,Pt+=u*ct,mt+=u*st,ot+=u*Ct,$e+=u*Ot,Xe+=u*dt,Ze+=u*Rt,at+=u*gt,ze+=u*_t,et+=u*yt,Le+=u*Ye,Ve+=u*At,ht+=u*Tt,u=R[3],Ne+=u*lt,Fe+=u*it,Se+=u*ft,Pt+=u*pt,mt+=u*ct,ot+=u*st,$e+=u*Ct,Xe+=u*Ot,Ze+=u*dt,at+=u*Rt,ze+=u*gt,et+=u*_t,Le+=u*yt,Ve+=u*Ye,ht+=u*At,Me+=u*Tt,u=R[4],Fe+=u*lt,Se+=u*it,Pt+=u*ft,mt+=u*pt,ot+=u*ct,$e+=u*st,Xe+=u*Ct,Ze+=u*Ot,at+=u*dt,ze+=u*Rt,et+=u*gt,Le+=u*_t,Ve+=u*yt,ht+=u*Ye,Me+=u*At,St+=u*Tt,u=R[5],Se+=u*lt,Pt+=u*it,mt+=u*ft,ot+=u*pt,$e+=u*ct,Xe+=u*st,Ze+=u*Ct,at+=u*Ot,ze+=u*dt,et+=u*Rt,Le+=u*gt,Ve+=u*_t,ht+=u*yt,Me+=u*Ye,St+=u*At,Dt+=u*Tt,u=R[6],Pt+=u*lt,mt+=u*it,ot+=u*ft,$e+=u*pt,Xe+=u*ct,Ze+=u*st,at+=u*Ct,ze+=u*Ot,et+=u*dt,Le+=u*Rt,Ve+=u*gt,ht+=u*_t,Me+=u*yt,St+=u*Ye,Dt+=u*At,zt+=u*Tt,u=R[7],mt+=u*lt,ot+=u*it,$e+=u*ft,Xe+=u*pt,Ze+=u*ct,at+=u*st,ze+=u*Ct,et+=u*Ot,Le+=u*dt,Ve+=u*Rt,ht+=u*gt,Me+=u*_t,St+=u*yt,Dt+=u*Ye,zt+=u*At,kt+=u*Tt,u=R[8],ot+=u*lt,$e+=u*it,Xe+=u*ft,Ze+=u*pt,at+=u*ct,ze+=u*st,et+=u*Ct,Le+=u*Ot,Ve+=u*dt,ht+=u*Rt,Me+=u*gt,St+=u*_t,Dt+=u*yt,zt+=u*Ye,kt+=u*At,Mt+=u*Tt,u=R[9],$e+=u*lt,Xe+=u*it,Ze+=u*ft,at+=u*pt,ze+=u*ct,et+=u*st,Le+=u*Ct,Ve+=u*Ot,ht+=u*dt,Me+=u*Rt,St+=u*gt,Dt+=u*_t,zt+=u*yt,kt+=u*Ye,Mt+=u*At,Wt+=u*Tt,u=R[10],Xe+=u*lt,Ze+=u*it,at+=u*ft,ze+=u*pt,et+=u*ct,Le+=u*st,Ve+=u*Ct,ht+=u*Ot,Me+=u*dt,St+=u*Rt,Dt+=u*gt,zt+=u*_t,kt+=u*yt,Mt+=u*Ye,Wt+=u*At,rr+=u*Tt,u=R[11],Ze+=u*lt,at+=u*it,ze+=u*ft,et+=u*pt,Le+=u*ct,Ve+=u*st,ht+=u*Ct,Me+=u*Ot,St+=u*dt,Dt+=u*Rt,zt+=u*gt,kt+=u*_t,Mt+=u*yt,Wt+=u*Ye,rr+=u*At,Mr+=u*Tt,u=R[12],at+=u*lt,ze+=u*it,et+=u*ft,Le+=u*pt,Ve+=u*ct,ht+=u*st,Me+=u*Ct,St+=u*Ot,Dt+=u*dt,zt+=u*Rt,kt+=u*gt,Mt+=u*_t,Wt+=u*yt,rr+=u*Ye,Mr+=u*At,Jt+=u*Tt,u=R[13],ze+=u*lt,et+=u*it,Le+=u*ft,Ve+=u*pt,ht+=u*ct,Me+=u*st,St+=u*Ct,Dt+=u*Ot,zt+=u*dt,kt+=u*Rt,Mt+=u*gt,Wt+=u*_t,rr+=u*yt,Mr+=u*Ye,Jt+=u*At,Kr+=u*Tt,u=R[14],et+=u*lt,Le+=u*it,Ve+=u*ft,ht+=u*pt,Me+=u*ct,St+=u*st,Dt+=u*Ct,zt+=u*Ot,kt+=u*dt,Mt+=u*Rt,Wt+=u*gt,rr+=u*_t,Mr+=u*yt,Jt+=u*Ye,Kr+=u*At,ui+=u*Tt,u=R[15],Le+=u*lt,Ve+=u*it,ht+=u*ft,Me+=u*pt,St+=u*ct,Dt+=u*st,zt+=u*Ct,kt+=u*Ot,Mt+=u*dt,Wt+=u*Rt,rr+=u*gt,Mr+=u*_t,Jt+=u*yt,Kr+=u*Ye,ui+=u*At,Si+=u*Tt,ee+=38*Ve,fe+=38*ht,we+=38*Me,Ne+=38*St,Fe+=38*Dt,Se+=38*zt,Pt+=38*kt,mt+=38*Mt,ot+=38*Wt,$e+=38*rr,Xe+=38*Mr,Ze+=38*Jt,at+=38*Kr,ze+=38*ui,et+=38*Si,b=1,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=fe+b+65535,b=Math.floor(u/65536),fe=u-b*65536,u=we+b+65535,b=Math.floor(u/65536),we=u-b*65536,u=Ne+b+65535,b=Math.floor(u/65536),Ne=u-b*65536,u=Fe+b+65535,b=Math.floor(u/65536),Fe=u-b*65536,u=Se+b+65535,b=Math.floor(u/65536),Se=u-b*65536,u=Pt+b+65535,b=Math.floor(u/65536),Pt=u-b*65536,u=mt+b+65535,b=Math.floor(u/65536),mt=u-b*65536,u=ot+b+65535,b=Math.floor(u/65536),ot=u-b*65536,u=$e+b+65535,b=Math.floor(u/65536),$e=u-b*65536,u=Xe+b+65535,b=Math.floor(u/65536),Xe=u-b*65536,u=Ze+b+65535,b=Math.floor(u/65536),Ze=u-b*65536,u=at+b+65535,b=Math.floor(u/65536),at=u-b*65536,u=ze+b+65535,b=Math.floor(u/65536),ze=u-b*65536,u=et+b+65535,b=Math.floor(u/65536),et=u-b*65536,u=Le+b+65535,b=Math.floor(u/65536),Le=u-b*65536,ee+=b-1+37*(b-1),b=1,u=ee+b+65535,b=Math.floor(u/65536),ee=u-b*65536,u=fe+b+65535,b=Math.floor(u/65536),fe=u-b*65536,u=we+b+65535,b=Math.floor(u/65536),we=u-b*65536,u=Ne+b+65535,b=Math.floor(u/65536),Ne=u-b*65536,u=Fe+b+65535,b=Math.floor(u/65536),Fe=u-b*65536,u=Se+b+65535,b=Math.floor(u/65536),Se=u-b*65536,u=Pt+b+65535,b=Math.floor(u/65536),Pt=u-b*65536,u=mt+b+65535,b=Math.floor(u/65536),mt=u-b*65536,u=ot+b+65535,b=Math.floor(u/65536),ot=u-b*65536,u=$e+b+65535,b=Math.floor(u/65536),$e=u-b*65536,u=Xe+b+65535,b=Math.floor(u/65536),Xe=u-b*65536,u=Ze+b+65535,b=Math.floor(u/65536),Ze=u-b*65536,u=at+b+65535,b=Math.floor(u/65536),at=u-b*65536,u=ze+b+65535,b=Math.floor(u/65536),ze=u-b*65536,u=et+b+65535,b=Math.floor(u/65536),et=u-b*65536,u=Le+b+65535,b=Math.floor(u/65536),Le=u-b*65536,ee+=b-1+37*(b-1),A[0]=ee,A[1]=fe,A[2]=we,A[3]=Ne,A[4]=Fe,A[5]=Se,A[6]=Pt,A[7]=mt,A[8]=ot,A[9]=$e,A[10]=Xe,A[11]=Ze,A[12]=at,A[13]=ze,A[14]=et,A[15]=Le}function G(A,R){M(A,R,R)}function ye(A,R){const S=o();let u;for(u=0;u<16;u++)S[u]=R[u];for(u=253;u>=0;u--)G(S,S),u!==2&&u!==4&&M(S,S,R);for(u=0;u<16;u++)A[u]=S[u]}function re(A,R){const S=o();let u;for(u=0;u<16;u++)S[u]=R[u];for(u=250;u>=0;u--)G(S,S),u!==1&&M(S,S,R);for(u=0;u<16;u++)A[u]=S[u]}function ue(A,R){const S=o(),u=o(),b=o(),ee=o(),fe=o(),we=o(),Ne=o(),Fe=o(),Se=o();T(S,A[1],A[0]),T(Se,R[1],R[0]),M(S,S,Se),le(u,A[0],A[1]),le(Se,R[0],R[1]),M(u,u,Se),M(b,A[3],R[3]),M(b,b,C),M(ee,A[2],R[2]),le(ee,ee,ee),T(fe,u,S),T(we,ee,b),le(Ne,ee,b),le(Fe,u,S),M(A[0],fe,we),M(A[1],Fe,Ne),M(A[2],Ne,we),M(A[3],fe,Fe)}function Te(A,R,S){for(let u=0;u<4;u++)W(A[u],R[u],S)}function Ue(A,R){const S=o(),u=o(),b=o();ye(b,R[2]),M(S,R[0],b),M(u,R[1],b),ie(A,u),A[31]^=pe(S)<<7}function v(A,R,S){K(A[0],p),K(A[1],y),K(A[2],y),K(A[3],p);for(let u=255;u>=0;--u){const b=S[u/8|0]>>(u&7)&1;Te(A,R,b),ue(R,A),ue(A,A),Te(A,R,b)}}function E(A,R){const S=[o(),o(),o(),o()];K(S[0],L),K(S[1],k),K(S[2],y),M(S[3],L,k),v(A,S,R)}function Y(A){if(A.length!==c.SEED_LENGTH)throw new Error(`ed25519: seed must be ${c.SEED_LENGTH} bytes`);const R=(0,r.hash)(A);R[0]&=248,R[31]&=127,R[31]|=64;const S=new Uint8Array(32),u=[o(),o(),o(),o()];E(u,R),Ue(S,u);const b=new Uint8Array(64);return b.set(A),b.set(S,32),{publicKey:S,secretKey:b}}c.generateKeyPairFromSeed=Y;function ce(A){const R=(0,i.randomBytes)(32,A),S=Y(R);return(0,n.wipe)(R),S}c.generateKeyPair=ce;function H(A){if(A.length!==c.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${c.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(A.subarray(32))}c.extractPublicKeyFromSecretKey=H;const j=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function z(A,R){let S,u,b,ee;for(u=63;u>=32;--u){for(S=0,b=u-32,ee=u-12;b<ee;++b)R[b]+=S-16*R[u]*j[b-(u-32)],S=Math.floor((R[b]+128)/256),R[b]-=S*256;R[b]+=S,R[u]=0}for(S=0,b=0;b<32;b++)R[b]+=S-(R[31]>>4)*j[b],S=R[b]>>8,R[b]&=255;for(b=0;b<32;b++)R[b]-=S*j[b];for(u=0;u<32;u++)R[u+1]+=R[u]>>8,A[u]=R[u]&255}function V(A){const R=new Float64Array(64);for(let S=0;S<64;S++)R[S]=A[S];for(let S=0;S<64;S++)A[S]=0;z(A,R)}function Qe(A,R){const S=new Float64Array(64),u=[o(),o(),o(),o()],b=(0,r.hash)(A.subarray(0,32));b[0]&=248,b[31]&=127,b[31]|=64;const ee=new Uint8Array(64);ee.set(b.subarray(32),32);const fe=new r.SHA512;fe.update(ee.subarray(32)),fe.update(R);const we=fe.digest();fe.clean(),V(we),E(u,we),Ue(ee,u),fe.reset(),fe.update(ee.subarray(0,32)),fe.update(A.subarray(32)),fe.update(R);const Ne=fe.digest();V(Ne);for(let Fe=0;Fe<32;Fe++)S[Fe]=we[Fe];for(let Fe=0;Fe<32;Fe++)for(let Se=0;Se<32;Se++)S[Fe+Se]+=Ne[Fe]*b[Se];return z(ee.subarray(32),S),ee}c.sign=Qe;function Be(A,R){const S=o(),u=o(),b=o(),ee=o(),fe=o(),we=o(),Ne=o();return K(A[2],y),he(A[1],R),G(b,A[1]),M(ee,b,_),T(b,b,A[2]),le(ee,A[2],ee),G(fe,ee),G(we,fe),M(Ne,we,fe),M(S,Ne,b),M(S,S,ee),re(S,S),M(S,S,b),M(S,S,ee),M(S,S,ee),M(A[0],S,ee),G(u,A[0]),M(u,u,ee),ge(u,b)&&M(A[0],A[0],B),G(u,A[0]),M(u,u,ee),ge(u,b)?-1:(pe(A[0])===R[31]>>7&&T(A[0],p,A[0]),M(A[3],A[0],A[1]),0)}function qr(A,R,S){const u=new Uint8Array(32),b=[o(),o(),o(),o()],ee=[o(),o(),o(),o()];if(S.length!==c.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${c.SIGNATURE_LENGTH} bytes`);if(Be(ee,A))return!1;const fe=new r.SHA512;fe.update(S.subarray(0,32)),fe.update(A),fe.update(R);const we=fe.digest();return V(we),v(b,ee,we),E(ee,S.subarray(32)),ue(b,ee),Ue(u,b),!Ee(S,u)}c.verify=qr;function xe(A){let R=[o(),o(),o(),o()];if(Be(R,A))throw new Error("Ed25519: invalid public key");let S=o(),u=o(),b=R[1];le(S,y,b),T(u,y,b),ye(u,u),M(S,S,u);let ee=new Uint8Array(32);return ie(ee,S),ee}c.convertPublicKeyToX25519=xe;function It(A){const R=(0,r.hash)(A.subarray(0,32));R[0]&=248,R[31]&=127,R[31]|=64;const S=new Uint8Array(R.subarray(0,32));return(0,n.wipe)(R),S}c.convertSecretKeyToX25519=It})(Ic);const Hm="EdDSA",Bm="JWT",ff=".",pf="base64url",Vm="utf8",Km="utf8",Gm=":",Wm="did",Jm="key",el="base58btc",Qm="z",Ym="K36",Xm=32;function po(c){return vo(wc(Qs(c),Vm),pf)}function df(c){const i=wc(Ym,el),r=Qm+vo(E1([i,c]),el);return[Wm,Jm,r].join(Gm)}function Zm(c){return vo(c,pf)}function e_(c){return wc([po(c.header),po(c.payload)].join(ff),Km)}function t_(c){return[po(c.header),po(c.payload),Zm(c.signature)].join(ff)}function tl(c=Vl.randomBytes(Xm)){return Ic.generateKeyPairFromSeed(c)}async function r_(c,i,r,n,o=se.fromMiliseconds(Date.now())){const h={alg:Hm,typ:Bm},p=df(n.publicKey),y=o+r,_={iss:p,sub:c,aud:i,iat:o,exp:y},C=e_({header:h,payload:_}),L=Ic.sign(n.secretKey,C);return t_({header:h,payload:_,signature:L})}const i_="PARSE_ERROR",s_="INVALID_REQUEST",n_="METHOD_NOT_FOUND",o_="INVALID_PARAMS",gf="INTERNAL_ERROR",Pc="SERVER_ERROR",a_=[-32700,-32600,-32601,-32602,-32603],Ws={[i_]:{code:-32700,message:"Parse error"},[s_]:{code:-32600,message:"Invalid Request"},[n_]:{code:-32601,message:"Method not found"},[o_]:{code:-32602,message:"Invalid params"},[gf]:{code:-32603,message:"Internal error"},[Pc]:{code:-32e3,message:"Server error"}},yf=Pc;function c_(c){return a_.includes(c)}function rl(c){return Object.keys(Ws).includes(c)?Ws[c]:Ws[yf]}function u_(c){const i=Object.values(Ws).find(r=>r.code===c);return i||Ws[yf]}function vf(c,i,r){return c.message.includes("getaddrinfo ENOTFOUND")||c.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${i}`):c}var mf={},si={},il;function h_(){if(il)return si;il=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowserCryptoAvailable=si.getSubtleCrypto=si.getBrowerCrypto=void 0;function c(){return(hr===null||hr===void 0?void 0:hr.crypto)||(hr===null||hr===void 0?void 0:hr.msCrypto)||{}}si.getBrowerCrypto=c;function i(){const n=c();return n.subtle||n.webkitSubtle}si.getSubtleCrypto=i;function r(){return!!c()&&!!i()}return si.isBrowserCryptoAvailable=r,si}var ni={},sl;function l_(){if(sl)return ni;sl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowser=ni.isNode=ni.isReactNative=void 0;function c(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ni.isReactNative=c;function i(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ni.isNode=i;function r(){return!c()&&!i()}return ni.isBrowser=r,ni}(function(c){Object.defineProperty(c,"__esModule",{value:!0});const i=xi;i.__exportStar(h_(),c),i.__exportStar(l_(),c)})(mf);function Sc(c=3){const i=Date.now()*Math.pow(10,c),r=Math.floor(Math.random()*Math.pow(10,c));return i+r}function _f(c=6){return BigInt(Sc(c))}function Ys(c,i,r){return{id:r||Sc(),jsonrpc:"2.0",method:c,params:i}}function Cc(c,i){return{id:c,jsonrpc:"2.0",result:i}}function wo(c,i,r){return{id:c,jsonrpc:"2.0",error:f_(i,r)}}function f_(c,i){return typeof c>"u"?rl(gf):(typeof c=="string"&&(c=Object.assign(Object.assign({},rl(Pc)),{message:c})),typeof i<"u"&&(c.data=i),c_(c.code)&&(c=u_(c.code)),c)}class p_{}class d_ extends p_{constructor(){super()}}class g_ extends d_{constructor(i){super()}}const y_="^https?:",v_="^wss?:";function m_(c){const i=c.match(new RegExp(/^\w+:/,"gi"));if(!(!i||!i.length))return i[0]}function wf(c,i){const r=m_(c);return typeof r>"u"?!1:new RegExp(i).test(r)}function nl(c){return wf(c,y_)}function ol(c){return wf(c,v_)}function __(c){return new RegExp("wss?://localhost(:d{2,5})?").test(c)}function bf(c){return typeof c=="object"&&"id"in c&&"jsonrpc"in c&&c.jsonrpc==="2.0"}function Oc(c){return bf(c)&&"method"in c}function bo(c){return bf(c)&&(ci(c)||$r(c))}function ci(c){return"result"in c}function $r(c){return"error"in c}class Ii extends g_{constructor(i){super(i),this.events=new vr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(i),this.connection.connected&&this.registerEventListeners()}async connect(i=this.connection){await this.open(i)}async disconnect(){await this.close()}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async request(i,r){return this.requestStrict(Ys(i.method,i.params||[],i.id||_f().toString()),r)}async requestStrict(i,r){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(h){o(h)}this.events.on(`${i.id}`,h=>{$r(h)?o(h.error):n(h.result)});try{await this.connection.send(i,r)}catch(h){o(h)}})}setConnection(i=this.connection){return i}onPayload(i){this.events.emit("payload",i),bo(i)?this.events.emit(`${i.id}`,i):this.events.emit("message",{type:i.method,data:i.params})}onClose(i){i&&i.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${i.code} ${i.reason?`(${i.reason})`:""}`)),this.events.emit("disconnect")}async open(i=this.connection){this.connection===i&&this.connection.connected||(this.connection.connected&&this.close(),typeof i=="string"&&(await this.connection.open(i),i=this.connection),this.connection=this.setConnection(i),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",i=>this.onPayload(i)),this.connection.on("close",i=>this.onClose(i)),this.connection.on("error",i=>this.events.emit("error",i)),this.connection.on("register_error",i=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const w_=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),b_=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",al=c=>c.split("?")[0],cl=10,E_=w_();class x_{constructor(i){if(this.url=i,this.events=new vr.EventEmitter,this.registering=!1,!ol(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);this.url=i}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){return new Promise((i,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),i()},this.socket.close()})}async send(i,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Qs(i))}catch(n){this.onError(i.id,n)}}register(i=this.url){if(!ol(i))throw new Error(`Provided URL is not compatible with WebSocket connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=i,this.registering=!0,new Promise((r,n)=>{const o=mf.isReactNative()?void 0:{rejectUnauthorized:!__(i)},h=new E_(i,[],o);b_()?h.onerror=p=>{const y=p;n(this.emitError(y.error))}:h.on("error",p=>{n(this.emitError(p))}),h.onopen=()=>{this.onOpen(h),r(h)}})}onOpen(i){i.onmessage=r=>this.onPayload(r),i.onclose=r=>this.onClose(r),this.socket=i,this.registering=!1,this.events.emit("open")}onClose(i){this.socket=void 0,this.registering=!1,this.events.emit("close",i)}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?xc(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const n=this.parseError(r),o=n.message||n.toString(),h=wo(i,o);this.events.emit("payload",h)}parseError(i,r=this.url){return vf(i,al(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>cl&&this.events.setMaxListeners(cl)}emitError(i){const r=this.parseError(new Error((i==null?void 0:i.message)||`WebSocket connection failed for host: ${al(this.url)}`));return this.events.emit("register_error",r),r}}var go={exports:{}};go.exports;(function(c,i){var r=200,n="__lodash_hash_undefined__",o=1,h=2,p=9007199254740991,y="[object Arguments]",_="[object Array]",C="[object AsyncFunction]",L="[object Boolean]",k="[object Date]",B="[object Error]",K="[object Function]",q="[object GeneratorFunction]",W="[object Map]",ie="[object Number]",Ee="[object Null]",ge="[object Object]",pe="[object Promise]",he="[object Proxy]",le="[object RegExp]",T="[object Set]",M="[object String]",G="[object Symbol]",ye="[object Undefined]",re="[object WeakMap]",ue="[object ArrayBuffer]",Te="[object DataView]",Ue="[object Float32Array]",v="[object Float64Array]",E="[object Int8Array]",Y="[object Int16Array]",ce="[object Int32Array]",H="[object Uint8Array]",j="[object Uint8ClampedArray]",z="[object Uint16Array]",V="[object Uint32Array]",Qe=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,qr=/^(?:0|[1-9]\d*)$/,xe={};xe[Ue]=xe[v]=xe[E]=xe[Y]=xe[ce]=xe[H]=xe[j]=xe[z]=xe[V]=!0,xe[y]=xe[_]=xe[ue]=xe[L]=xe[Te]=xe[k]=xe[B]=xe[K]=xe[W]=xe[ie]=xe[ge]=xe[le]=xe[T]=xe[M]=xe[re]=!1;var It=typeof hr=="object"&&hr&&hr.Object===Object&&hr,A=typeof self=="object"&&self&&self.Object===Object&&self,R=It||A||Function("return this")(),S=i&&!i.nodeType&&i,u=S&&!0&&c&&!c.nodeType&&c,b=u&&u.exports===S,ee=b&&It.process,fe=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),we=fe&&fe.isTypedArray;function Ne(g,x){for(var $=-1,Q=g==null?0:g.length,Ge=0,ve=[];++$<Q;){var tt=g[$];x(tt,$,g)&&(ve[Ge++]=tt)}return ve}function Fe(g,x){for(var $=-1,Q=x.length,Ge=g.length;++$<Q;)g[Ge+$]=x[$];return g}function Se(g,x){for(var $=-1,Q=g==null?0:g.length;++$<Q;)if(x(g[$],$,g))return!0;return!1}function Pt(g,x){for(var $=-1,Q=Array(g);++$<g;)Q[$]=x($);return Q}function mt(g){return function(x){return g(x)}}function ot(g,x){return g.has(x)}function $e(g,x){return g==null?void 0:g[x]}function Xe(g){var x=-1,$=Array(g.size);return g.forEach(function(Q,Ge){$[++x]=[Ge,Q]}),$}function Ze(g,x){return function($){return g(x($))}}function at(g){var x=-1,$=Array(g.size);return g.forEach(function(Q){$[++x]=Q}),$}var ze=Array.prototype,et=Function.prototype,Le=Object.prototype,Ve=R["__core-js_shared__"],ht=et.toString,Me=Le.hasOwnProperty,St=function(){var g=/[^.]+$/.exec(Ve&&Ve.keys&&Ve.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),Dt=Le.toString,zt=RegExp("^"+ht.call(Me).replace(Qe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),kt=b?R.Buffer:void 0,Mt=R.Symbol,Wt=R.Uint8Array,rr=Le.propertyIsEnumerable,Mr=ze.splice,Jt=Mt?Mt.toStringTag:void 0,Kr=Object.getOwnPropertySymbols,ui=kt?kt.isBuffer:void 0,Si=Ze(Object.keys,Object),lt=lr(R,"DataView"),it=lr(R,"Map"),ft=lr(R,"Promise"),pt=lr(R,"Set"),ct=lr(R,"WeakMap"),st=lr(Object,"create"),Ct=Wr(lt),Ot=Wr(it),dt=Wr(ft),Rt=Wr(pt),gt=Wr(ct),_t=Mt?Mt.prototype:void 0,yt=_t?_t.valueOf:void 0;function Ye(g){var x=-1,$=g==null?0:g.length;for(this.clear();++x<$;){var Q=g[x];this.set(Q[0],Q[1])}}function At(){this.__data__=st?st(null):{},this.size=0}function Tt(g){var x=this.has(g)&&delete this.__data__[g];return this.size-=x?1:0,x}function Io(g){var x=this.__data__;if(st){var $=x[g];return $===n?void 0:$}return Me.call(x,g)?x[g]:void 0}function Po(g){var x=this.__data__;return st?x[g]!==void 0:Me.call(x,g)}function So(g,x){var $=this.__data__;return this.size+=this.has(g)?0:1,$[g]=st&&x===void 0?n:x,this}Ye.prototype.clear=At,Ye.prototype.delete=Tt,Ye.prototype.get=Io,Ye.prototype.has=Po,Ye.prototype.set=So;function mr(g){var x=-1,$=g==null?0:g.length;for(this.clear();++x<$;){var Q=g[x];this.set(Q[0],Q[1])}}function Co(){this.__data__=[],this.size=0}function Oo(g){var x=this.__data__,$=Ci(x,g);if($<0)return!1;var Q=x.length-1;return $==Q?x.pop():Mr.call(x,$,1),--this.size,!0}function Ro(g){var x=this.__data__,$=Ci(x,g);return $<0?void 0:x[$][1]}function Ao(g){return Ci(this.__data__,g)>-1}function To(g,x){var $=this.__data__,Q=Ci($,g);return Q<0?(++this.size,$.push([g,x])):$[Q][1]=x,this}mr.prototype.clear=Co,mr.prototype.delete=Oo,mr.prototype.get=Ro,mr.prototype.has=Ao,mr.prototype.set=To;function Gr(g){var x=-1,$=g==null?0:g.length;for(this.clear();++x<$;){var Q=g[x];this.set(Q[0],Q[1])}}function Bi(){this.size=0,this.__data__={hash:new Ye,map:new(it||mr),string:new Ye}}function No(g){var x=hi(this,g).delete(g);return this.size-=x?1:0,x}function Vi(g){return hi(this,g).get(g)}function Lo(g){return hi(this,g).has(g)}function Fo(g,x){var $=hi(this,g),Q=$.size;return $.set(g,x),this.size+=$.size==Q?0:1,this}Gr.prototype.clear=Bi,Gr.prototype.delete=No,Gr.prototype.get=Vi,Gr.prototype.has=Lo,Gr.prototype.set=Fo;function Ki(g){var x=-1,$=g==null?0:g.length;for(this.__data__=new Gr;++x<$;)this.add(g[x])}function en(g){return this.__data__.set(g,n),this}function tn(g){return this.__data__.has(g)}Ki.prototype.add=Ki.prototype.push=en,Ki.prototype.has=tn;function Rr(g){var x=this.__data__=new mr(g);this.size=x.size}function Do(){this.__data__=new mr,this.size=0}function $o(g){var x=this.__data__,$=x.delete(g);return this.size=x.size,$}function qo(g){return this.__data__.get(g)}function Mo(g){return this.__data__.has(g)}function rn(g,x){var $=this.__data__;if($ instanceof mr){var Q=$.__data__;if(!it||Q.length<r-1)return Q.push([g,x]),this.size=++$.size,this;$=this.__data__=new Gr(Q)}return $.set(g,x),this.size=$.size,this}Rr.prototype.clear=Do,Rr.prototype.delete=$o,Rr.prototype.get=qo,Rr.prototype.has=Mo,Rr.prototype.set=rn;function sn(g,x){var $=Ji(g),Q=!$&&yn(g),Ge=!$&&!Q&&_s(g),ve=!$&&!Q&&!Ge&&_n(g),tt=$||Q||Ge||ve,Nt=tt?Pt(g.length,String):[],Oe=Nt.length;for(var We in g)(x||Me.call(g,We))&&!(tt&&(We=="length"||Ge&&(We=="offset"||We=="parent")||ve&&(We=="buffer"||We=="byteLength"||We=="byteOffset")||ln(We,Oe)))&&Nt.push(We);return Nt}function Ci(g,x){for(var $=g.length;$--;)if(gn(g[$][0],x))return $;return-1}function vs(g,x,$){var Q=x(g);return Ji(g)?Q:Fe(Q,$(g))}function Oi(g){return g==null?g===void 0?ye:Ee:Jt&&Jt in Object(g)?un(g):zo(g)}function ms(g){return Ai(g)&&Oi(g)==y}function Ri(g,x,$,Q,Ge){return g===x?!0:g==null||x==null||!Ai(g)&&!Ai(x)?g!==g&&x!==x:nn(g,x,$,Q,Ri,Ge)}function nn(g,x,$,Q,Ge,ve){var tt=Ji(g),Nt=Ji(x),Oe=tt?_:jr(g),We=Nt?_:jr(x);Oe=Oe==y?ge:Oe,We=We==y?ge:We;var wt=Oe==ge,ir=We==ge,Lt=Oe==We;if(Lt&&_s(g)){if(!_s(x))return!1;tt=!0,wt=!1}if(Lt&&!wt)return ve||(ve=new Rr),tt||_n(g)?Gi(g,x,$,Q,Ge,ve):Uo(g,x,Oe,$,Q,Ge,ve);if(!($&o)){var rt=wt&&Me.call(g,"__wrapped__"),Qt=ir&&Me.call(x,"__wrapped__");if(rt||Qt){var Ar=rt?g.value():g,_r=Qt?x.value():x;return ve||(ve=new Rr),Ge(Ar,_r,$,Q,ve)}}return Lt?(ve||(ve=new Rr),cn(g,x,$,Q,Ge,ve)):!1}function jo(g){if(!mn(g)||pn(g))return!1;var x=Qi(g)?zt:Be;return x.test(Wr(g))}function on(g){return Ai(g)&&vn(g.length)&&!!xe[Oi(g)]}function an(g){if(!dn(g))return Si(g);var x=[];for(var $ in Object(g))Me.call(g,$)&&$!="constructor"&&x.push($);return x}function Gi(g,x,$,Q,Ge,ve){var tt=$&o,Nt=g.length,Oe=x.length;if(Nt!=Oe&&!(tt&&Oe>Nt))return!1;var We=ve.get(g);if(We&&ve.get(x))return We==x;var wt=-1,ir=!0,Lt=$&h?new Ki:void 0;for(ve.set(g,x),ve.set(x,g);++wt<Nt;){var rt=g[wt],Qt=x[wt];if(Q)var Ar=tt?Q(Qt,rt,wt,x,g,ve):Q(rt,Qt,wt,g,x,ve);if(Ar!==void 0){if(Ar)continue;ir=!1;break}if(Lt){if(!Se(x,function(_r,Ur){if(!ot(Lt,Ur)&&(rt===_r||Ge(rt,_r,$,Q,ve)))return Lt.push(Ur)})){ir=!1;break}}else if(!(rt===Qt||Ge(rt,Qt,$,Q,ve))){ir=!1;break}}return ve.delete(g),ve.delete(x),ir}function Uo(g,x,$,Q,Ge,ve,tt){switch($){case Te:if(g.byteLength!=x.byteLength||g.byteOffset!=x.byteOffset)return!1;g=g.buffer,x=x.buffer;case ue:return!(g.byteLength!=x.byteLength||!ve(new Wt(g),new Wt(x)));case L:case k:case ie:return gn(+g,+x);case B:return g.name==x.name&&g.message==x.message;case le:case M:return g==x+"";case W:var Nt=Xe;case T:var Oe=Q&o;if(Nt||(Nt=at),g.size!=x.size&&!Oe)return!1;var We=tt.get(g);if(We)return We==x;Q|=h,tt.set(g,x);var wt=Gi(Nt(g),Nt(x),Q,Ge,ve,tt);return tt.delete(g),wt;case G:if(yt)return yt.call(g)==yt.call(x)}return!1}function cn(g,x,$,Q,Ge,ve){var tt=$&o,Nt=Wi(g),Oe=Nt.length,We=Wi(x),wt=We.length;if(Oe!=wt&&!tt)return!1;for(var ir=Oe;ir--;){var Lt=Nt[ir];if(!(tt?Lt in x:Me.call(x,Lt)))return!1}var rt=ve.get(g);if(rt&&ve.get(x))return rt==x;var Qt=!0;ve.set(g,x),ve.set(x,g);for(var Ar=tt;++ir<Oe;){Lt=Nt[ir];var _r=g[Lt],Ur=x[Lt];if(Q)var ws=tt?Q(Ur,_r,Lt,x,g,ve):Q(_r,Ur,Lt,g,x,ve);if(!(ws===void 0?_r===Ur||Ge(_r,Ur,$,Q,ve):ws)){Qt=!1;break}Ar||(Ar=Lt=="constructor")}if(Qt&&!Ar){var Ti=g.constructor,jt=x.constructor;Ti!=jt&&"constructor"in g&&"constructor"in x&&!(typeof Ti=="function"&&Ti instanceof Ti&&typeof jt=="function"&&jt instanceof jt)&&(Qt=!1)}return ve.delete(g),ve.delete(x),Qt}function Wi(g){return vs(g,Bo,hn)}function hi(g,x){var $=g.__data__;return fn(x)?$[typeof x=="string"?"string":"hash"]:$.map}function lr(g,x){var $=$e(g,x);return jo($)?$:void 0}function un(g){var x=Me.call(g,Jt),$=g[Jt];try{g[Jt]=void 0;var Q=!0}catch{}var Ge=Dt.call(g);return Q&&(x?g[Jt]=$:delete g[Jt]),Ge}var hn=Kr?function(g){return g==null?[]:(g=Object(g),Ne(Kr(g),function(x){return rr.call(g,x)}))}:Ke,jr=Oi;(lt&&jr(new lt(new ArrayBuffer(1)))!=Te||it&&jr(new it)!=W||ft&&jr(ft.resolve())!=pe||pt&&jr(new pt)!=T||ct&&jr(new ct)!=re)&&(jr=function(g){var x=Oi(g),$=x==ge?g.constructor:void 0,Q=$?Wr($):"";if(Q)switch(Q){case Ct:return Te;case Ot:return W;case dt:return pe;case Rt:return T;case gt:return re}return x});function ln(g,x){return x=x??p,!!x&&(typeof g=="number"||qr.test(g))&&g>-1&&g%1==0&&g<x}function fn(g){var x=typeof g;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?g!=="__proto__":g===null}function pn(g){return!!St&&St in g}function dn(g){var x=g&&g.constructor,$=typeof x=="function"&&x.prototype||Le;return g===$}function zo(g){return Dt.call(g)}function Wr(g){if(g!=null){try{return ht.call(g)}catch{}try{return g+""}catch{}}return""}function gn(g,x){return g===x||g!==g&&x!==x}var yn=ms(function(){return arguments}())?ms:function(g){return Ai(g)&&Me.call(g,"callee")&&!rr.call(g,"callee")},Ji=Array.isArray;function ko(g){return g!=null&&vn(g.length)&&!Qi(g)}var _s=ui||ke;function Ho(g,x){return Ri(g,x)}function Qi(g){if(!mn(g))return!1;var x=Oi(g);return x==K||x==q||x==C||x==he}function vn(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=p}function mn(g){var x=typeof g;return g!=null&&(x=="object"||x=="function")}function Ai(g){return g!=null&&typeof g=="object"}var _n=we?mt(we):on;function Bo(g){return ko(g)?sn(g):an(g)}function Ke(){return[]}function ke(){return!1}c.exports=Ho})(go,go.exports);var I_=go.exports;const P_=_c(I_);function S_(c,i){if(c.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<c.length;o++){var h=c.charAt(o),p=h.charCodeAt(0);if(r[p]!==255)throw new TypeError(h+" is ambiguous");r[p]=o}var y=c.length,_=c.charAt(0),C=Math.log(y)/Math.log(256),L=Math.log(256)/Math.log(y);function k(q){if(q instanceof Uint8Array||(ArrayBuffer.isView(q)?q=new Uint8Array(q.buffer,q.byteOffset,q.byteLength):Array.isArray(q)&&(q=Uint8Array.from(q))),!(q instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(q.length===0)return"";for(var W=0,ie=0,Ee=0,ge=q.length;Ee!==ge&&q[Ee]===0;)Ee++,W++;for(var pe=(ge-Ee)*L+1>>>0,he=new Uint8Array(pe);Ee!==ge;){for(var le=q[Ee],T=0,M=pe-1;(le!==0||T<ie)&&M!==-1;M--,T++)le+=256*he[M]>>>0,he[M]=le%y>>>0,le=le/y>>>0;if(le!==0)throw new Error("Non-zero carry");ie=T,Ee++}for(var G=pe-ie;G!==pe&&he[G]===0;)G++;for(var ye=_.repeat(W);G<pe;++G)ye+=c.charAt(he[G]);return ye}function B(q){if(typeof q!="string")throw new TypeError("Expected String");if(q.length===0)return new Uint8Array;var W=0;if(q[W]!==" "){for(var ie=0,Ee=0;q[W]===_;)ie++,W++;for(var ge=(q.length-W)*C+1>>>0,pe=new Uint8Array(ge);q[W];){var he=r[q.charCodeAt(W)];if(he===255)return;for(var le=0,T=ge-1;(he!==0||le<Ee)&&T!==-1;T--,le++)he+=y*pe[T]>>>0,pe[T]=he%256>>>0,he=he/256>>>0;if(he!==0)throw new Error("Non-zero carry");Ee=le,W++}if(q[W]!==" "){for(var M=ge-Ee;M!==ge&&pe[M]===0;)M++;for(var G=new Uint8Array(ie+(ge-M)),ye=ie;M!==ge;)G[ye++]=pe[M++];return G}}}function K(q){var W=B(q);if(W)return W;throw new Error(`Non-${i} character`)}return{encode:k,decodeUnsafe:B,decode:K}}var C_=S_,O_=C_;const Ef=c=>{if(c instanceof Uint8Array&&c.constructor.name==="Uint8Array")return c;if(c instanceof ArrayBuffer)return new Uint8Array(c);if(ArrayBuffer.isView(c))return new Uint8Array(c.buffer,c.byteOffset,c.byteLength);throw new Error("Unknown type, must be binary type")},R_=c=>new TextEncoder().encode(c),A_=c=>new TextDecoder().decode(c);class T_{constructor(i,r,n){this.name=i,this.prefix=r,this.baseEncode=n}encode(i){if(i instanceof Uint8Array)return`${this.prefix}${this.baseEncode(i)}`;throw Error("Unknown type, must be binary type")}}class N_{constructor(i,r,n){if(this.name=i,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(i){if(typeof i=="string"){if(i.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(i)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(i.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(i){return xf(this,i)}}class L_{constructor(i){this.decoders=i}or(i){return xf(this,i)}decode(i){const r=i[0],n=this.decoders[r];if(n)return n.decode(i);throw RangeError(`Unable to decode multibase string ${JSON.stringify(i)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const xf=(c,i)=>new L_({...c.decoders||{[c.prefix]:c},...i.decoders||{[i.prefix]:i}});class F_{constructor(i,r,n,o){this.name=i,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new T_(i,r,n),this.decoder=new N_(i,r,o)}encode(i){return this.encoder.encode(i)}decode(i){return this.decoder.decode(i)}}const Eo=({name:c,prefix:i,encode:r,decode:n})=>new F_(c,i,r,n),Zs=({prefix:c,name:i,alphabet:r})=>{const{encode:n,decode:o}=O_(r,i);return Eo({prefix:c,name:i,encode:n,decode:h=>Ef(o(h))})},D_=(c,i,r,n)=>{const o={};for(let L=0;L<i.length;++L)o[i[L]]=L;let h=c.length;for(;c[h-1]==="=";)--h;const p=new Uint8Array(h*r/8|0);let y=0,_=0,C=0;for(let L=0;L<h;++L){const k=o[c[L]];if(k===void 0)throw new SyntaxError(`Non-${n} character`);_=_<<r|k,y+=r,y>=8&&(y-=8,p[C++]=255&_>>y)}if(y>=r||255&_<<8-y)throw new SyntaxError("Unexpected end of data");return p},$_=(c,i,r)=>{const n=i[i.length-1]==="=",o=(1<<r)-1;let h="",p=0,y=0;for(let _=0;_<c.length;++_)for(y=y<<8|c[_],p+=8;p>r;)p-=r,h+=i[o&y>>p];if(p&&(h+=i[o&y<<r-p]),n)for(;h.length*r&7;)h+="=";return h},Bt=({name:c,prefix:i,bitsPerChar:r,alphabet:n})=>Eo({prefix:i,name:c,encode(o){return $_(o,n,r)},decode(o){return D_(o,n,r,c)}}),q_=Eo({prefix:"\0",name:"identity",encode:c=>A_(c),decode:c=>R_(c)});var M_=Object.freeze({__proto__:null,identity:q_});const j_=Bt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var U_=Object.freeze({__proto__:null,base2:j_});const z_=Bt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var k_=Object.freeze({__proto__:null,base8:z_});const H_=Zs({prefix:"9",name:"base10",alphabet:"0123456789"});var B_=Object.freeze({__proto__:null,base10:H_});const V_=Bt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),K_=Bt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var G_=Object.freeze({__proto__:null,base16:V_,base16upper:K_});const W_=Bt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),J_=Bt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Q_=Bt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Y_=Bt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),X_=Bt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Z_=Bt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ew=Bt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),tw=Bt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),rw=Bt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var iw=Object.freeze({__proto__:null,base32:W_,base32upper:J_,base32pad:Q_,base32padupper:Y_,base32hex:X_,base32hexupper:Z_,base32hexpad:ew,base32hexpadupper:tw,base32z:rw});const sw=Zs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),nw=Zs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ow=Object.freeze({__proto__:null,base36:sw,base36upper:nw});const aw=Zs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),cw=Zs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var uw=Object.freeze({__proto__:null,base58btc:aw,base58flickr:cw});const hw=Bt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),lw=Bt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),fw=Bt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),pw=Bt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var dw=Object.freeze({__proto__:null,base64:hw,base64pad:lw,base64url:fw,base64urlpad:pw});const If=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),gw=If.reduce((c,i,r)=>(c[r]=i,c),[]),yw=If.reduce((c,i,r)=>(c[i.codePointAt(0)]=r,c),[]);function vw(c){return c.reduce((i,r)=>(i+=gw[r],i),"")}function mw(c){const i=[];for(const r of c){const n=yw[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);i.push(n)}return new Uint8Array(i)}const _w=Eo({prefix:"🚀",name:"base256emoji",encode:vw,decode:mw});var ww=Object.freeze({__proto__:null,base256emoji:_w}),bw=Pf,ul=128,Ew=127,xw=~Ew,Iw=Math.pow(2,31);function Pf(c,i,r){i=i||[],r=r||0;for(var n=r;c>=Iw;)i[r++]=c&255|ul,c/=128;for(;c&xw;)i[r++]=c&255|ul,c>>>=7;return i[r]=c|0,Pf.bytes=r-n+1,i}var Pw=fc,Sw=128,hl=127;function fc(c,n){var r=0,n=n||0,o=0,h=n,p,y=c.length;do{if(h>=y)throw fc.bytes=0,new RangeError("Could not decode varint");p=c[h++],r+=o<28?(p&hl)<<o:(p&hl)*Math.pow(2,o),o+=7}while(p>=Sw);return fc.bytes=h-n,r}var Cw=Math.pow(2,7),Ow=Math.pow(2,14),Rw=Math.pow(2,21),Aw=Math.pow(2,28),Tw=Math.pow(2,35),Nw=Math.pow(2,42),Lw=Math.pow(2,49),Fw=Math.pow(2,56),Dw=Math.pow(2,63),$w=function(c){return c<Cw?1:c<Ow?2:c<Rw?3:c<Aw?4:c<Tw?5:c<Nw?6:c<Lw?7:c<Fw?8:c<Dw?9:10},qw={encode:bw,decode:Pw,encodingLength:$w},Sf=qw;const ll=(c,i,r=0)=>(Sf.encode(c,i,r),i),fl=c=>Sf.encodingLength(c),pc=(c,i)=>{const r=i.byteLength,n=fl(c),o=n+fl(r),h=new Uint8Array(o+r);return ll(c,h,0),ll(r,h,n),h.set(i,o),new Mw(c,r,i,h)};class Mw{constructor(i,r,n,o){this.code=i,this.size=r,this.digest=n,this.bytes=o}}const Cf=({name:c,code:i,encode:r})=>new jw(c,i,r);class jw{constructor(i,r,n){this.name=i,this.code=r,this.encode=n}digest(i){if(i instanceof Uint8Array){const r=this.encode(i);return r instanceof Uint8Array?pc(this.code,r):r.then(n=>pc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Of=c=>async i=>new Uint8Array(await crypto.subtle.digest(c,i)),Uw=Cf({name:"sha2-256",code:18,encode:Of("SHA-256")}),zw=Cf({name:"sha2-512",code:19,encode:Of("SHA-512")});var kw=Object.freeze({__proto__:null,sha256:Uw,sha512:zw});const Rf=0,Hw="identity",Af=Ef,Bw=c=>pc(Rf,Af(c)),Vw={code:Rf,name:Hw,encode:Af,digest:Bw};var Kw=Object.freeze({__proto__:null,identity:Vw});new TextEncoder,new TextDecoder;const pl={...M_,...U_,...k_,...B_,...G_,...iw,...ow,...uw,...dw,...ww};({...kw,...Kw});function Tf(c){return globalThis.Buffer!=null?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):c}function Gw(c=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Tf(globalThis.Buffer.allocUnsafe(c)):new Uint8Array(c)}function Nf(c,i,r,n){return{name:c,prefix:i,encoder:{name:c,prefix:i,encode:r},decoder:{decode:n}}}const dl=Nf("utf8","u",c=>"u"+new TextDecoder("utf8").decode(c),c=>new TextEncoder().encode(c.substring(1))),tc=Nf("ascii","a",c=>{let i="a";for(let r=0;r<c.length;r++)i+=String.fromCharCode(c[r]);return i},c=>{c=c.substring(1);const i=Gw(c.length);for(let r=0;r<c.length;r++)i[r]=c.charCodeAt(r);return i}),Ww={utf8:dl,"utf-8":dl,hex:pl.base16,latin1:tc,ascii:tc,binary:tc,...pl};function Jw(c,i="utf8"){const r=Ww[i];if(!r)throw new Error(`Unsupported encoding "${i}"`);return(i==="utf8"||i==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Tf(globalThis.Buffer.from(c,"utf-8")):r.decoder.decode(`${r.prefix}${c}`)}const Lf="wc",Qw=2,Rc="core",Ei=`${Lf}@2:${Rc}:`,Yw={name:Rc,logger:"error"},Xw={database:":memory:"},Zw="crypto",gl="client_ed25519_seed",eb=se.ONE_DAY,tb="keychain",rb="0.3",ib="messages",sb="0.3",nb=se.SIX_HOURS,ob="publisher",Ff="irn",ab="error",Df="wss://relay.walletconnect.com",yl="wss://relay.walletconnect.org",cb="relayer",Gt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},ub="_subscription",oi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},hb=se.ONE_SECOND,lb="2.10.0",fb=1e4,pb="0.3",db="WALLETCONNECT_CLIENT_ID",Vr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},gb="subscription",yb="0.3",vb=se.FIVE_SECONDS*1e3,mb="pairing",_b="0.3",zs={wc_pairingDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:se.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:se.ONE_DAY,prompt:!1,tag:0},res:{ttl:se.ONE_DAY,prompt:!1,tag:0}}},Br={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},wb="history",bb="0.3",Eb="expirer",Cr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},xb="0.3",rc="verify-api",fo="https://verify.walletconnect.com",vl="https://verify.walletconnect.org";class Ib{constructor(i,r){this.core=i,this.logger=r,this.keychain=new Map,this.name=tb,this.version=rb,this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:h}=Z("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(h)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=i,this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(i){await this.core.storage.setItem(this.storageKey,Jl(i))}async getKeyChain(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Ql(i):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Pb{constructor(i,r,n){this.core=i,this.logger=r,this.name=Zw,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),h=tl(o);return df(h.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=P1();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const h=await this.getClientSeed(),p=tl(h),y=hc();return await r_(y,o,eb,p)},this.generateSharedKey=(o,h,p)=>{this.isInitialized();const y=this.getPrivateKey(o),_=S1(y,h);return this.setSymKey(_,p)},this.setSymKey=async(o,h)=>{this.isInitialized();const p=h||C1(o);return await this.keychain.set(p,o),p},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,h,p)=>{this.isInitialized();const y=O1(p),_=Qs(h);if(Lh(y)){const B=y.senderPublicKey,K=y.receiverPublicKey;o=await this.generateSharedKey(B,K)}const C=this.getSymKey(o),{type:L,senderPublicKey:k}=y;return R1({type:L,symKey:C,message:_,senderPublicKey:k})},this.decode=async(o,h,p)=>{this.isInitialized();const y=A1(h,p);if(Lh(y)){const _=y.receiverPublicKey,C=y.senderPublicKey;o=await this.generateSharedKey(_,C)}try{const _=this.getSymKey(o),C=T1({symKey:_,encoded:h});return xc(C)}catch(_){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(_)}},this.getPayloadType=o=>{const h=Fh(o);return N1(h.type)},this.getPayloadSenderPublicKey=o=>{const h=Fh(o);return h.senderPublicKey?vo(h.senderPublicKey,L1):void 0},this.core=i,this.logger=Ae.generateChildLogger(r,this.name),this.keychain=n||new Ib(this.core,this.logger)}get context(){return Ae.getLoggerContext(this.logger)}async setPrivateKey(i,r){return await this.keychain.set(i,r),i}getPrivateKey(i){return this.keychain.get(i)}async getClientSeed(){let i="";try{i=this.keychain.get(gl)}catch{i=hc(),await this.keychain.set(gl,i)}return Jw(i,"base16")}getSymKey(i){return this.keychain.get(i)}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Sb extends Nm{constructor(i,r){super(i,r),this.logger=i,this.core=r,this.messages=new Map,this.name=ib,this.version=sb,this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const h=ps(o);let p=this.messages.get(n);return typeof p>"u"&&(p={}),typeof p[h]<"u"||(p[h]=o,this.messages.set(n,p),await this.persist()),h},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const h=this.get(n),p=ps(o);return typeof h[p]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Ae.generateChildLogger(i,this.name),this.core=r}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(i){await this.core.storage.setItem(this.storageKey,Jl(i))}async getRelayerMessages(){const i=await this.core.storage.getItem(this.storageKey);return typeof i<"u"?Ql(i):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Cb extends Lm{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.events=new vr.EventEmitter,this.name=ob,this.queue=new Map,this.publishTimeout=se.toMiliseconds(se.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,h)=>{var p;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}});try{const y=(h==null?void 0:h.ttl)||nb,_=lc(h),C=(h==null?void 0:h.prompt)||!1,L=(h==null?void 0:h.tag)||0,k=(h==null?void 0:h.id)||_f().toString(),B={topic:n,message:o,opts:{ttl:y,relay:_,prompt:C,tag:L,id:k}},K=setTimeout(()=>this.queue.set(k,B),this.publishTimeout);try{await await Js(this.rpcPublish(n,o,y,_,C,L,k),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(k),this.relayer.events.emit(Gt.publish,B)}catch(q){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(p=h==null?void 0:h.internal)!=null&&p.throwOnFailedPublish)throw this.removeRequestFromQueue(k),q;return}finally{clearTimeout(K)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:h}})}catch(y){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(y),y}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=i,this.logger=Ae.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ae.getLoggerContext(this.logger)}rpcPublish(i,r,n,o,h,p,y){var _,C,L,k;const B={method:uo(o.protocol).publish,params:{topic:i,message:r,ttl:n,prompt:h,tag:p},id:y};return bi((_=B.params)==null?void 0:_.prompt)&&((C=B.params)==null||delete C.prompt),bi((L=B.params)==null?void 0:L.tag)&&((k=B.params)==null||delete k.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:B}),this.relayer.request(B)}removeRequestFromQueue(i){this.queue.delete(i)}checkQueue(){this.queue.forEach(async i=>{const{topic:r,message:n,opts:o}=i;await this.publish(r,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(ys.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Gt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Gt.message_ack,i=>{this.removeRequestFromQueue(i.id.toString())})}}class Ob{constructor(){this.map=new Map,this.set=(i,r)=>{const n=this.get(i);this.exists(i,r)||this.map.set(i,[...n,r])},this.get=i=>this.map.get(i)||[],this.exists=(i,r)=>this.get(i).includes(r),this.delete=(i,r)=>{if(typeof r>"u"){this.map.delete(i);return}if(!this.map.has(i))return;const n=this.get(i);if(!this.exists(i,r))return;const o=n.filter(h=>h!==r);if(!o.length){this.map.delete(i);return}this.map.set(i,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Rb=Object.defineProperty,Ab=Object.defineProperties,Tb=Object.getOwnPropertyDescriptors,ml=Object.getOwnPropertySymbols,Nb=Object.prototype.hasOwnProperty,Lb=Object.prototype.propertyIsEnumerable,_l=(c,i,r)=>i in c?Rb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,ks=(c,i)=>{for(var r in i||(i={}))Nb.call(i,r)&&_l(c,r,i[r]);if(ml)for(var r of ml(i))Lb.call(i,r)&&_l(c,r,i[r]);return c},ic=(c,i)=>Ab(c,Tb(i));class Fb extends $m{constructor(i,r){super(i,r),this.relayer=i,this.logger=r,this.subscriptions=new Map,this.topicMap=new Ob,this.events=new vr.EventEmitter,this.name=gb,this.version=yb,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ei,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const h=lc(o),p={topic:n,relay:h};this.pending.set(n,p);const y=await this.rpcSubscribe(n,h);return this.onSubscribe(y,p),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),y}catch(h){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(h),h}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,h)=>{const p=new se.Watch;p.start(this.pendingSubscriptionWatchLabel);const y=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(y),p.stop(this.pendingSubscriptionWatchLabel),o(!0)),p.elapsed(this.pendingSubscriptionWatchLabel)>=vb&&(clearInterval(y),p.stop(this.pendingSubscriptionWatchLabel),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=i,this.logger=Ae.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(i,r){let n=!1;try{n=this.getSubscription(i).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(i,r){const n=this.topicMap.get(i);await Promise.all(n.map(async o=>await this.unsubscribeById(i,o,r)))}async unsubscribeById(i,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:n}});try{const o=lc(n);await this.rpcUnsubscribe(i,r,o);const h=tr("USER_DISCONNECTED",`${this.name}, ${i}`);await this.onUnsubscribe(i,r,h),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:i,id:r,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(i,r){const n={method:uo(r.protocol).subscribe,params:{topic:i}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Js(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}return ps(i+this.clientId)}async rpcBatchSubscribe(i){if(!i.length)return;const r=i[0].relay,n={method:uo(r.protocol).batchSubscribe,params:{topics:i.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Js(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}}rpcUnsubscribe(i,r,n){const o={method:uo(n.protocol).unsubscribe,params:{topic:i,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(i,r){this.setSubscription(i,ic(ks({},r),{id:i})),this.pending.delete(r.topic)}onBatchSubscribe(i){i.length&&i.forEach(r=>{this.setSubscription(r.id,ks({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(i,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,i)&&this.deleteSubscription(r,n),await this.relayer.messages.del(i)}async setRelayerSubscriptions(i){await this.relayer.core.storage.setItem(this.storageKey,i)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(i,r){this.subscriptions.has(i)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:i,subscription:r}),this.addSubscription(i,r))}addSubscription(i,r){this.subscriptions.set(i,ks({},r)),this.topicMap.set(r.topic,i),this.events.emit(Vr.created,r)}getSubscription(i){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:i});const r=this.subscriptions.get(i);if(!r){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return r}deleteSubscription(i,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:i,reason:r});const n=this.getSubscription(i);this.subscriptions.delete(i),this.topicMap.delete(n.topic,i),this.events.emit(Vr.deleted,ic(ks({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Vr.sync)}async reset(){if(this.cached.length){const i=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<i;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Vr.resubscribed)}async restore(){try{const i=await this.getRelayerSubscriptions();if(typeof i>"u"||!i.length)return;if(this.subscriptions.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(i){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(i)}}async batchSubscribe(i){if(!i.length)return;const r=await this.rpcBatchSubscribe(i);gs(r)&&this.onBatchSubscribe(r.map((n,o)=>ic(ks({},i[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const i=[];this.pending.forEach(r=>{i.push(r)}),await this.batchSubscribe(i)}registerEventListeners(){this.relayer.core.heartbeat.on(ys.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Gt.connect,async()=>{await this.onConnect()}),this.relayer.on(Gt.disconnect,()=>{this.onDisconnect()}),this.events.on(Vr.created,async i=>{const r=Vr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()}),this.events.on(Vr.deleted,async i=>{const r=Vr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}async restartToComplete(){this.restartInProgress&&await new Promise(i=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),i())},this.pollingInterval)})}}var Db=Object.defineProperty,wl=Object.getOwnPropertySymbols,$b=Object.prototype.hasOwnProperty,qb=Object.prototype.propertyIsEnumerable,bl=(c,i,r)=>i in c?Db(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,Mb=(c,i)=>{for(var r in i||(i={}))$b.call(i,r)&&bl(c,r,i[r]);if(wl)for(var r of wl(i))qb.call(i,r)&&bl(c,r,i[r]);return c};class jb extends Fm{constructor(i){super(i),this.protocol="wc",this.version=2,this.events=new vr.EventEmitter,this.name=cb,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Gt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Gt.error,r)},this.registerProviderListeners=()=>{this.provider.on(oi.payload,this.onPayloadHandler),this.provider.on(oi.connect,this.onConnectHandler),this.provider.on(oi.disconnect,this.onDisconnectHandler),this.provider.on(oi.error,this.onProviderErrorHandler)},this.core=i.core,this.logger=typeof i.logger<"u"&&typeof i.logger!="string"?Ae.generateChildLogger(i.logger,this.name):Ae.pino(Ae.getDefaultLoggerOptions({level:i.logger||ab})),this.messages=new Sb(this.logger,i.core),this.subscriber=new Fb(this,this.logger),this.publisher=new Cb(this,this.logger),this.relayUrl=(i==null?void 0:i.relayUrl)||Df,this.projectId=i.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${yl}...`),await this.restartTransport(yl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},fb)}get context(){return Ae.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(i,r,n){this.isInitialized(),await this.publisher.publish(i,r,n),await this.recordMessageEvent({topic:i,message:r,publishedAt:Date.now()})}async subscribe(i,r){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(i))==null?void 0:n[0])||"";return o||(await Promise.all([new Promise(h=>{this.subscriber.once(Vr.created,p=>{p.topic===i&&h()})}),new Promise(async h=>{o=await this.subscriber.subscribe(i,r),h()})]),o)}async unsubscribe(i,r){this.isInitialized(),await this.subscriber.unsubscribe(i,r)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Js(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(i){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){i&&i!==this.relayUrl&&(this.relayUrl=i,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Vr.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await Js(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){n(o);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(oi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(i){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=i||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Dh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(i){return this.staleConnectionErrors.some(r=>i.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const i=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ii(new x_(F1({sdkVersion:lb,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:i,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(i){const{topic:r,message:n}=i;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(i){const{topic:r,message:n}=i;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const o=this.messages.has(r,n);return o&&this.logger.debug(`Ignoring duplicate message: ${n}`),o}async onProviderPayload(i){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:i}),Oc(i)){if(!i.method.endsWith(ub))return;const r=i.params,{topic:n,message:o,publishedAt:h}=r.data,p={topic:n,message:o,publishedAt:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Mb({type:"event",event:r.id},p)),this.events.emit(r.id,p),await this.acknowledgePayload(i),await this.onMessageEvent(p)}else bo(i)&&this.events.emit(Gt.message_ack,i)}async onMessageEvent(i){await this.shouldIgnoreMessageEvent(i)||(this.events.emit(Gt.message,i),await this.recordMessageEvent(i))}async acknowledgePayload(i){const r=Cc(i.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(oi.payload,this.onPayloadHandler),this.provider.off(oi.connect,this.onConnectHandler),this.provider.off(oi.disconnect,this.onDisconnectHandler),this.provider.off(oi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Gt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let i=await Dh();D1(async r=>{this.initialized&&i!==r&&(i=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Gt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(i=>this.logger.error(i))},se.toMiliseconds(hb)))}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(i=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),i())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var Ub=Object.defineProperty,El=Object.getOwnPropertySymbols,zb=Object.prototype.hasOwnProperty,kb=Object.prototype.propertyIsEnumerable,xl=(c,i,r)=>i in c?Ub(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,Il=(c,i)=>{for(var r in i||(i={}))zb.call(i,r)&&xl(c,r,i[r]);if(El)for(var r of El(i))kb.call(i,r)&&xl(c,r,i[r]);return c};class xo extends Dm{constructor(i,r,n,o=Ei,h=void 0){super(i,r,n,o),this.core=i,this.logger=r,this.name=n,this.map=new Map,this.version=pb,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(p=>{this.getKey&&p!==null&&!bi(p)?this.map.set(this.getKey(p),p):x1(p)?this.map.set(p.id,p):I1(p)&&this.map.set(p.topic,p)}),this.cached=[],this.initialized=!0)},this.set=async(p,y)=>{this.isInitialized(),this.map.has(p)?await this.update(p,y):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:p,value:y}),this.map.set(p,y),await this.persist())},this.get=p=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:p}),this.getData(p)),this.getAll=p=>(this.isInitialized(),p?this.values.filter(y=>Object.keys(p).every(_=>P_(y[_],p[_]))):this.values),this.update=async(p,y)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:p,update:y});const _=Il(Il({},this.getData(p)),y);this.map.set(p,_),await this.persist()},this.delete=async(p,y)=>{this.isInitialized(),this.map.has(p)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:p,reason:y}),this.map.delete(p),await this.persist())},this.logger=Ae.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=h}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(i){await this.core.storage.setItem(this.storageKey,i)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(i){const r=this.map.get(i);if(!r){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const i=await this.getDataStore();if(typeof i>"u"||!i.length)return;if(this.map.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(i){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(i)}}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Hb{constructor(i,r){this.core=i,this.logger=r,this.name=mb,this.version=_b,this.events=new Ec,this.initialized=!1,this.storagePrefix=Ei,this.ignoredPayloadTypes=[Kl],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=hc(),o=await this.core.crypto.setSymKey(n),h=Dr(se.FIVE_MINUTES),p={protocol:Ff},y={topic:o,expiry:h,relay:p,active:!1},_=$1({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:p});return await this.pairings.set(o,y),await this.core.relayer.subscribe(o),this.core.expirer.set(o,h),{topic:o,uri:_}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:h,relay:p}=q1(n.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const y=Dr(se.FIVE_MINUTES),_={topic:o,relay:p,expiry:y,active:!1};return await this.pairings.set(o,_),await this.core.crypto.setSymKey(h,o),await this.core.relayer.subscribe(o,{relay:p}),this.core.expirer.set(o,y),n.activatePairing&&await this.activate({topic:o}),_},this.activate=async({topic:n})=>{this.isInitialized();const o=Dr(se.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const h=await this.sendRequest(o,"wc_pairingPing",{}),{done:p,resolve:y,reject:_}=hs();this.events.once(Ft("pairing_ping",h),({error:C})=>{C?_(C):y()}),await p()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",tr("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,h)=>{const p=Ys(o,h),y=await this.core.crypto.encode(n,p),_=zs[o].req;return this.core.history.set(n,p),this.core.relayer.publish(n,y,_),p.id},this.sendResult=async(n,o,h)=>{const p=Cc(n,h),y=await this.core.crypto.encode(o,p),_=await this.core.history.get(o,n),C=zs[_.request.method].res;await this.core.relayer.publish(o,y,C),await this.core.history.resolve(p)},this.sendError=async(n,o,h)=>{const p=wo(n,h),y=await this.core.crypto.encode(o,p),_=await this.core.history.get(o,n),C=zs[_.request.method]?zs[_.request.method].res:zs.unregistered_method.res;await this.core.relayer.publish(o,y,C),await this.core.history.resolve(p)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,tr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>wi(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:h}=n;switch(h.method){case"wc_pairingPing":return this.onPairingPingRequest(o,h);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,h);default:return this.onUnknownRpcMethodRequest(o,h)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:h}=n,p=(await this.core.history.get(o,h.id)).request.method;switch(p){case"wc_pairingPing":return this.onPairingPingResponse(o,h);default:return this.onUnknownRpcMethodResponse(p)}},this.onPairingPingRequest=async(n,o)=>{const{id:h}=o;try{this.isValidPing({topic:n}),await this.sendResult(h,n,!0),this.events.emit("pairing_ping",{id:h,topic:n})}catch(p){await this.sendError(h,n,p),this.logger.error(p)}},this.onPairingPingResponse=(n,o)=>{const{id:h}=o;setTimeout(()=>{ci(o)?this.events.emit(Ft("pairing_ping",h),{}):$r(o)&&this.events.emit(Ft("pairing_ping",h),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:h}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:h,topic:n})}catch(p){await this.sendError(h,n,p),this.logger.error(p)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:h,method:p}=o;try{if(this.registeredMethods.includes(p))return;const y=tr("WC_METHOD_UNSUPPORTED",p);await this.sendError(h,n,y),this.logger.error(y)}catch(y){await this.sendError(h,n,y),this.logger.error(y)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(tr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!ur(n)){const{message:o}=Z("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(o)}if(!M1(n.uri)){const{message:o}=Z("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(o)}},this.isValidPing=async n=>{if(!ur(n)){const{message:h}=Z("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!ur(n)){const{message:h}=Z("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(h)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!ls(n,!1)){const{message:o}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(wi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=Z("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=i,this.logger=Ae.generateChildLogger(r,this.name),this.pairings=new xo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ae.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}registerRelayerEvents(){this.core.relayer.on(Gt.message,async i=>{const{topic:r,message:n}=i;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(r,n);try{Oc(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):bo(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(Cr.expired,async i=>{const{topic:r}=Gl(i.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class Bb extends Tm{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.records=new Map,this.events=new vr.EventEmitter,this.name=wb,this.version=bb,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,h)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:h}),this.records.has(o.id))return;const p={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:h,expiry:Dr(se.THIRTY_DAYS)};this.records.set(p.id,p),this.events.emit(Br.created,p)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=$r(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(Br.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(h=>{if(h.topic===n){if(typeof o<"u"&&h.id!==o)return;this.records.delete(h.id),this.events.emit(Br.deleted,h)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const i=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Ys(r.request.method,r.request.params,r.id),chainId:r.chainId};return i.push(n)}),i}async setJsonRpcRecords(i){await this.core.storage.setItem(this.storageKey,i)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(i){this.isInitialized();const r=this.records.get(i);if(!r){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Br.sync)}async restore(){try{const i=await this.getJsonRpcRecords();if(typeof i>"u"||!i.length)return;if(this.records.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}}registerEventListeners(){this.events.on(Br.created,i=>{const r=Br.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(Br.updated,i=>{const r=Br.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.events.on(Br.deleted,i=>{const r=Br.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:i}),this.persist()}),this.core.heartbeat.on(ys.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(i=>{se.toMiliseconds(i.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${i.id}`),this.delete(i.topic,i.id))})}catch(i){this.logger.warn(i)}}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Vb extends qm{constructor(i,r){super(i,r),this.core=i,this.logger=r,this.expirations=new Map,this.events=new vr.EventEmitter,this.name=Eb,this.version=xb,this.cached=[],this.initialized=!1,this.storagePrefix=Ei,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const h=this.formatTarget(n),p={target:h,expiry:o};this.expirations.set(h,p),this.checkExpiry(h,p),this.events.emit(Cr.created,{target:h,expiration:p})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),h=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Cr.deleted,{target:o,expiration:h})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Ae.generateChildLogger(r,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(i){if(typeof i=="string")return j1(i);if(typeof i=="number")return U1(i);const{message:r}=Z("UNKNOWN_TYPE",`Target type: ${typeof i}`);throw new Error(r)}async setExpirations(i){await this.core.storage.setItem(this.storageKey,i)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Cr.sync)}async restore(){try{const i=await this.getExpirations();if(typeof i>"u"||!i.length)return;if(this.expirations.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=i,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(i){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(i)}}getExpiration(i){const r=this.expirations.get(i);if(!r){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${i}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(i,r){const{expiry:n}=r;se.toMiliseconds(n)-Date.now()<=0&&this.expire(i,r)}expire(i,r){this.expirations.delete(i),this.events.emit(Cr.expired,{target:i,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((i,r)=>this.checkExpiry(r,i))}registerEventListeners(){this.core.heartbeat.on(ys.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Cr.created,i=>{const r=Cr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Cr.expired,i=>{const r=Cr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()}),this.events.on(Cr.deleted,i=>{const r=Cr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:i}),this.persist()})}isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}}}class Kb extends Mm{constructor(i,r){super(i,r),this.projectId=i,this.logger=r,this.name=rc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||z1()||!Wl())return;const o=(n==null?void 0:n.verifyUrl)||fo;this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(h){this.logger.warn(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.warn(h)}if(!this.initialized){this.removeIframe(),this.verifyUrl=vl;try{await this.createIframe()}catch(h){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(h),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const o=(n==null?void 0:n.verifyUrl)||fo;let h="";try{h=await this.fetchAttestation(n.attestationId,o)}catch(p){this.logger.warn(`failed to resolve attestation: ${n.attestationId} from url: ${o}`),this.logger.warn(p),h=await this.fetchAttestation(n.attestationId,vl)}return h},this.fetchAttestation=async(n,o)=>{var h;this.logger.info(`resolving attestation: ${n} from url: ${o}`);const p=this.startAbortTimer(se.ONE_SECOND*2),y=await fetch(`${o}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(p),y.status===200?(h=await y.json())==null?void 0:h.origin:""},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const o=h=>{h.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),n())};await Promise.race([new Promise(h=>{if(document.getElementById(rc))return h();window.addEventListener("message",o);const p=document.createElement("iframe");p.id=rc,p.src=`${this.verifyUrl}/${this.projectId}`,p.style.display="none",document.body.append(p),this.iframe=p,n=h}),new Promise((h,p)=>setTimeout(()=>{window.removeEventListener("message",o),p("verify iframe load timeout")},se.toMiliseconds(se.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Ae.generateChildLogger(r,this.name),this.verifyUrl=fo,this.abortController=new AbortController,this.isDevEnv=k1()&&{}.IS_VITEST}get context(){return Ae.getLoggerContext(this.logger)}startAbortTimer(i){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),se.toMiliseconds(i))}}var Gb=Object.defineProperty,Pl=Object.getOwnPropertySymbols,Wb=Object.prototype.hasOwnProperty,Jb=Object.prototype.propertyIsEnumerable,Sl=(c,i,r)=>i in c?Gb(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,Cl=(c,i)=>{for(var r in i||(i={}))Wb.call(i,r)&&Sl(c,r,i[r]);if(Pl)for(var r of Pl(i))Jb.call(i,r)&&Sl(c,r,i[r]);return c};class Ac extends Am{constructor(i){super(i),this.protocol=Lf,this.version=Qw,this.name=Rc,this.events=new vr.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=i==null?void 0:i.projectId,this.relayUrl=(i==null?void 0:i.relayUrl)||Df;const r=typeof(i==null?void 0:i.logger)<"u"&&typeof(i==null?void 0:i.logger)!="string"?i.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:(i==null?void 0:i.logger)||Yw.logger}));this.logger=Ae.generateChildLogger(r,this.name),this.heartbeat=new ys.HeartBeat,this.crypto=new Pb(this,this.logger,i==null?void 0:i.keychain),this.history=new Bb(this,this.logger),this.expirer=new Vb(this,this.logger),this.storage=i!=null&&i.storage?i.storage:new bm(Cl(Cl({},Xw),i==null?void 0:i.storageOptions)),this.relayer=new jb({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Hb(this,this.logger),this.verify=new Kb(this.projectId||"",this.logger)}static async init(i){const r=new Ac(i);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(db,n),r}get context(){return Ae.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(i){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,i),this.logger.error(i.message),i}}}const Qb=Ac,$f="wc",qf=2,Mf="client",Tc=`${$f}@${qf}:${Mf}:`,sc={name:Mf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Ol="WALLETCONNECT_DEEPLINK_CHOICE",Yb="proposal",jf="Proposal expired",Xb="session",oo=se.SEVEN_DAYS,Zb="engine",Hs={wc_sessionPropose:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1104},res:{ttl:se.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1106},res:{ttl:se.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1112},res:{ttl:se.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1115}}},nc={min:se.FIVE_MINUTES,max:se.SEVEN_DAYS},ai={idle:"IDLE",active:"ACTIVE"},eE="request",tE=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var rE=Object.defineProperty,iE=Object.defineProperties,sE=Object.getOwnPropertyDescriptors,Rl=Object.getOwnPropertySymbols,nE=Object.prototype.hasOwnProperty,oE=Object.prototype.propertyIsEnumerable,Al=(c,i,r)=>i in c?rE(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,cr=(c,i)=>{for(var r in i||(i={}))nE.call(i,r)&&Al(c,r,i[r]);if(Rl)for(var r of Rl(i))oE.call(i,r)&&Al(c,r,i[r]);return c},Bs=(c,i)=>iE(c,sE(i));class aE extends Um{constructor(i){super(i),this.name=Zb,this.events=new Ec,this.initialized=!1,this.ignoredPayloadTypes=[Kl],this.requestQueue={state:ai.idle,queue:[]},this.sessionRequestQueue={state:ai.idle,queue:[]},this.requestQueueDelay=se.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(Hs)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},se.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=Bs(cr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:h,optionalNamespaces:p,sessionProperties:y,relays:_}=n;let C=o,L,k=!1;if(C&&(k=this.client.core.pairing.pairings.get(C).active),!C||!k){const{topic:pe,uri:he}=await this.client.core.pairing.create();C=pe,L=he}const B=await this.client.core.crypto.generateKeyPair(),K=cr({requiredNamespaces:h,optionalNamespaces:p,relays:_??[{protocol:Ff}],proposer:{publicKey:B,metadata:this.client.metadata}},y&&{sessionProperties:y}),{reject:q,resolve:W,done:ie}=hs(se.FIVE_MINUTES,jf);if(this.events.once(Ft("session_connect"),async({error:pe,session:he})=>{if(pe)q(pe);else if(he){he.self.publicKey=B;const le=Bs(cr({},he),{requiredNamespaces:he.requiredNamespaces,optionalNamespaces:he.optionalNamespaces});await this.client.session.set(he.topic,le),await this.setExpiry(he.topic,he.expiry),C&&await this.client.core.pairing.updateMetadata({topic:C,metadata:he.peer.metadata}),W(le)}}),!C){const{message:pe}=Z("NO_MATCHING_KEY",`connect() pairing topic: ${C}`);throw new Error(pe)}const Ee=await this.sendRequest({topic:C,method:"wc_sessionPropose",params:K}),ge=Dr(se.FIVE_MINUTES);return await this.setProposal(Ee,cr({id:Ee,expiry:ge},K)),{uri:L,approval:ie}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:o,namespaces:h,sessionProperties:p}=r,y=this.client.proposal.get(n);let{pairingTopic:_,proposer:C,requiredNamespaces:L,optionalNamespaces:k}=y;_=_||"",ho(L)||(L=B1(h,"approve()"));const B=await this.client.core.crypto.generateKeyPair(),K=C.publicKey,q=await this.client.core.crypto.generateSharedKey(B,K);_&&n&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:C.metadata}),await this.sendResult({id:n,topic:_,result:{relay:{protocol:o??"irn"},responderPublicKey:B}}),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const W=cr({relay:{protocol:o??"irn"},namespaces:h,requiredNamespaces:L,optionalNamespaces:k,pairingTopic:_,controller:{publicKey:B,metadata:this.client.metadata},expiry:Dr(oo)},p&&{sessionProperties:p});await this.client.core.relayer.subscribe(q),await this.sendRequest({topic:q,method:"wc_sessionSettle",params:W,throwOnFailedPublish:!0});const ie=Bs(cr({},W),{topic:q,pairingTopic:_,acknowledged:!1,self:W.controller,peer:{publicKey:C.publicKey,metadata:C.metadata},controller:B});return await this.client.session.set(q,ie),await this.setExpiry(q,Dr(oo)),{topic:q,acknowledged:()=>new Promise(Ee=>setTimeout(()=>Ee(this.client.session.get(q)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:o}=r,{pairingTopic:h}=this.client.proposal.get(n);h&&(await this.sendError(n,h,o),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:o}=r,h=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:p,resolve:y,reject:_}=hs();return this.events.once(Ft("session_update",h),({error:C})=>{C?_(C):y()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:p}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,o=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:h,resolve:p,reject:y}=hs();return this.events.once(Ft("session_extend",o),({error:_})=>{_?y(_):p()}),await this.setExpiry(n,Dr(oo)),{acknowledged:h}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:o,topic:h,expiry:p}=r,y=Sc(),{done:_,resolve:C,reject:L}=hs(p);return this.events.once(Ft("session_request",y),({error:k,result:B})=>{k?L(k):C(B)}),await Promise.all([new Promise(async k=>{await this.sendRequest({clientRpcId:y,topic:h,method:"wc_sessionRequest",params:{request:o,chainId:n},expiry:p,throwOnFailedPublish:!0}).catch(B=>L(B)),this.client.events.emit("session_request_sent",{topic:h,request:o,chainId:n,id:y}),k()}),new Promise(async k=>{const B=await this.client.core.storage.getItem(Ol);V1({id:y,topic:h,wcDeepLink:B}),k()}),_()]).then(k=>k[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:o}=r,{id:h}=o;ci(o)?await this.sendResult({id:h,topic:n,result:o.result,throwOnFailedPublish:!0}):$r(o)&&await this.sendError(h,n,o.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const o=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:h,resolve:p,reject:y}=hs();this.events.once(Ft("session_ping",o),({error:_})=>{_?y(_):p()}),await h()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:o,chainId:h}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:o,chainId:h}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:tr("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>K1(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(h=>{var p,y;return((p=h.peerMetadata)==null?void 0:p.url)&&((y=h.peerMetadata)==null?void 0:y.url)===r.peer.metadata.url&&h.topic&&h.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(h=>this.client.core.pairing.disconnect({topic:h.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,tr("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(Ol).catch(h=>this.client.logger.warn(h))},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,tr("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),o?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(h=>h.id!==r),o&&(this.sessionRequestQueue.state=ai.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=Hs.wc_sessionRequest.req.ttl,{id:o,topic:h,params:p}=r;await this.client.pendingRequest.set(o,{id:o,topic:h,params:p}),n&&this.client.core.expirer.set(o,Dr(n))},this.sendRequest=async r=>{const{topic:n,method:o,params:h,expiry:p,relayRpcId:y,clientRpcId:_,throwOnFailedPublish:C}=r,L=Ys(o,h,_);if(Wl()&&tE.includes(o)){const K=ps(JSON.stringify(L));this.client.core.verify.register({attestationId:K})}const k=await this.client.core.crypto.encode(n,L),B=Hs[o].req;return p&&(B.ttl=p),y&&(B.id=y),this.client.core.history.set(n,L),C?(B.internal=Bs(cr({},B.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,k,B)):this.client.core.relayer.publish(n,k,B).catch(K=>this.client.logger.error(K)),L.id},this.sendResult=async r=>{const{id:n,topic:o,result:h,throwOnFailedPublish:p}=r,y=Cc(n,h),_=await this.client.core.crypto.encode(o,y),C=await this.client.core.history.get(o,n),L=Hs[C.request.method].res;p?(L.internal=Bs(cr({},L.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,_,L)):this.client.core.relayer.publish(o,_,L).catch(k=>this.client.logger.error(k)),await this.client.core.history.resolve(y)},this.sendError=async(r,n,o)=>{const h=wo(r,o),p=await this.client.core.crypto.encode(n,h),y=await this.client.core.history.get(n,r),_=Hs[y.request.method].res;this.client.core.relayer.publish(n,p,_),await this.client.core.history.resolve(h)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(o=>{wi(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{wi(o.expiry)&&n.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ai.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ai.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ai.idle},this.processRequest=r=>{const{topic:n,payload:o}=r,h=o.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${h}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:o}=r,h=(await this.client.core.history.get(n,o.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:o}=Z("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,n)=>{const{params:o,id:h}=n;try{this.isValidConnect(cr({},n.params));const p=Dr(se.FIVE_MINUTES),y=cr({id:h,pairingTopic:r,expiry:p},o);await this.setProposal(h,y);const _=ps(JSON.stringify(n)),C=await this.getVerifyContext(_,y.proposer.metadata);this.client.events.emit("session_proposal",{id:h,params:y,verifyContext:C})}catch(p){await this.sendError(h,r,p),this.client.logger.error(p)}},this.onSessionProposeResponse=async(r,n)=>{const{id:o}=n;if(ci(n)){const{result:h}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const p=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:p});const y=p.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:y});const _=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const C=await this.client.core.crypto.generateSharedKey(y,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:C});const L=await this.client.core.relayer.subscribe(C);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:L}),await this.client.core.pairing.activate({topic:r})}else $r(n)&&(await this.client.proposal.delete(o,tr("USER_DISCONNECTED")),this.events.emit(Ft("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:o,params:h}=n;try{this.isValidSessionSettleRequest(h);const{relay:p,controller:y,expiry:_,namespaces:C,requiredNamespaces:L,optionalNamespaces:k,sessionProperties:B,pairingTopic:K}=n.params,q=cr({topic:r,relay:p,expiry:_,namespaces:C,acknowledged:!0,pairingTopic:K,requiredNamespaces:L,optionalNamespaces:k,controller:y.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:y.publicKey,metadata:y.metadata}},B&&{sessionProperties:B});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(Ft("session_connect"),{session:q}),this.cleanupDuplicatePairings(q)}catch(p){await this.sendError(o,r,p),this.client.logger.error(p)}},this.onSessionSettleResponse=async(r,n)=>{const{id:o}=n;ci(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ft("session_approve",o),{})):$r(n)&&(await this.client.session.delete(r,tr("USER_DISCONNECTED")),this.events.emit(Ft("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:o,id:h}=n;try{const p=`${r}_session_update`,y=no.get(p);if(y&&this.isRequestOutOfSync(y,h)){this.client.logger.info(`Discarding out of sync request - ${h}`);return}this.isValidUpdate(cr({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult({id:h,topic:r,result:!0}),this.client.events.emit("session_update",{id:h,topic:r,params:o}),no.set(p,h)}catch(p){await this.sendError(h,r,p),this.client.logger.error(p)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:o}=n;ci(n)?this.events.emit(Ft("session_update",o),{}):$r(n)&&this.events.emit(Ft("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:o}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Dr(oo)),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_extend",{id:o,topic:r})}catch(h){await this.sendError(o,r,h),this.client.logger.error(h)}},this.onSessionExtendResponse=(r,n)=>{const{id:o}=n;ci(n)?this.events.emit(Ft("session_extend",o),{}):$r(n)&&this.events.emit(Ft("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:o}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_ping",{id:o,topic:r})}catch(h){await this.sendError(o,r,h),this.client.logger.error(h)}},this.onSessionPingResponse=(r,n)=>{const{id:o}=n;setTimeout(()=>{ci(n)?this.events.emit(Ft("session_ping",o),{}):$r(n)&&this.events.emit(Ft("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(h=>{this.client.core.relayer.once(Gt.publish,async()=>{h(await this.deleteSession(r))})}),this.sendResult({id:o,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(h){this.client.logger.error(h)}},this.onSessionRequest=async(r,n)=>{const{id:o,params:h}=n;try{this.isValidRequest(cr({topic:r},h)),await this.setPendingSessionRequest({id:o,topic:r,params:h}),this.addSessionRequestToSessionRequestQueue({id:o,topic:r,params:h}),await this.processSessionRequestQueue()}catch(p){await this.sendError(o,r,p),this.client.logger.error(p)}},this.onSessionRequestResponse=(r,n)=>{const{id:o}=n;ci(n)?this.events.emit(Ft("session_request",o),{result:n.result}):$r(n)&&this.events.emit(Ft("session_request",o),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:o,params:h}=n;try{const p=`${r}_session_event_${h.event.name}`,y=no.get(p);if(y&&this.isRequestOutOfSync(y,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(cr({topic:r},h)),this.client.events.emit("session_event",{id:o,topic:r,params:h}),no.set(p,o)}catch(p){await this.sendError(o,r,p),this.client.logger.error(p)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ai.idle,this.processSessionRequestQueue()},se.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=async()=>{if(this.sessionRequestQueue.state===ai.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{const{id:n,topic:o,params:h}=r,p=ps(JSON.stringify(Ys("wc_sessionRequest",h,n))),y=this.client.session.get(o),_=await this.getVerifyContext(p,y.peer.metadata);this.sessionRequestQueue.state=ai.active,this.client.events.emit("session_request",{id:n,topic:o,params:h,verifyContext:_})}catch(n){this.client.logger.error(n)}},this.isValidConnect=async r=>{if(!ur(r)){const{message:_}=Z("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(_)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:h,sessionProperties:p,relays:y}=r;if(bi(n)||await this.isValidPairingTopic(n),!G1(y,!0)){const{message:_}=Z("MISSING_OR_INVALID",`connect() relays: ${y}`);throw new Error(_)}!bi(o)&&ho(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!bi(h)&&ho(h)!==0&&this.validateNamespaces(h,"optionalNamespaces"),bi(p)||this.validateSessionProps(p,"sessionProperties")},this.validateNamespaces=(r,n)=>{const o=W1(r,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!ur(r))throw new Error(Z("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:o,relayProtocol:h,sessionProperties:p}=r;await this.isValidProposalId(n);const y=this.client.proposal.get(n),_=Wa(o,"approve()");if(_)throw new Error(_.message);const C=$h(y.requiredNamespaces,o,"approve()");if(C)throw new Error(C.message);if(!ls(h,!0)){const{message:L}=Z("MISSING_OR_INVALID",`approve() relayProtocol: ${h}`);throw new Error(L)}bi(p)||this.validateSessionProps(p,"sessionProperties")},this.isValidReject=async r=>{if(!ur(r)){const{message:h}=Z("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(h)}const{id:n,reason:o}=r;if(await this.isValidProposalId(n),!J1(o)){const{message:h}=Z("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidSessionSettleRequest=r=>{if(!ur(r)){const{message:C}=Z("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(C)}const{relay:n,controller:o,namespaces:h,expiry:p}=r;if(!Q1(n)){const{message:C}=Z("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(C)}const y=Y1(o,"onSessionSettleRequest()");if(y)throw new Error(y.message);const _=Wa(h,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(wi(p)){const{message:C}=Z("EXPIRED","onSessionSettleRequest()");throw new Error(C)}},this.isValidUpdate=async r=>{if(!ur(r)){const{message:_}=Z("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(_)}const{topic:n,namespaces:o}=r;await this.isValidSessionTopic(n);const h=this.client.session.get(n),p=Wa(o,"update()");if(p)throw new Error(p.message);const y=$h(h.requiredNamespaces,o,"update()");if(y)throw new Error(y.message)},this.isValidExtend=async r=>{if(!ur(r)){const{message:o}=Z("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!ur(r)){const{message:_}=Z("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(_)}const{topic:n,request:o,chainId:h,expiry:p}=r;await this.isValidSessionTopic(n);const{namespaces:y}=this.client.session.get(n);if(!qh(y,h)){const{message:_}=Z("MISSING_OR_INVALID",`request() chainId: ${h}`);throw new Error(_)}if(!X1(o)){const{message:_}=Z("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(_)}if(!Z1(y,h,o.method)){const{message:_}=Z("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(_)}if(p&&!em(p,nc)){const{message:_}=Z("MISSING_OR_INVALID",`request() expiry: ${p}. Expiry must be a number (in seconds) between ${nc.min} and ${nc.max}`);throw new Error(_)}},this.isValidRespond=async r=>{if(!ur(r)){const{message:h}=Z("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(h)}const{topic:n,response:o}=r;if(await this.isValidSessionTopic(n),!tm(o)){const{message:h}=Z("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(h)}},this.isValidPing=async r=>{if(!ur(r)){const{message:o}=Z("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!ur(r)){const{message:y}=Z("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(y)}const{topic:n,event:o,chainId:h}=r;await this.isValidSessionTopic(n);const{namespaces:p}=this.client.session.get(n);if(!qh(p,h)){const{message:y}=Z("MISSING_OR_INVALID",`emit() chainId: ${h}`);throw new Error(y)}if(!rm(o)){const{message:y}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(y)}if(!im(p,h,o.name)){const{message:y}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(y)}},this.isValidDisconnect=async r=>{if(!ur(r)){const{message:o}=Z("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const o={verified:{verifyUrl:n.verifyUrl||fo,validation:"UNKNOWN",origin:n.url||""}};try{const h=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});h&&(o.verified.origin=h,o.verified.validation=h===new URL(n.url).origin?"VALID":"INVALID")}catch(h){this.client.logger.error(h)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(o=>{if(!ls(o,!1)){const{message:h}=Z("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(h)}})}}async isInitialized(){if(!this.initialized){const{message:i}=Z("NOT_INITIALIZED",this.name);throw new Error(i)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Gt.message,async i=>{const{topic:r,message:n}=i;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(r,n);try{Oc(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):bo(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})}catch(h){this.client.logger.error(h)}})}registerExpirerEvents(){this.client.core.expirer.on(Cr.expired,async i=>{const{topic:r,id:n}=Gl(i.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Z("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(i){if(!ls(i,!1)){const{message:r}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(i)){const{message:r}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(r)}if(wi(this.client.core.pairing.pairings.get(i).expiry)){const{message:r}=Z("EXPIRED",`pairing topic: ${i}`);throw new Error(r)}}async isValidSessionTopic(i){if(!ls(i,!1)){const{message:r}=Z("MISSING_OR_INVALID",`session topic should be a string: ${i}`);throw new Error(r)}if(!this.client.session.keys.includes(i)){const{message:r}=Z("NO_MATCHING_KEY",`session topic doesn't exist: ${i}`);throw new Error(r)}if(wi(this.client.session.get(i).expiry)){await this.deleteSession(i);const{message:r}=Z("EXPIRED",`session topic: ${i}`);throw new Error(r)}}async isValidSessionOrPairingTopic(i){if(this.client.session.keys.includes(i))await this.isValidSessionTopic(i);else if(this.client.core.pairing.pairings.keys.includes(i))this.isValidPairingTopic(i);else if(ls(i,!1)){const{message:r}=Z("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${i}`);throw new Error(r)}else{const{message:r}=Z("MISSING_OR_INVALID",`session or pairing topic should be a string: ${i}`);throw new Error(r)}}async isValidProposalId(i){if(!sm(i)){const{message:r}=Z("MISSING_OR_INVALID",`proposal id should be a number: ${i}`);throw new Error(r)}if(!this.client.proposal.keys.includes(i)){const{message:r}=Z("NO_MATCHING_KEY",`proposal id doesn't exist: ${i}`);throw new Error(r)}if(wi(this.client.proposal.get(i).expiry)){await this.deleteProposal(i);const{message:r}=Z("EXPIRED",`proposal id: ${i}`);throw new Error(r)}}}class cE extends xo{constructor(i,r){super(i,r,Yb,Tc),this.core=i,this.logger=r}}class uE extends xo{constructor(i,r){super(i,r,Xb,Tc),this.core=i,this.logger=r}}class hE extends xo{constructor(i,r){super(i,r,eE,Tc,n=>n.id),this.core=i,this.logger=r}}let lE=class Uf extends jm{constructor(i){super(i),this.protocol=$f,this.version=qf,this.name=sc.name,this.events=new vr.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(i==null?void 0:i.name)||sc.name,this.metadata=(i==null?void 0:i.metadata)||H1();const r=typeof(i==null?void 0:i.logger)<"u"&&typeof(i==null?void 0:i.logger)!="string"?i.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:(i==null?void 0:i.logger)||sc.logger}));this.core=(i==null?void 0:i.core)||new Qb(i),this.logger=Ae.generateChildLogger(r,this.name),this.session=new uE(this.core,this.logger),this.proposal=new cE(this.core,this.logger),this.pendingRequest=new hE(this.core,this.logger),this.engine=new aE(this)}static async init(i){const r=new Uf(i);return await r.initialize(),r}get context(){return Ae.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(i){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(i.message),i}}};var dc={exports:{}};(function(c,i){var r=typeof self<"u"?self:hr,n=function(){function h(){this.fetch=!1,this.DOMException=r.DOMException}return h.prototype=r,new h}();(function(h){(function(p){var y={searchParams:"URLSearchParams"in h,iterable:"Symbol"in h&&"iterator"in Symbol,blob:"FileReader"in h&&"Blob"in h&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in h,arrayBuffer:"ArrayBuffer"in h};function _(v){return v&&DataView.prototype.isPrototypeOf(v)}if(y.arrayBuffer)var C=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],L=ArrayBuffer.isView||function(v){return v&&C.indexOf(Object.prototype.toString.call(v))>-1};function k(v){if(typeof v!="string"&&(v=String(v)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(v))throw new TypeError("Invalid character in header field name");return v.toLowerCase()}function B(v){return typeof v!="string"&&(v=String(v)),v}function K(v){var E={next:function(){var Y=v.shift();return{done:Y===void 0,value:Y}}};return y.iterable&&(E[Symbol.iterator]=function(){return E}),E}function q(v){this.map={},v instanceof q?v.forEach(function(E,Y){this.append(Y,E)},this):Array.isArray(v)?v.forEach(function(E){this.append(E[0],E[1])},this):v&&Object.getOwnPropertyNames(v).forEach(function(E){this.append(E,v[E])},this)}q.prototype.append=function(v,E){v=k(v),E=B(E);var Y=this.map[v];this.map[v]=Y?Y+", "+E:E},q.prototype.delete=function(v){delete this.map[k(v)]},q.prototype.get=function(v){return v=k(v),this.has(v)?this.map[v]:null},q.prototype.has=function(v){return this.map.hasOwnProperty(k(v))},q.prototype.set=function(v,E){this.map[k(v)]=B(E)},q.prototype.forEach=function(v,E){for(var Y in this.map)this.map.hasOwnProperty(Y)&&v.call(E,this.map[Y],Y,this)},q.prototype.keys=function(){var v=[];return this.forEach(function(E,Y){v.push(Y)}),K(v)},q.prototype.values=function(){var v=[];return this.forEach(function(E){v.push(E)}),K(v)},q.prototype.entries=function(){var v=[];return this.forEach(function(E,Y){v.push([Y,E])}),K(v)},y.iterable&&(q.prototype[Symbol.iterator]=q.prototype.entries);function W(v){if(v.bodyUsed)return Promise.reject(new TypeError("Already read"));v.bodyUsed=!0}function ie(v){return new Promise(function(E,Y){v.onload=function(){E(v.result)},v.onerror=function(){Y(v.error)}})}function Ee(v){var E=new FileReader,Y=ie(E);return E.readAsArrayBuffer(v),Y}function ge(v){var E=new FileReader,Y=ie(E);return E.readAsText(v),Y}function pe(v){for(var E=new Uint8Array(v),Y=new Array(E.length),ce=0;ce<E.length;ce++)Y[ce]=String.fromCharCode(E[ce]);return Y.join("")}function he(v){if(v.slice)return v.slice(0);var E=new Uint8Array(v.byteLength);return E.set(new Uint8Array(v)),E.buffer}function le(){return this.bodyUsed=!1,this._initBody=function(v){this._bodyInit=v,v?typeof v=="string"?this._bodyText=v:y.blob&&Blob.prototype.isPrototypeOf(v)?this._bodyBlob=v:y.formData&&FormData.prototype.isPrototypeOf(v)?this._bodyFormData=v:y.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)?this._bodyText=v.toString():y.arrayBuffer&&y.blob&&_(v)?(this._bodyArrayBuffer=he(v.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):y.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(v)||L(v))?this._bodyArrayBuffer=he(v):this._bodyText=v=Object.prototype.toString.call(v):this._bodyText="",this.headers.get("content-type")||(typeof v=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(v)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var v=W(this);if(v)return v;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?W(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(Ee)}),this.text=function(){var v=W(this);if(v)return v;if(this._bodyBlob)return ge(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(pe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(ye)}),this.json=function(){return this.text().then(JSON.parse)},this}var T=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function M(v){var E=v.toUpperCase();return T.indexOf(E)>-1?E:v}function G(v,E){E=E||{};var Y=E.body;if(v instanceof G){if(v.bodyUsed)throw new TypeError("Already read");this.url=v.url,this.credentials=v.credentials,E.headers||(this.headers=new q(v.headers)),this.method=v.method,this.mode=v.mode,this.signal=v.signal,!Y&&v._bodyInit!=null&&(Y=v._bodyInit,v.bodyUsed=!0)}else this.url=String(v);if(this.credentials=E.credentials||this.credentials||"same-origin",(E.headers||!this.headers)&&(this.headers=new q(E.headers)),this.method=M(E.method||this.method||"GET"),this.mode=E.mode||this.mode||null,this.signal=E.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Y)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Y)}G.prototype.clone=function(){return new G(this,{body:this._bodyInit})};function ye(v){var E=new FormData;return v.trim().split("&").forEach(function(Y){if(Y){var ce=Y.split("="),H=ce.shift().replace(/\+/g," "),j=ce.join("=").replace(/\+/g," ");E.append(decodeURIComponent(H),decodeURIComponent(j))}}),E}function re(v){var E=new q,Y=v.replace(/\r?\n[\t ]+/g," ");return Y.split(/\r?\n/).forEach(function(ce){var H=ce.split(":"),j=H.shift().trim();if(j){var z=H.join(":").trim();E.append(j,z)}}),E}le.call(G.prototype);function ue(v,E){E||(E={}),this.type="default",this.status=E.status===void 0?200:E.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in E?E.statusText:"OK",this.headers=new q(E.headers),this.url=E.url||"",this._initBody(v)}le.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new q(this.headers),url:this.url})},ue.error=function(){var v=new ue(null,{status:0,statusText:""});return v.type="error",v};var Te=[301,302,303,307,308];ue.redirect=function(v,E){if(Te.indexOf(E)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:E,headers:{location:v}})},p.DOMException=h.DOMException;try{new p.DOMException}catch{p.DOMException=function(E,Y){this.message=E,this.name=Y;var ce=Error(E);this.stack=ce.stack},p.DOMException.prototype=Object.create(Error.prototype),p.DOMException.prototype.constructor=p.DOMException}function Ue(v,E){return new Promise(function(Y,ce){var H=new G(v,E);if(H.signal&&H.signal.aborted)return ce(new p.DOMException("Aborted","AbortError"));var j=new XMLHttpRequest;function z(){j.abort()}j.onload=function(){var V={status:j.status,statusText:j.statusText,headers:re(j.getAllResponseHeaders()||"")};V.url="responseURL"in j?j.responseURL:V.headers.get("X-Request-URL");var Qe="response"in j?j.response:j.responseText;Y(new ue(Qe,V))},j.onerror=function(){ce(new TypeError("Network request failed"))},j.ontimeout=function(){ce(new TypeError("Network request failed"))},j.onabort=function(){ce(new p.DOMException("Aborted","AbortError"))},j.open(H.method,H.url,!0),H.credentials==="include"?j.withCredentials=!0:H.credentials==="omit"&&(j.withCredentials=!1),"responseType"in j&&y.blob&&(j.responseType="blob"),H.headers.forEach(function(V,Qe){j.setRequestHeader(Qe,V)}),H.signal&&(H.signal.addEventListener("abort",z),j.onreadystatechange=function(){j.readyState===4&&H.signal.removeEventListener("abort",z)}),j.send(typeof H._bodyInit>"u"?null:H._bodyInit)})}return Ue.polyfill=!0,h.fetch||(h.fetch=Ue,h.Headers=q,h.Request=G,h.Response=ue),p.Headers=q,p.Request=G,p.Response=ue,p.fetch=Ue,Object.defineProperty(p,"__esModule",{value:!0}),p})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;i=o.fetch,i.default=o.fetch,i.fetch=o.fetch,i.Headers=o.Headers,i.Request=o.Request,i.Response=o.Response,c.exports=i})(dc,dc.exports);var fE=dc.exports;const Tl=_c(fE),pE={Accept:"application/json","Content-Type":"application/json"},dE="POST",Nl={headers:pE,method:dE},Ll=10;class Hi{constructor(i,r=!1){if(this.url=i,this.disableProviderPing=r,this.events=new vr.EventEmitter,this.isAvailable=!1,this.registering=!1,!nl(i))throw new Error(`Provided URL is not compatible with HTTP connection: ${i}`);this.url=i,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}off(i,r){this.events.off(i,r)}removeListener(i,r){this.events.removeListener(i,r)}async open(i=this.url){await this.register(i)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(i,r){this.isAvailable||await this.register();try{const n=Qs(i),h=await(await Tl(this.url,Object.assign(Object.assign({},Nl),{body:n}))).json();this.onPayload({data:h})}catch(n){this.onError(i.id,n)}}async register(i=this.url){if(!nl(i))throw new Error(`Provided URL is not compatible with HTTP connection: ${i}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",h=>{this.resetMaxListeners(),o(h)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=i,this.registering=!0;try{if(!this.disableProviderPing){const r=Qs({id:1,jsonrpc:"2.0",method:"test",params:[]});await Tl(i,Object.assign(Object.assign({},Nl),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(i){if(typeof i.data>"u")return;const r=typeof i.data=="string"?xc(i.data):i.data;this.events.emit("payload",r)}onError(i,r){const n=this.parseError(r),o=n.message||n.toString(),h=wo(i,o);this.events.emit("payload",h)}parseError(i,r=this.url){return vf(i,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Ll&&this.events.setMaxListeners(Ll)}}const Fl="error",gE="wss://relay.walletconnect.com",yE="wc",vE="universal_provider",Dl=`${yE}@2:${vE}:`,mE="https://rpc.walletconnect.com/v1",Pi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Vs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},gc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(c,i){(function(){var r,n="4.17.21",o=200,h="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",p="Expected a function",y="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",C=500,L="__lodash_placeholder__",k=1,B=2,K=4,q=1,W=2,ie=1,Ee=2,ge=4,pe=8,he=16,le=32,T=64,M=128,G=256,ye=512,re=30,ue="...",Te=800,Ue=16,v=1,E=2,Y=3,ce=1/0,H=9007199254740991,j=17976931348623157e292,z=0/0,V=4294967295,Qe=V-1,Be=V>>>1,qr=[["ary",M],["bind",ie],["bindKey",Ee],["curry",pe],["curryRight",he],["flip",ye],["partial",le],["partialRight",T],["rearg",G]],xe="[object Arguments]",It="[object Array]",A="[object AsyncFunction]",R="[object Boolean]",S="[object Date]",u="[object DOMException]",b="[object Error]",ee="[object Function]",fe="[object GeneratorFunction]",we="[object Map]",Ne="[object Number]",Fe="[object Null]",Se="[object Object]",Pt="[object Promise]",mt="[object Proxy]",ot="[object RegExp]",$e="[object Set]",Xe="[object String]",Ze="[object Symbol]",at="[object Undefined]",ze="[object WeakMap]",et="[object WeakSet]",Le="[object ArrayBuffer]",Ve="[object DataView]",ht="[object Float32Array]",Me="[object Float64Array]",St="[object Int8Array]",Dt="[object Int16Array]",zt="[object Int32Array]",kt="[object Uint8Array]",Mt="[object Uint8ClampedArray]",Wt="[object Uint16Array]",rr="[object Uint32Array]",Mr=/\b__p \+= '';/g,Jt=/\b(__p \+=) '' \+/g,Kr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ui=/&(?:amp|lt|gt|quot|#39);/g,Si=/[&<>"']/g,lt=RegExp(ui.source),it=RegExp(Si.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,st=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ct=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(dt.source),gt=/^\s+/,_t=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ye=/\{\n\/\* \[wrapped with (.+)\] \*/,At=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Io=/[()=,{}\[\]\/\s]/,Po=/\\(\\)?/g,So=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,mr=/\w*$/,Co=/^[-+]0x[0-9a-f]+$/i,Oo=/^0b[01]+$/i,Ro=/^\[object .+?Constructor\]$/,Ao=/^0o[0-7]+$/i,To=/^(?:0|[1-9]\d*)$/,Gr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Bi=/($^)/,No=/['\n\r\u2028\u2029\\]/g,Vi="\\ud800-\\udfff",Lo="\\u0300-\\u036f",Fo="\\ufe20-\\ufe2f",Ki="\\u20d0-\\u20ff",en=Lo+Fo+Ki,tn="\\u2700-\\u27bf",Rr="a-z\\xdf-\\xf6\\xf8-\\xff",Do="\\xac\\xb1\\xd7\\xf7",$o="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",qo="\\u2000-\\u206f",Mo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",rn="A-Z\\xc0-\\xd6\\xd8-\\xde",sn="\\ufe0e\\ufe0f",Ci=Do+$o+qo+Mo,vs="['’]",Oi="["+Vi+"]",ms="["+Ci+"]",Ri="["+en+"]",nn="\\d+",jo="["+tn+"]",on="["+Rr+"]",an="[^"+Vi+Ci+nn+tn+Rr+rn+"]",Gi="\\ud83c[\\udffb-\\udfff]",Uo="(?:"+Ri+"|"+Gi+")",cn="[^"+Vi+"]",Wi="(?:\\ud83c[\\udde6-\\uddff]){2}",hi="[\\ud800-\\udbff][\\udc00-\\udfff]",lr="["+rn+"]",un="\\u200d",hn="(?:"+on+"|"+an+")",jr="(?:"+lr+"|"+an+")",ln="(?:"+vs+"(?:d|ll|m|re|s|t|ve))?",fn="(?:"+vs+"(?:D|LL|M|RE|S|T|VE))?",pn=Uo+"?",dn="["+sn+"]?",zo="(?:"+un+"(?:"+[cn,Wi,hi].join("|")+")"+dn+pn+")*",Wr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",gn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",yn=dn+pn+zo,Ji="(?:"+[jo,Wi,hi].join("|")+")"+yn,ko="(?:"+[cn+Ri+"?",Ri,Wi,hi,Oi].join("|")+")",_s=RegExp(vs,"g"),Ho=RegExp(Ri,"g"),Qi=RegExp(Gi+"(?="+Gi+")|"+ko+yn,"g"),vn=RegExp([lr+"?"+on+"+"+ln+"(?="+[ms,lr,"$"].join("|")+")",jr+"+"+fn+"(?="+[ms,lr+hn,"$"].join("|")+")",lr+"?"+hn+"+"+ln,lr+"+"+fn,gn,Wr,nn,Ji].join("|"),"g"),mn=RegExp("["+un+Vi+en+sn+"]"),Ai=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,_n=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Bo=-1,Ke={};Ke[ht]=Ke[Me]=Ke[St]=Ke[Dt]=Ke[zt]=Ke[kt]=Ke[Mt]=Ke[Wt]=Ke[rr]=!0,Ke[xe]=Ke[It]=Ke[Le]=Ke[R]=Ke[Ve]=Ke[S]=Ke[b]=Ke[ee]=Ke[we]=Ke[Ne]=Ke[Se]=Ke[ot]=Ke[$e]=Ke[Xe]=Ke[ze]=!1;var ke={};ke[xe]=ke[It]=ke[Le]=ke[Ve]=ke[R]=ke[S]=ke[ht]=ke[Me]=ke[St]=ke[Dt]=ke[zt]=ke[we]=ke[Ne]=ke[Se]=ke[ot]=ke[$e]=ke[Xe]=ke[Ze]=ke[kt]=ke[Mt]=ke[Wt]=ke[rr]=!0,ke[b]=ke[ee]=ke[ze]=!1;var g={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},x={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Q={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ge=parseFloat,ve=parseInt,tt=typeof Vs=="object"&&Vs&&Vs.Object===Object&&Vs,Nt=typeof self=="object"&&self&&self.Object===Object&&self,Oe=tt||Nt||Function("return this")(),We=i&&!i.nodeType&&i,wt=We&&!0&&c&&!c.nodeType&&c,ir=wt&&wt.exports===We,Lt=ir&&tt.process,rt=function(){try{var I=wt&&wt.require&&wt.require("util").types;return I||Lt&&Lt.binding&&Lt.binding("util")}catch{}}(),Qt=rt&&rt.isArrayBuffer,Ar=rt&&rt.isDate,_r=rt&&rt.isMap,Ur=rt&&rt.isRegExp,ws=rt&&rt.isSet,Ti=rt&&rt.isTypedArray;function jt(I,N,O){switch(O.length){case 0:return I.call(N);case 1:return I.call(N,O[0]);case 2:return I.call(N,O[0],O[1]);case 3:return I.call(N,O[0],O[1],O[2])}return I.apply(N,O)}function Hf(I,N,O,X){for(var de=-1,De=I==null?0:I.length;++de<De;){var $t=I[de];N(X,$t,O($t),I)}return X}function wr(I,N){for(var O=-1,X=I==null?0:I.length;++O<X&&N(I[O],O,I)!==!1;);return I}function Bf(I,N){for(var O=I==null?0:I.length;O--&&N(I[O],O,I)!==!1;);return I}function Fc(I,N){for(var O=-1,X=I==null?0:I.length;++O<X;)if(!N(I[O],O,I))return!1;return!0}function li(I,N){for(var O=-1,X=I==null?0:I.length,de=0,De=[];++O<X;){var $t=I[O];N($t,O,I)&&(De[de++]=$t)}return De}function wn(I,N){var O=I==null?0:I.length;return!!O&&Yi(I,N,0)>-1}function Vo(I,N,O){for(var X=-1,de=I==null?0:I.length;++X<de;)if(O(N,I[X]))return!0;return!1}function nt(I,N){for(var O=-1,X=I==null?0:I.length,de=Array(X);++O<X;)de[O]=N(I[O],O,I);return de}function fi(I,N){for(var O=-1,X=N.length,de=I.length;++O<X;)I[de+O]=N[O];return I}function Ko(I,N,O,X){var de=-1,De=I==null?0:I.length;for(X&&De&&(O=I[++de]);++de<De;)O=N(O,I[de],de,I);return O}function Vf(I,N,O,X){var de=I==null?0:I.length;for(X&&de&&(O=I[--de]);de--;)O=N(O,I[de],de,I);return O}function Go(I,N){for(var O=-1,X=I==null?0:I.length;++O<X;)if(N(I[O],O,I))return!0;return!1}var Kf=Wo("length");function Gf(I){return I.split("")}function Wf(I){return I.match(Tt)||[]}function Dc(I,N,O){var X;return O(I,function(de,De,$t){if(N(de,De,$t))return X=De,!1}),X}function bn(I,N,O,X){for(var de=I.length,De=O+(X?1:-1);X?De--:++De<de;)if(N(I[De],De,I))return De;return-1}function Yi(I,N,O){return N===N?op(I,N,O):bn(I,$c,O)}function Jf(I,N,O,X){for(var de=O-1,De=I.length;++de<De;)if(X(I[de],N))return de;return-1}function $c(I){return I!==I}function qc(I,N){var O=I==null?0:I.length;return O?Qo(I,N)/O:z}function Wo(I){return function(N){return N==null?r:N[I]}}function Jo(I){return function(N){return I==null?r:I[N]}}function Mc(I,N,O,X,de){return de(I,function(De,$t,Je){O=X?(X=!1,De):N(O,De,$t,Je)}),O}function Qf(I,N){var O=I.length;for(I.sort(N);O--;)I[O]=I[O].value;return I}function Qo(I,N){for(var O,X=-1,de=I.length;++X<de;){var De=N(I[X]);De!==r&&(O=O===r?De:O+De)}return O}function Yo(I,N){for(var O=-1,X=Array(I);++O<I;)X[O]=N(O);return X}function Yf(I,N){return nt(N,function(O){return[O,I[O]]})}function jc(I){return I&&I.slice(0,Hc(I)+1).replace(gt,"")}function fr(I){return function(N){return I(N)}}function Xo(I,N){return nt(N,function(O){return I[O]})}function bs(I,N){return I.has(N)}function Uc(I,N){for(var O=-1,X=I.length;++O<X&&Yi(N,I[O],0)>-1;);return O}function zc(I,N){for(var O=I.length;O--&&Yi(N,I[O],0)>-1;);return O}function Xf(I,N){for(var O=I.length,X=0;O--;)I[O]===N&&++X;return X}var Zf=Jo(g),ep=Jo(x);function tp(I){return"\\"+Q[I]}function rp(I,N){return I==null?r:I[N]}function Xi(I){return mn.test(I)}function ip(I){return Ai.test(I)}function sp(I){for(var N,O=[];!(N=I.next()).done;)O.push(N.value);return O}function Zo(I){var N=-1,O=Array(I.size);return I.forEach(function(X,de){O[++N]=[de,X]}),O}function kc(I,N){return function(O){return I(N(O))}}function pi(I,N){for(var O=-1,X=I.length,de=0,De=[];++O<X;){var $t=I[O];($t===N||$t===L)&&(I[O]=L,De[de++]=O)}return De}function En(I){var N=-1,O=Array(I.size);return I.forEach(function(X){O[++N]=X}),O}function np(I){var N=-1,O=Array(I.size);return I.forEach(function(X){O[++N]=[X,X]}),O}function op(I,N,O){for(var X=O-1,de=I.length;++X<de;)if(I[X]===N)return X;return-1}function ap(I,N,O){for(var X=O+1;X--;)if(I[X]===N)return X;return X}function Zi(I){return Xi(I)?up(I):Kf(I)}function Tr(I){return Xi(I)?hp(I):Gf(I)}function Hc(I){for(var N=I.length;N--&&_t.test(I.charAt(N)););return N}var cp=Jo($);function up(I){for(var N=Qi.lastIndex=0;Qi.test(I);)++N;return N}function hp(I){return I.match(Qi)||[]}function lp(I){return I.match(vn)||[]}var fp=function I(N){N=N==null?Oe:es.defaults(Oe.Object(),N,es.pick(Oe,_n));var O=N.Array,X=N.Date,de=N.Error,De=N.Function,$t=N.Math,Je=N.Object,ea=N.RegExp,pp=N.String,br=N.TypeError,xn=O.prototype,dp=De.prototype,ts=Je.prototype,In=N["__core-js_shared__"],Pn=dp.toString,je=ts.hasOwnProperty,gp=0,Bc=function(){var e=/[^.]+$/.exec(In&&In.keys&&In.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Sn=ts.toString,yp=Pn.call(Je),vp=Oe._,mp=ea("^"+Pn.call(je).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Cn=ir?N.Buffer:r,di=N.Symbol,On=N.Uint8Array,Vc=Cn?Cn.allocUnsafe:r,Rn=kc(Je.getPrototypeOf,Je),Kc=Je.create,Gc=ts.propertyIsEnumerable,An=xn.splice,Wc=di?di.isConcatSpreadable:r,Es=di?di.iterator:r,Ni=di?di.toStringTag:r,Tn=function(){try{var e=qi(Je,"defineProperty");return e({},"",{}),e}catch{}}(),_p=N.clearTimeout!==Oe.clearTimeout&&N.clearTimeout,wp=X&&X.now!==Oe.Date.now&&X.now,bp=N.setTimeout!==Oe.setTimeout&&N.setTimeout,Nn=$t.ceil,Ln=$t.floor,ta=Je.getOwnPropertySymbols,Ep=Cn?Cn.isBuffer:r,Jc=N.isFinite,xp=xn.join,Ip=kc(Je.keys,Je),qt=$t.max,Vt=$t.min,Pp=X.now,Sp=N.parseInt,Qc=$t.random,Cp=xn.reverse,ra=qi(N,"DataView"),xs=qi(N,"Map"),ia=qi(N,"Promise"),rs=qi(N,"Set"),Is=qi(N,"WeakMap"),Ps=qi(Je,"create"),Fn=Is&&new Is,is={},Op=Mi(ra),Rp=Mi(xs),Ap=Mi(ia),Tp=Mi(rs),Np=Mi(Is),Dn=di?di.prototype:r,Ss=Dn?Dn.valueOf:r,Yc=Dn?Dn.toString:r;function f(e){if(vt(e)&&!me(e)&&!(e instanceof Ce)){if(e instanceof Er)return e;if(je.call(e,"__wrapped__"))return Xu(e)}return new Er(e)}var ss=function(){function e(){}return function(t){if(!ut(t))return{};if(Kc)return Kc(t);e.prototype=t;var s=new e;return e.prototype=r,s}}();function $n(){}function Er(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}f.templateSettings={escape:ft,evaluate:pt,interpolate:ct,variable:"",imports:{_:f}},f.prototype=$n.prototype,f.prototype.constructor=f,Er.prototype=ss($n.prototype),Er.prototype.constructor=Er;function Ce(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=V,this.__views__=[]}function Lp(){var e=new Ce(this.__wrapped__);return e.__actions__=sr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=sr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=sr(this.__views__),e}function Fp(){if(this.__filtered__){var e=new Ce(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Dp(){var e=this.__wrapped__.value(),t=this.__dir__,s=me(e),a=t<0,l=s?e.length:0,d=Gd(0,l,this.__views__),m=d.start,w=d.end,P=w-m,F=a?w:m-1,D=this.__iteratees__,U=D.length,J=0,te=Vt(P,this.__takeCount__);if(!s||!a&&l==P&&te==P)return bu(e,this.__actions__);var oe=[];e:for(;P--&&J<te;){F+=t;for(var be=-1,ae=e[F];++be<U;){var Pe=D[be],Re=Pe.iteratee,gr=Pe.type,Zt=Re(ae);if(gr==E)ae=Zt;else if(!Zt){if(gr==v)continue e;break e}}oe[J++]=ae}return oe}Ce.prototype=ss($n.prototype),Ce.prototype.constructor=Ce;function Li(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function $p(){this.__data__=Ps?Ps(null):{},this.size=0}function qp(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Mp(e){var t=this.__data__;if(Ps){var s=t[e];return s===_?r:s}return je.call(t,e)?t[e]:r}function jp(e){var t=this.__data__;return Ps?t[e]!==r:je.call(t,e)}function Up(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Ps&&t===r?_:t,this}Li.prototype.clear=$p,Li.prototype.delete=qp,Li.prototype.get=Mp,Li.prototype.has=jp,Li.prototype.set=Up;function Jr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function zp(){this.__data__=[],this.size=0}function kp(e){var t=this.__data__,s=qn(t,e);if(s<0)return!1;var a=t.length-1;return s==a?t.pop():An.call(t,s,1),--this.size,!0}function Hp(e){var t=this.__data__,s=qn(t,e);return s<0?r:t[s][1]}function Bp(e){return qn(this.__data__,e)>-1}function Vp(e,t){var s=this.__data__,a=qn(s,e);return a<0?(++this.size,s.push([e,t])):s[a][1]=t,this}Jr.prototype.clear=zp,Jr.prototype.delete=kp,Jr.prototype.get=Hp,Jr.prototype.has=Bp,Jr.prototype.set=Vp;function Qr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function Kp(){this.size=0,this.__data__={hash:new Li,map:new(xs||Jr),string:new Li}}function Gp(e){var t=Jn(this,e).delete(e);return this.size-=t?1:0,t}function Wp(e){return Jn(this,e).get(e)}function Jp(e){return Jn(this,e).has(e)}function Qp(e,t){var s=Jn(this,e),a=s.size;return s.set(e,t),this.size+=s.size==a?0:1,this}Qr.prototype.clear=Kp,Qr.prototype.delete=Gp,Qr.prototype.get=Wp,Qr.prototype.has=Jp,Qr.prototype.set=Qp;function Fi(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new Qr;++t<s;)this.add(e[t])}function Yp(e){return this.__data__.set(e,_),this}function Xp(e){return this.__data__.has(e)}Fi.prototype.add=Fi.prototype.push=Yp,Fi.prototype.has=Xp;function Nr(e){var t=this.__data__=new Jr(e);this.size=t.size}function Zp(){this.__data__=new Jr,this.size=0}function ed(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function td(e){return this.__data__.get(e)}function rd(e){return this.__data__.has(e)}function id(e,t){var s=this.__data__;if(s instanceof Jr){var a=s.__data__;if(!xs||a.length<o-1)return a.push([e,t]),this.size=++s.size,this;s=this.__data__=new Qr(a)}return s.set(e,t),this.size=s.size,this}Nr.prototype.clear=Zp,Nr.prototype.delete=ed,Nr.prototype.get=td,Nr.prototype.has=rd,Nr.prototype.set=id;function Xc(e,t){var s=me(e),a=!s&&ji(e),l=!s&&!a&&_i(e),d=!s&&!a&&!l&&cs(e),m=s||a||l||d,w=m?Yo(e.length,pp):[],P=w.length;for(var F in e)(t||je.call(e,F))&&!(m&&(F=="length"||l&&(F=="offset"||F=="parent")||d&&(F=="buffer"||F=="byteLength"||F=="byteOffset")||ei(F,P)))&&w.push(F);return w}function Zc(e){var t=e.length;return t?e[da(0,t-1)]:r}function sd(e,t){return Qn(sr(e),Di(t,0,e.length))}function nd(e){return Qn(sr(e))}function sa(e,t,s){(s!==r&&!Lr(e[t],s)||s===r&&!(t in e))&&Yr(e,t,s)}function Cs(e,t,s){var a=e[t];(!(je.call(e,t)&&Lr(a,s))||s===r&&!(t in e))&&Yr(e,t,s)}function qn(e,t){for(var s=e.length;s--;)if(Lr(e[s][0],t))return s;return-1}function od(e,t,s,a){return gi(e,function(l,d,m){t(a,l,s(l),m)}),a}function eu(e,t){return e&&kr(t,Ut(t),e)}function ad(e,t){return e&&kr(t,or(t),e)}function Yr(e,t,s){t=="__proto__"&&Tn?Tn(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function na(e,t){for(var s=-1,a=t.length,l=O(a),d=e==null;++s<a;)l[s]=d?r:ja(e,t[s]);return l}function Di(e,t,s){return e===e&&(s!==r&&(e=e<=s?e:s),t!==r&&(e=e>=t?e:t)),e}function xr(e,t,s,a,l,d){var m,w=t&k,P=t&B,F=t&K;if(s&&(m=l?s(e,a,l,d):s(e)),m!==r)return m;if(!ut(e))return e;var D=me(e);if(D){if(m=Jd(e),!w)return sr(e,m)}else{var U=Kt(e),J=U==ee||U==fe;if(_i(e))return Iu(e,w);if(U==Se||U==xe||J&&!l){if(m=P||J?{}:Hu(e),!w)return P?Md(e,ad(m,e)):qd(e,eu(m,e))}else{if(!ke[U])return l?e:{};m=Qd(e,U,w)}}d||(d=new Nr);var te=d.get(e);if(te)return te;d.set(e,m),mh(e)?e.forEach(function(ae){m.add(xr(ae,t,s,ae,e,d))}):yh(e)&&e.forEach(function(ae,Pe){m.set(Pe,xr(ae,t,s,Pe,e,d))});var oe=F?P?Pa:Ia:P?or:Ut,be=D?r:oe(e);return wr(be||e,function(ae,Pe){be&&(Pe=ae,ae=e[Pe]),Cs(m,Pe,xr(ae,t,s,Pe,e,d))}),m}function cd(e){var t=Ut(e);return function(s){return tu(s,e,t)}}function tu(e,t,s){var a=s.length;if(e==null)return!a;for(e=Je(e);a--;){var l=s[a],d=t[l],m=e[l];if(m===r&&!(l in e)||!d(m))return!1}return!0}function ru(e,t,s){if(typeof e!="function")throw new br(p);return Fs(function(){e.apply(r,s)},t)}function Os(e,t,s,a){var l=-1,d=wn,m=!0,w=e.length,P=[],F=t.length;if(!w)return P;s&&(t=nt(t,fr(s))),a?(d=Vo,m=!1):t.length>=o&&(d=bs,m=!1,t=new Fi(t));e:for(;++l<w;){var D=e[l],U=s==null?D:s(D);if(D=a||D!==0?D:0,m&&U===U){for(var J=F;J--;)if(t[J]===U)continue e;P.push(D)}else d(t,U,a)||P.push(D)}return P}var gi=Ru(zr),iu=Ru(aa,!0);function ud(e,t){var s=!0;return gi(e,function(a,l,d){return s=!!t(a,l,d),s}),s}function Mn(e,t,s){for(var a=-1,l=e.length;++a<l;){var d=e[a],m=t(d);if(m!=null&&(w===r?m===m&&!dr(m):s(m,w)))var w=m,P=d}return P}function hd(e,t,s,a){var l=e.length;for(s=_e(s),s<0&&(s=-s>l?0:l+s),a=a===r||a>l?l:_e(a),a<0&&(a+=l),a=s>a?0:wh(a);s<a;)e[s++]=t;return e}function su(e,t){var s=[];return gi(e,function(a,l,d){t(a,l,d)&&s.push(a)}),s}function Ht(e,t,s,a,l){var d=-1,m=e.length;for(s||(s=Xd),l||(l=[]);++d<m;){var w=e[d];t>0&&s(w)?t>1?Ht(w,t-1,s,a,l):fi(l,w):a||(l[l.length]=w)}return l}var oa=Au(),nu=Au(!0);function zr(e,t){return e&&oa(e,t,Ut)}function aa(e,t){return e&&nu(e,t,Ut)}function jn(e,t){return li(t,function(s){return ti(e[s])})}function $i(e,t){t=vi(t,e);for(var s=0,a=t.length;e!=null&&s<a;)e=e[Hr(t[s++])];return s&&s==a?e:r}function ou(e,t,s){var a=t(e);return me(e)?a:fi(a,s(e))}function Yt(e){return e==null?e===r?at:Fe:Ni&&Ni in Je(e)?Kd(e):ng(e)}function ca(e,t){return e>t}function ld(e,t){return e!=null&&je.call(e,t)}function fd(e,t){return e!=null&&t in Je(e)}function pd(e,t,s){return e>=Vt(t,s)&&e<qt(t,s)}function ua(e,t,s){for(var a=s?Vo:wn,l=e[0].length,d=e.length,m=d,w=O(d),P=1/0,F=[];m--;){var D=e[m];m&&t&&(D=nt(D,fr(t))),P=Vt(D.length,P),w[m]=!s&&(t||l>=120&&D.length>=120)?new Fi(m&&D):r}D=e[0];var U=-1,J=w[0];e:for(;++U<l&&F.length<P;){var te=D[U],oe=t?t(te):te;if(te=s||te!==0?te:0,!(J?bs(J,oe):a(F,oe,s))){for(m=d;--m;){var be=w[m];if(!(be?bs(be,oe):a(e[m],oe,s)))continue e}J&&J.push(oe),F.push(te)}}return F}function dd(e,t,s,a){return zr(e,function(l,d,m){t(a,s(l),d,m)}),a}function Rs(e,t,s){t=vi(t,e),e=Gu(e,t);var a=e==null?e:e[Hr(Pr(t))];return a==null?r:jt(a,e,s)}function au(e){return vt(e)&&Yt(e)==xe}function gd(e){return vt(e)&&Yt(e)==Le}function yd(e){return vt(e)&&Yt(e)==S}function As(e,t,s,a,l){return e===t?!0:e==null||t==null||!vt(e)&&!vt(t)?e!==e&&t!==t:vd(e,t,s,a,As,l)}function vd(e,t,s,a,l,d){var m=me(e),w=me(t),P=m?It:Kt(e),F=w?It:Kt(t);P=P==xe?Se:P,F=F==xe?Se:F;var D=P==Se,U=F==Se,J=P==F;if(J&&_i(e)){if(!_i(t))return!1;m=!0,D=!1}if(J&&!D)return d||(d=new Nr),m||cs(e)?Uu(e,t,s,a,l,d):Bd(e,t,P,s,a,l,d);if(!(s&q)){var te=D&&je.call(e,"__wrapped__"),oe=U&&je.call(t,"__wrapped__");if(te||oe){var be=te?e.value():e,ae=oe?t.value():t;return d||(d=new Nr),l(be,ae,s,a,d)}}return J?(d||(d=new Nr),Vd(e,t,s,a,l,d)):!1}function md(e){return vt(e)&&Kt(e)==we}function ha(e,t,s,a){var l=s.length,d=l,m=!a;if(e==null)return!d;for(e=Je(e);l--;){var w=s[l];if(m&&w[2]?w[1]!==e[w[0]]:!(w[0]in e))return!1}for(;++l<d;){w=s[l];var P=w[0],F=e[P],D=w[1];if(m&&w[2]){if(F===r&&!(P in e))return!1}else{var U=new Nr;if(a)var J=a(F,D,P,e,t,U);if(!(J===r?As(D,F,q|W,a,U):J))return!1}}return!0}function cu(e){if(!ut(e)||eg(e))return!1;var t=ti(e)?mp:Ro;return t.test(Mi(e))}function _d(e){return vt(e)&&Yt(e)==ot}function wd(e){return vt(e)&&Kt(e)==$e}function bd(e){return vt(e)&&ro(e.length)&&!!Ke[Yt(e)]}function uu(e){return typeof e=="function"?e:e==null?ar:typeof e=="object"?me(e)?fu(e[0],e[1]):lu(e):Th(e)}function la(e){if(!Ls(e))return Ip(e);var t=[];for(var s in Je(e))je.call(e,s)&&s!="constructor"&&t.push(s);return t}function Ed(e){if(!ut(e))return sg(e);var t=Ls(e),s=[];for(var a in e)a=="constructor"&&(t||!je.call(e,a))||s.push(a);return s}function fa(e,t){return e<t}function hu(e,t){var s=-1,a=nr(e)?O(e.length):[];return gi(e,function(l,d,m){a[++s]=t(l,d,m)}),a}function lu(e){var t=Ca(e);return t.length==1&&t[0][2]?Vu(t[0][0],t[0][1]):function(s){return s===e||ha(s,e,t)}}function fu(e,t){return Ra(e)&&Bu(t)?Vu(Hr(e),t):function(s){var a=ja(s,e);return a===r&&a===t?Ua(s,e):As(t,a,q|W)}}function Un(e,t,s,a,l){e!==t&&oa(t,function(d,m){if(l||(l=new Nr),ut(d))xd(e,t,m,s,Un,a,l);else{var w=a?a(Ta(e,m),d,m+"",e,t,l):r;w===r&&(w=d),sa(e,m,w)}},or)}function xd(e,t,s,a,l,d,m){var w=Ta(e,s),P=Ta(t,s),F=m.get(P);if(F){sa(e,s,F);return}var D=d?d(w,P,s+"",e,t,m):r,U=D===r;if(U){var J=me(P),te=!J&&_i(P),oe=!J&&!te&&cs(P);D=P,J||te||oe?me(w)?D=w:bt(w)?D=sr(w):te?(U=!1,D=Iu(P,!0)):oe?(U=!1,D=Pu(P,!0)):D=[]:Ds(P)||ji(P)?(D=w,ji(w)?D=bh(w):(!ut(w)||ti(w))&&(D=Hu(P))):U=!1}U&&(m.set(P,D),l(D,P,a,d,m),m.delete(P)),sa(e,s,D)}function pu(e,t){var s=e.length;if(s)return t+=t<0?s:0,ei(t,s)?e[t]:r}function du(e,t,s){t.length?t=nt(t,function(d){return me(d)?function(m){return $i(m,d.length===1?d[0]:d)}:d}):t=[ar];var a=-1;t=nt(t,fr(ne()));var l=hu(e,function(d,m,w){var P=nt(t,function(F){return F(d)});return{criteria:P,index:++a,value:d}});return Qf(l,function(d,m){return $d(d,m,s)})}function Id(e,t){return gu(e,t,function(s,a){return Ua(e,a)})}function gu(e,t,s){for(var a=-1,l=t.length,d={};++a<l;){var m=t[a],w=$i(e,m);s(w,m)&&Ts(d,vi(m,e),w)}return d}function Pd(e){return function(t){return $i(t,e)}}function pa(e,t,s,a){var l=a?Jf:Yi,d=-1,m=t.length,w=e;for(e===t&&(t=sr(t)),s&&(w=nt(e,fr(s)));++d<m;)for(var P=0,F=t[d],D=s?s(F):F;(P=l(w,D,P,a))>-1;)w!==e&&An.call(w,P,1),An.call(e,P,1);return e}function yu(e,t){for(var s=e?t.length:0,a=s-1;s--;){var l=t[s];if(s==a||l!==d){var d=l;ei(l)?An.call(e,l,1):va(e,l)}}return e}function da(e,t){return e+Ln(Qc()*(t-e+1))}function Sd(e,t,s,a){for(var l=-1,d=qt(Nn((t-e)/(s||1)),0),m=O(d);d--;)m[a?d:++l]=e,e+=s;return m}function ga(e,t){var s="";if(!e||t<1||t>H)return s;do t%2&&(s+=e),t=Ln(t/2),t&&(e+=e);while(t);return s}function Ie(e,t){return Na(Ku(e,t,ar),e+"")}function Cd(e){return Zc(us(e))}function Od(e,t){var s=us(e);return Qn(s,Di(t,0,s.length))}function Ts(e,t,s,a){if(!ut(e))return e;t=vi(t,e);for(var l=-1,d=t.length,m=d-1,w=e;w!=null&&++l<d;){var P=Hr(t[l]),F=s;if(P==="__proto__"||P==="constructor"||P==="prototype")return e;if(l!=m){var D=w[P];F=a?a(D,P,w):r,F===r&&(F=ut(D)?D:ei(t[l+1])?[]:{})}Cs(w,P,F),w=w[P]}return e}var vu=Fn?function(e,t){return Fn.set(e,t),e}:ar,Rd=Tn?function(e,t){return Tn(e,"toString",{configurable:!0,enumerable:!1,value:ka(t),writable:!0})}:ar;function Ad(e){return Qn(us(e))}function Ir(e,t,s){var a=-1,l=e.length;t<0&&(t=-t>l?0:l+t),s=s>l?l:s,s<0&&(s+=l),l=t>s?0:s-t>>>0,t>>>=0;for(var d=O(l);++a<l;)d[a]=e[a+t];return d}function Td(e,t){var s;return gi(e,function(a,l,d){return s=t(a,l,d),!s}),!!s}function zn(e,t,s){var a=0,l=e==null?a:e.length;if(typeof t=="number"&&t===t&&l<=Be){for(;a<l;){var d=a+l>>>1,m=e[d];m!==null&&!dr(m)&&(s?m<=t:m<t)?a=d+1:l=d}return l}return ya(e,t,ar,s)}function ya(e,t,s,a){var l=0,d=e==null?0:e.length;if(d===0)return 0;t=s(t);for(var m=t!==t,w=t===null,P=dr(t),F=t===r;l<d;){var D=Ln((l+d)/2),U=s(e[D]),J=U!==r,te=U===null,oe=U===U,be=dr(U);if(m)var ae=a||oe;else F?ae=oe&&(a||J):w?ae=oe&&J&&(a||!te):P?ae=oe&&J&&!te&&(a||!be):te||be?ae=!1:ae=a?U<=t:U<t;ae?l=D+1:d=D}return Vt(d,Qe)}function mu(e,t){for(var s=-1,a=e.length,l=0,d=[];++s<a;){var m=e[s],w=t?t(m):m;if(!s||!Lr(w,P)){var P=w;d[l++]=m===0?0:m}}return d}function _u(e){return typeof e=="number"?e:dr(e)?z:+e}function pr(e){if(typeof e=="string")return e;if(me(e))return nt(e,pr)+"";if(dr(e))return Yc?Yc.call(e):"";var t=e+"";return t=="0"&&1/e==-ce?"-0":t}function yi(e,t,s){var a=-1,l=wn,d=e.length,m=!0,w=[],P=w;if(s)m=!1,l=Vo;else if(d>=o){var F=t?null:kd(e);if(F)return En(F);m=!1,l=bs,P=new Fi}else P=t?[]:w;e:for(;++a<d;){var D=e[a],U=t?t(D):D;if(D=s||D!==0?D:0,m&&U===U){for(var J=P.length;J--;)if(P[J]===U)continue e;t&&P.push(U),w.push(D)}else l(P,U,s)||(P!==w&&P.push(U),w.push(D))}return w}function va(e,t){return t=vi(t,e),e=Gu(e,t),e==null||delete e[Hr(Pr(t))]}function wu(e,t,s,a){return Ts(e,t,s($i(e,t)),a)}function kn(e,t,s,a){for(var l=e.length,d=a?l:-1;(a?d--:++d<l)&&t(e[d],d,e););return s?Ir(e,a?0:d,a?d+1:l):Ir(e,a?d+1:0,a?l:d)}function bu(e,t){var s=e;return s instanceof Ce&&(s=s.value()),Ko(t,function(a,l){return l.func.apply(l.thisArg,fi([a],l.args))},s)}function ma(e,t,s){var a=e.length;if(a<2)return a?yi(e[0]):[];for(var l=-1,d=O(a);++l<a;)for(var m=e[l],w=-1;++w<a;)w!=l&&(d[l]=Os(d[l]||m,e[w],t,s));return yi(Ht(d,1),t,s)}function Eu(e,t,s){for(var a=-1,l=e.length,d=t.length,m={};++a<l;){var w=a<d?t[a]:r;s(m,e[a],w)}return m}function _a(e){return bt(e)?e:[]}function wa(e){return typeof e=="function"?e:ar}function vi(e,t){return me(e)?e:Ra(e,t)?[e]:Yu(qe(e))}var Nd=Ie;function mi(e,t,s){var a=e.length;return s=s===r?a:s,!t&&s>=a?e:Ir(e,t,s)}var xu=_p||function(e){return Oe.clearTimeout(e)};function Iu(e,t){if(t)return e.slice();var s=e.length,a=Vc?Vc(s):new e.constructor(s);return e.copy(a),a}function ba(e){var t=new e.constructor(e.byteLength);return new On(t).set(new On(e)),t}function Ld(e,t){var s=t?ba(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function Fd(e){var t=new e.constructor(e.source,mr.exec(e));return t.lastIndex=e.lastIndex,t}function Dd(e){return Ss?Je(Ss.call(e)):{}}function Pu(e,t){var s=t?ba(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function Su(e,t){if(e!==t){var s=e!==r,a=e===null,l=e===e,d=dr(e),m=t!==r,w=t===null,P=t===t,F=dr(t);if(!w&&!F&&!d&&e>t||d&&m&&P&&!w&&!F||a&&m&&P||!s&&P||!l)return 1;if(!a&&!d&&!F&&e<t||F&&s&&l&&!a&&!d||w&&s&&l||!m&&l||!P)return-1}return 0}function $d(e,t,s){for(var a=-1,l=e.criteria,d=t.criteria,m=l.length,w=s.length;++a<m;){var P=Su(l[a],d[a]);if(P){if(a>=w)return P;var F=s[a];return P*(F=="desc"?-1:1)}}return e.index-t.index}function Cu(e,t,s,a){for(var l=-1,d=e.length,m=s.length,w=-1,P=t.length,F=qt(d-m,0),D=O(P+F),U=!a;++w<P;)D[w]=t[w];for(;++l<m;)(U||l<d)&&(D[s[l]]=e[l]);for(;F--;)D[w++]=e[l++];return D}function Ou(e,t,s,a){for(var l=-1,d=e.length,m=-1,w=s.length,P=-1,F=t.length,D=qt(d-w,0),U=O(D+F),J=!a;++l<D;)U[l]=e[l];for(var te=l;++P<F;)U[te+P]=t[P];for(;++m<w;)(J||l<d)&&(U[te+s[m]]=e[l++]);return U}function sr(e,t){var s=-1,a=e.length;for(t||(t=O(a));++s<a;)t[s]=e[s];return t}function kr(e,t,s,a){var l=!s;s||(s={});for(var d=-1,m=t.length;++d<m;){var w=t[d],P=a?a(s[w],e[w],w,s,e):r;P===r&&(P=e[w]),l?Yr(s,w,P):Cs(s,w,P)}return s}function qd(e,t){return kr(e,Oa(e),t)}function Md(e,t){return kr(e,zu(e),t)}function Hn(e,t){return function(s,a){var l=me(s)?Hf:od,d=t?t():{};return l(s,e,ne(a,2),d)}}function ns(e){return Ie(function(t,s){var a=-1,l=s.length,d=l>1?s[l-1]:r,m=l>2?s[2]:r;for(d=e.length>3&&typeof d=="function"?(l--,d):r,m&&Xt(s[0],s[1],m)&&(d=l<3?r:d,l=1),t=Je(t);++a<l;){var w=s[a];w&&e(t,w,a,d)}return t})}function Ru(e,t){return function(s,a){if(s==null)return s;if(!nr(s))return e(s,a);for(var l=s.length,d=t?l:-1,m=Je(s);(t?d--:++d<l)&&a(m[d],d,m)!==!1;);return s}}function Au(e){return function(t,s,a){for(var l=-1,d=Je(t),m=a(t),w=m.length;w--;){var P=m[e?w:++l];if(s(d[P],P,d)===!1)break}return t}}function jd(e,t,s){var a=t&ie,l=Ns(e);function d(){var m=this&&this!==Oe&&this instanceof d?l:e;return m.apply(a?s:this,arguments)}return d}function Tu(e){return function(t){t=qe(t);var s=Xi(t)?Tr(t):r,a=s?s[0]:t.charAt(0),l=s?mi(s,1).join(""):t.slice(1);return a[e]()+l}}function os(e){return function(t){return Ko(Rh(Oh(t).replace(_s,"")),e,"")}}function Ns(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=ss(e.prototype),a=e.apply(s,t);return ut(a)?a:s}}function Ud(e,t,s){var a=Ns(e);function l(){for(var d=arguments.length,m=O(d),w=d,P=as(l);w--;)m[w]=arguments[w];var F=d<3&&m[0]!==P&&m[d-1]!==P?[]:pi(m,P);if(d-=F.length,d<s)return $u(e,t,Bn,l.placeholder,r,m,F,r,r,s-d);var D=this&&this!==Oe&&this instanceof l?a:e;return jt(D,this,m)}return l}function Nu(e){return function(t,s,a){var l=Je(t);if(!nr(t)){var d=ne(s,3);t=Ut(t),s=function(w){return d(l[w],w,l)}}var m=e(t,s,a);return m>-1?l[d?t[m]:m]:r}}function Lu(e){return Zr(function(t){var s=t.length,a=s,l=Er.prototype.thru;for(e&&t.reverse();a--;){var d=t[a];if(typeof d!="function")throw new br(p);if(l&&!m&&Wn(d)=="wrapper")var m=new Er([],!0)}for(a=m?a:s;++a<s;){d=t[a];var w=Wn(d),P=w=="wrapper"?Sa(d):r;P&&Aa(P[0])&&P[1]==(M|pe|le|G)&&!P[4].length&&P[9]==1?m=m[Wn(P[0])].apply(m,P[3]):m=d.length==1&&Aa(d)?m[w]():m.thru(d)}return function(){var F=arguments,D=F[0];if(m&&F.length==1&&me(D))return m.plant(D).value();for(var U=0,J=s?t[U].apply(this,F):D;++U<s;)J=t[U].call(this,J);return J}})}function Bn(e,t,s,a,l,d,m,w,P,F){var D=t&M,U=t&ie,J=t&Ee,te=t&(pe|he),oe=t&ye,be=J?r:Ns(e);function ae(){for(var Pe=arguments.length,Re=O(Pe),gr=Pe;gr--;)Re[gr]=arguments[gr];if(te)var Zt=as(ae),yr=Xf(Re,Zt);if(a&&(Re=Cu(Re,a,l,te)),d&&(Re=Ou(Re,d,m,te)),Pe-=yr,te&&Pe<F){var Et=pi(Re,Zt);return $u(e,t,Bn,ae.placeholder,s,Re,Et,w,P,F-Pe)}var Fr=U?s:this,ii=J?Fr[e]:e;return Pe=Re.length,w?Re=og(Re,w):oe&&Pe>1&&Re.reverse(),D&&P<Pe&&(Re.length=P),this&&this!==Oe&&this instanceof ae&&(ii=be||Ns(ii)),ii.apply(Fr,Re)}return ae}function Fu(e,t){return function(s,a){return dd(s,e,t(a),{})}}function Vn(e,t){return function(s,a){var l;if(s===r&&a===r)return t;if(s!==r&&(l=s),a!==r){if(l===r)return a;typeof s=="string"||typeof a=="string"?(s=pr(s),a=pr(a)):(s=_u(s),a=_u(a)),l=e(s,a)}return l}}function Ea(e){return Zr(function(t){return t=nt(t,fr(ne())),Ie(function(s){var a=this;return e(t,function(l){return jt(l,a,s)})})})}function Kn(e,t){t=t===r?" ":pr(t);var s=t.length;if(s<2)return s?ga(t,e):t;var a=ga(t,Nn(e/Zi(t)));return Xi(t)?mi(Tr(a),0,e).join(""):a.slice(0,e)}function zd(e,t,s,a){var l=t&ie,d=Ns(e);function m(){for(var w=-1,P=arguments.length,F=-1,D=a.length,U=O(D+P),J=this&&this!==Oe&&this instanceof m?d:e;++F<D;)U[F]=a[F];for(;P--;)U[F++]=arguments[++w];return jt(J,l?s:this,U)}return m}function Du(e){return function(t,s,a){return a&&typeof a!="number"&&Xt(t,s,a)&&(s=a=r),t=ri(t),s===r?(s=t,t=0):s=ri(s),a=a===r?t<s?1:-1:ri(a),Sd(t,s,a,e)}}function Gn(e){return function(t,s){return typeof t=="string"&&typeof s=="string"||(t=Sr(t),s=Sr(s)),e(t,s)}}function $u(e,t,s,a,l,d,m,w,P,F){var D=t&pe,U=D?m:r,J=D?r:m,te=D?d:r,oe=D?r:d;t|=D?le:T,t&=~(D?T:le),t&ge||(t&=~(ie|Ee));var be=[e,t,l,te,U,oe,J,w,P,F],ae=s.apply(r,be);return Aa(e)&&Wu(ae,be),ae.placeholder=a,Ju(ae,e,t)}function xa(e){var t=$t[e];return function(s,a){if(s=Sr(s),a=a==null?0:Vt(_e(a),292),a&&Jc(s)){var l=(qe(s)+"e").split("e"),d=t(l[0]+"e"+(+l[1]+a));return l=(qe(d)+"e").split("e"),+(l[0]+"e"+(+l[1]-a))}return t(s)}}var kd=rs&&1/En(new rs([,-0]))[1]==ce?function(e){return new rs(e)}:Va;function qu(e){return function(t){var s=Kt(t);return s==we?Zo(t):s==$e?np(t):Yf(t,e(t))}}function Xr(e,t,s,a,l,d,m,w){var P=t&Ee;if(!P&&typeof e!="function")throw new br(p);var F=a?a.length:0;if(F||(t&=~(le|T),a=l=r),m=m===r?m:qt(_e(m),0),w=w===r?w:_e(w),F-=l?l.length:0,t&T){var D=a,U=l;a=l=r}var J=P?r:Sa(e),te=[e,t,s,a,l,D,U,d,m,w];if(J&&ig(te,J),e=te[0],t=te[1],s=te[2],a=te[3],l=te[4],w=te[9]=te[9]===r?P?0:e.length:qt(te[9]-F,0),!w&&t&(pe|he)&&(t&=~(pe|he)),!t||t==ie)var oe=jd(e,t,s);else t==pe||t==he?oe=Ud(e,t,w):(t==le||t==(ie|le))&&!l.length?oe=zd(e,t,s,a):oe=Bn.apply(r,te);var be=J?vu:Wu;return Ju(be(oe,te),e,t)}function Mu(e,t,s,a){return e===r||Lr(e,ts[s])&&!je.call(a,s)?t:e}function ju(e,t,s,a,l,d){return ut(e)&&ut(t)&&(d.set(t,e),Un(e,t,r,ju,d),d.delete(t)),e}function Hd(e){return Ds(e)?r:e}function Uu(e,t,s,a,l,d){var m=s&q,w=e.length,P=t.length;if(w!=P&&!(m&&P>w))return!1;var F=d.get(e),D=d.get(t);if(F&&D)return F==t&&D==e;var U=-1,J=!0,te=s&W?new Fi:r;for(d.set(e,t),d.set(t,e);++U<w;){var oe=e[U],be=t[U];if(a)var ae=m?a(be,oe,U,t,e,d):a(oe,be,U,e,t,d);if(ae!==r){if(ae)continue;J=!1;break}if(te){if(!Go(t,function(Pe,Re){if(!bs(te,Re)&&(oe===Pe||l(oe,Pe,s,a,d)))return te.push(Re)})){J=!1;break}}else if(!(oe===be||l(oe,be,s,a,d))){J=!1;break}}return d.delete(e),d.delete(t),J}function Bd(e,t,s,a,l,d,m){switch(s){case Ve:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Le:return!(e.byteLength!=t.byteLength||!d(new On(e),new On(t)));case R:case S:case Ne:return Lr(+e,+t);case b:return e.name==t.name&&e.message==t.message;case ot:case Xe:return e==t+"";case we:var w=Zo;case $e:var P=a&q;if(w||(w=En),e.size!=t.size&&!P)return!1;var F=m.get(e);if(F)return F==t;a|=W,m.set(e,t);var D=Uu(w(e),w(t),a,l,d,m);return m.delete(e),D;case Ze:if(Ss)return Ss.call(e)==Ss.call(t)}return!1}function Vd(e,t,s,a,l,d){var m=s&q,w=Ia(e),P=w.length,F=Ia(t),D=F.length;if(P!=D&&!m)return!1;for(var U=P;U--;){var J=w[U];if(!(m?J in t:je.call(t,J)))return!1}var te=d.get(e),oe=d.get(t);if(te&&oe)return te==t&&oe==e;var be=!0;d.set(e,t),d.set(t,e);for(var ae=m;++U<P;){J=w[U];var Pe=e[J],Re=t[J];if(a)var gr=m?a(Re,Pe,J,t,e,d):a(Pe,Re,J,e,t,d);if(!(gr===r?Pe===Re||l(Pe,Re,s,a,d):gr)){be=!1;break}ae||(ae=J=="constructor")}if(be&&!ae){var Zt=e.constructor,yr=t.constructor;Zt!=yr&&"constructor"in e&&"constructor"in t&&!(typeof Zt=="function"&&Zt instanceof Zt&&typeof yr=="function"&&yr instanceof yr)&&(be=!1)}return d.delete(e),d.delete(t),be}function Zr(e){return Na(Ku(e,r,th),e+"")}function Ia(e){return ou(e,Ut,Oa)}function Pa(e){return ou(e,or,zu)}var Sa=Fn?function(e){return Fn.get(e)}:Va;function Wn(e){for(var t=e.name+"",s=is[t],a=je.call(is,t)?s.length:0;a--;){var l=s[a],d=l.func;if(d==null||d==e)return l.name}return t}function as(e){var t=je.call(f,"placeholder")?f:e;return t.placeholder}function ne(){var e=f.iteratee||Ha;return e=e===Ha?uu:e,arguments.length?e(arguments[0],arguments[1]):e}function Jn(e,t){var s=e.__data__;return Zd(t)?s[typeof t=="string"?"string":"hash"]:s.map}function Ca(e){for(var t=Ut(e),s=t.length;s--;){var a=t[s],l=e[a];t[s]=[a,l,Bu(l)]}return t}function qi(e,t){var s=rp(e,t);return cu(s)?s:r}function Kd(e){var t=je.call(e,Ni),s=e[Ni];try{e[Ni]=r;var a=!0}catch{}var l=Sn.call(e);return a&&(t?e[Ni]=s:delete e[Ni]),l}var Oa=ta?function(e){return e==null?[]:(e=Je(e),li(ta(e),function(t){return Gc.call(e,t)}))}:Ka,zu=ta?function(e){for(var t=[];e;)fi(t,Oa(e)),e=Rn(e);return t}:Ka,Kt=Yt;(ra&&Kt(new ra(new ArrayBuffer(1)))!=Ve||xs&&Kt(new xs)!=we||ia&&Kt(ia.resolve())!=Pt||rs&&Kt(new rs)!=$e||Is&&Kt(new Is)!=ze)&&(Kt=function(e){var t=Yt(e),s=t==Se?e.constructor:r,a=s?Mi(s):"";if(a)switch(a){case Op:return Ve;case Rp:return we;case Ap:return Pt;case Tp:return $e;case Np:return ze}return t});function Gd(e,t,s){for(var a=-1,l=s.length;++a<l;){var d=s[a],m=d.size;switch(d.type){case"drop":e+=m;break;case"dropRight":t-=m;break;case"take":t=Vt(t,e+m);break;case"takeRight":e=qt(e,t-m);break}}return{start:e,end:t}}function Wd(e){var t=e.match(Ye);return t?t[1].split(At):[]}function ku(e,t,s){t=vi(t,e);for(var a=-1,l=t.length,d=!1;++a<l;){var m=Hr(t[a]);if(!(d=e!=null&&s(e,m)))break;e=e[m]}return d||++a!=l?d:(l=e==null?0:e.length,!!l&&ro(l)&&ei(m,l)&&(me(e)||ji(e)))}function Jd(e){var t=e.length,s=new e.constructor(t);return t&&typeof e[0]=="string"&&je.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function Hu(e){return typeof e.constructor=="function"&&!Ls(e)?ss(Rn(e)):{}}function Qd(e,t,s){var a=e.constructor;switch(t){case Le:return ba(e);case R:case S:return new a(+e);case Ve:return Ld(e,s);case ht:case Me:case St:case Dt:case zt:case kt:case Mt:case Wt:case rr:return Pu(e,s);case we:return new a;case Ne:case Xe:return new a(e);case ot:return Fd(e);case $e:return new a;case Ze:return Dd(e)}}function Yd(e,t){var s=t.length;if(!s)return e;var a=s-1;return t[a]=(s>1?"& ":"")+t[a],t=t.join(s>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+t+`] */
`)}function Xd(e){return me(e)||ji(e)||!!(Wc&&e&&e[Wc])}function ei(e,t){var s=typeof e;return t=t??H,!!t&&(s=="number"||s!="symbol"&&To.test(e))&&e>-1&&e%1==0&&e<t}function Xt(e,t,s){if(!ut(s))return!1;var a=typeof t;return(a=="number"?nr(s)&&ei(t,s.length):a=="string"&&t in s)?Lr(s[t],e):!1}function Ra(e,t){if(me(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||dr(e)?!0:Ct.test(e)||!st.test(e)||t!=null&&e in Je(t)}function Zd(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Aa(e){var t=Wn(e),s=f[t];if(typeof s!="function"||!(t in Ce.prototype))return!1;if(e===s)return!0;var a=Sa(s);return!!a&&e===a[0]}function eg(e){return!!Bc&&Bc in e}var tg=In?ti:Ga;function Ls(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||ts;return e===s}function Bu(e){return e===e&&!ut(e)}function Vu(e,t){return function(s){return s==null?!1:s[e]===t&&(t!==r||e in Je(s))}}function rg(e){var t=eo(e,function(a){return s.size===C&&s.clear(),a}),s=t.cache;return t}function ig(e,t){var s=e[1],a=t[1],l=s|a,d=l<(ie|Ee|M),m=a==M&&s==pe||a==M&&s==G&&e[7].length<=t[8]||a==(M|G)&&t[7].length<=t[8]&&s==pe;if(!(d||m))return e;a&ie&&(e[2]=t[2],l|=s&ie?0:ge);var w=t[3];if(w){var P=e[3];e[3]=P?Cu(P,w,t[4]):w,e[4]=P?pi(e[3],L):t[4]}return w=t[5],w&&(P=e[5],e[5]=P?Ou(P,w,t[6]):w,e[6]=P?pi(e[5],L):t[6]),w=t[7],w&&(e[7]=w),a&M&&(e[8]=e[8]==null?t[8]:Vt(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=l,e}function sg(e){var t=[];if(e!=null)for(var s in Je(e))t.push(s);return t}function ng(e){return Sn.call(e)}function Ku(e,t,s){return t=qt(t===r?e.length-1:t,0),function(){for(var a=arguments,l=-1,d=qt(a.length-t,0),m=O(d);++l<d;)m[l]=a[t+l];l=-1;for(var w=O(t+1);++l<t;)w[l]=a[l];return w[t]=s(m),jt(e,this,w)}}function Gu(e,t){return t.length<2?e:$i(e,Ir(t,0,-1))}function og(e,t){for(var s=e.length,a=Vt(t.length,s),l=sr(e);a--;){var d=t[a];e[a]=ei(d,s)?l[d]:r}return e}function Ta(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Wu=Qu(vu),Fs=bp||function(e,t){return Oe.setTimeout(e,t)},Na=Qu(Rd);function Ju(e,t,s){var a=t+"";return Na(e,Yd(a,ag(Wd(a),s)))}function Qu(e){var t=0,s=0;return function(){var a=Pp(),l=Ue-(a-s);if(s=a,l>0){if(++t>=Te)return arguments[0]}else t=0;return e.apply(r,arguments)}}function Qn(e,t){var s=-1,a=e.length,l=a-1;for(t=t===r?a:t;++s<t;){var d=da(s,l),m=e[d];e[d]=e[s],e[s]=m}return e.length=t,e}var Yu=rg(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ot,function(s,a,l,d){t.push(l?d.replace(Po,"$1"):a||s)}),t});function Hr(e){if(typeof e=="string"||dr(e))return e;var t=e+"";return t=="0"&&1/e==-ce?"-0":t}function Mi(e){if(e!=null){try{return Pn.call(e)}catch{}try{return e+""}catch{}}return""}function ag(e,t){return wr(qr,function(s){var a="_."+s[0];t&s[1]&&!wn(e,a)&&e.push(a)}),e.sort()}function Xu(e){if(e instanceof Ce)return e.clone();var t=new Er(e.__wrapped__,e.__chain__);return t.__actions__=sr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function cg(e,t,s){(s?Xt(e,t,s):t===r)?t=1:t=qt(_e(t),0);var a=e==null?0:e.length;if(!a||t<1)return[];for(var l=0,d=0,m=O(Nn(a/t));l<a;)m[d++]=Ir(e,l,l+=t);return m}function ug(e){for(var t=-1,s=e==null?0:e.length,a=0,l=[];++t<s;){var d=e[t];d&&(l[a++]=d)}return l}function hg(){var e=arguments.length;if(!e)return[];for(var t=O(e-1),s=arguments[0],a=e;a--;)t[a-1]=arguments[a];return fi(me(s)?sr(s):[s],Ht(t,1))}var lg=Ie(function(e,t){return bt(e)?Os(e,Ht(t,1,bt,!0)):[]}),fg=Ie(function(e,t){var s=Pr(t);return bt(s)&&(s=r),bt(e)?Os(e,Ht(t,1,bt,!0),ne(s,2)):[]}),pg=Ie(function(e,t){var s=Pr(t);return bt(s)&&(s=r),bt(e)?Os(e,Ht(t,1,bt,!0),r,s):[]});function dg(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===r?1:_e(t),Ir(e,t<0?0:t,a)):[]}function gg(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===r?1:_e(t),t=a-t,Ir(e,0,t<0?0:t)):[]}function yg(e,t){return e&&e.length?kn(e,ne(t,3),!0,!0):[]}function vg(e,t){return e&&e.length?kn(e,ne(t,3),!0):[]}function mg(e,t,s,a){var l=e==null?0:e.length;return l?(s&&typeof s!="number"&&Xt(e,t,s)&&(s=0,a=l),hd(e,t,s,a)):[]}function Zu(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var l=s==null?0:_e(s);return l<0&&(l=qt(a+l,0)),bn(e,ne(t,3),l)}function eh(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var l=a-1;return s!==r&&(l=_e(s),l=s<0?qt(a+l,0):Vt(l,a-1)),bn(e,ne(t,3),l,!0)}function th(e){var t=e==null?0:e.length;return t?Ht(e,1):[]}function _g(e){var t=e==null?0:e.length;return t?Ht(e,ce):[]}function wg(e,t){var s=e==null?0:e.length;return s?(t=t===r?1:_e(t),Ht(e,t)):[]}function bg(e){for(var t=-1,s=e==null?0:e.length,a={};++t<s;){var l=e[t];a[l[0]]=l[1]}return a}function rh(e){return e&&e.length?e[0]:r}function Eg(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var l=s==null?0:_e(s);return l<0&&(l=qt(a+l,0)),Yi(e,t,l)}function xg(e){var t=e==null?0:e.length;return t?Ir(e,0,-1):[]}var Ig=Ie(function(e){var t=nt(e,_a);return t.length&&t[0]===e[0]?ua(t):[]}),Pg=Ie(function(e){var t=Pr(e),s=nt(e,_a);return t===Pr(s)?t=r:s.pop(),s.length&&s[0]===e[0]?ua(s,ne(t,2)):[]}),Sg=Ie(function(e){var t=Pr(e),s=nt(e,_a);return t=typeof t=="function"?t:r,t&&s.pop(),s.length&&s[0]===e[0]?ua(s,r,t):[]});function Cg(e,t){return e==null?"":xp.call(e,t)}function Pr(e){var t=e==null?0:e.length;return t?e[t-1]:r}function Og(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var l=a;return s!==r&&(l=_e(s),l=l<0?qt(a+l,0):Vt(l,a-1)),t===t?ap(e,t,l):bn(e,$c,l,!0)}function Rg(e,t){return e&&e.length?pu(e,_e(t)):r}var Ag=Ie(ih);function ih(e,t){return e&&e.length&&t&&t.length?pa(e,t):e}function Tg(e,t,s){return e&&e.length&&t&&t.length?pa(e,t,ne(s,2)):e}function Ng(e,t,s){return e&&e.length&&t&&t.length?pa(e,t,r,s):e}var Lg=Zr(function(e,t){var s=e==null?0:e.length,a=na(e,t);return yu(e,nt(t,function(l){return ei(l,s)?+l:l}).sort(Su)),a});function Fg(e,t){var s=[];if(!(e&&e.length))return s;var a=-1,l=[],d=e.length;for(t=ne(t,3);++a<d;){var m=e[a];t(m,a,e)&&(s.push(m),l.push(a))}return yu(e,l),s}function La(e){return e==null?e:Cp.call(e)}function Dg(e,t,s){var a=e==null?0:e.length;return a?(s&&typeof s!="number"&&Xt(e,t,s)?(t=0,s=a):(t=t==null?0:_e(t),s=s===r?a:_e(s)),Ir(e,t,s)):[]}function $g(e,t){return zn(e,t)}function qg(e,t,s){return ya(e,t,ne(s,2))}function Mg(e,t){var s=e==null?0:e.length;if(s){var a=zn(e,t);if(a<s&&Lr(e[a],t))return a}return-1}function jg(e,t){return zn(e,t,!0)}function Ug(e,t,s){return ya(e,t,ne(s,2),!0)}function zg(e,t){var s=e==null?0:e.length;if(s){var a=zn(e,t,!0)-1;if(Lr(e[a],t))return a}return-1}function kg(e){return e&&e.length?mu(e):[]}function Hg(e,t){return e&&e.length?mu(e,ne(t,2)):[]}function Bg(e){var t=e==null?0:e.length;return t?Ir(e,1,t):[]}function Vg(e,t,s){return e&&e.length?(t=s||t===r?1:_e(t),Ir(e,0,t<0?0:t)):[]}function Kg(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===r?1:_e(t),t=a-t,Ir(e,t<0?0:t,a)):[]}function Gg(e,t){return e&&e.length?kn(e,ne(t,3),!1,!0):[]}function Wg(e,t){return e&&e.length?kn(e,ne(t,3)):[]}var Jg=Ie(function(e){return yi(Ht(e,1,bt,!0))}),Qg=Ie(function(e){var t=Pr(e);return bt(t)&&(t=r),yi(Ht(e,1,bt,!0),ne(t,2))}),Yg=Ie(function(e){var t=Pr(e);return t=typeof t=="function"?t:r,yi(Ht(e,1,bt,!0),r,t)});function Xg(e){return e&&e.length?yi(e):[]}function Zg(e,t){return e&&e.length?yi(e,ne(t,2)):[]}function ey(e,t){return t=typeof t=="function"?t:r,e&&e.length?yi(e,r,t):[]}function Fa(e){if(!(e&&e.length))return[];var t=0;return e=li(e,function(s){if(bt(s))return t=qt(s.length,t),!0}),Yo(t,function(s){return nt(e,Wo(s))})}function sh(e,t){if(!(e&&e.length))return[];var s=Fa(e);return t==null?s:nt(s,function(a){return jt(t,r,a)})}var ty=Ie(function(e,t){return bt(e)?Os(e,t):[]}),ry=Ie(function(e){return ma(li(e,bt))}),iy=Ie(function(e){var t=Pr(e);return bt(t)&&(t=r),ma(li(e,bt),ne(t,2))}),sy=Ie(function(e){var t=Pr(e);return t=typeof t=="function"?t:r,ma(li(e,bt),r,t)}),ny=Ie(Fa);function oy(e,t){return Eu(e||[],t||[],Cs)}function ay(e,t){return Eu(e||[],t||[],Ts)}var cy=Ie(function(e){var t=e.length,s=t>1?e[t-1]:r;return s=typeof s=="function"?(e.pop(),s):r,sh(e,s)});function nh(e){var t=f(e);return t.__chain__=!0,t}function uy(e,t){return t(e),e}function Yn(e,t){return t(e)}var hy=Zr(function(e){var t=e.length,s=t?e[0]:0,a=this.__wrapped__,l=function(d){return na(d,e)};return t>1||this.__actions__.length||!(a instanceof Ce)||!ei(s)?this.thru(l):(a=a.slice(s,+s+(t?1:0)),a.__actions__.push({func:Yn,args:[l],thisArg:r}),new Er(a,this.__chain__).thru(function(d){return t&&!d.length&&d.push(r),d}))});function ly(){return nh(this)}function fy(){return new Er(this.value(),this.__chain__)}function py(){this.__values__===r&&(this.__values__=_h(this.value()));var e=this.__index__>=this.__values__.length,t=e?r:this.__values__[this.__index__++];return{done:e,value:t}}function dy(){return this}function gy(e){for(var t,s=this;s instanceof $n;){var a=Xu(s);a.__index__=0,a.__values__=r,t?l.__wrapped__=a:t=a;var l=a;s=s.__wrapped__}return l.__wrapped__=e,t}function yy(){var e=this.__wrapped__;if(e instanceof Ce){var t=e;return this.__actions__.length&&(t=new Ce(this)),t=t.reverse(),t.__actions__.push({func:Yn,args:[La],thisArg:r}),new Er(t,this.__chain__)}return this.thru(La)}function vy(){return bu(this.__wrapped__,this.__actions__)}var my=Hn(function(e,t,s){je.call(e,s)?++e[s]:Yr(e,s,1)});function _y(e,t,s){var a=me(e)?Fc:ud;return s&&Xt(e,t,s)&&(t=r),a(e,ne(t,3))}function wy(e,t){var s=me(e)?li:su;return s(e,ne(t,3))}var by=Nu(Zu),Ey=Nu(eh);function xy(e,t){return Ht(Xn(e,t),1)}function Iy(e,t){return Ht(Xn(e,t),ce)}function Py(e,t,s){return s=s===r?1:_e(s),Ht(Xn(e,t),s)}function oh(e,t){var s=me(e)?wr:gi;return s(e,ne(t,3))}function ah(e,t){var s=me(e)?Bf:iu;return s(e,ne(t,3))}var Sy=Hn(function(e,t,s){je.call(e,s)?e[s].push(t):Yr(e,s,[t])});function Cy(e,t,s,a){e=nr(e)?e:us(e),s=s&&!a?_e(s):0;var l=e.length;return s<0&&(s=qt(l+s,0)),io(e)?s<=l&&e.indexOf(t,s)>-1:!!l&&Yi(e,t,s)>-1}var Oy=Ie(function(e,t,s){var a=-1,l=typeof t=="function",d=nr(e)?O(e.length):[];return gi(e,function(m){d[++a]=l?jt(t,m,s):Rs(m,t,s)}),d}),Ry=Hn(function(e,t,s){Yr(e,s,t)});function Xn(e,t){var s=me(e)?nt:hu;return s(e,ne(t,3))}function Ay(e,t,s,a){return e==null?[]:(me(t)||(t=t==null?[]:[t]),s=a?r:s,me(s)||(s=s==null?[]:[s]),du(e,t,s))}var Ty=Hn(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});function Ny(e,t,s){var a=me(e)?Ko:Mc,l=arguments.length<3;return a(e,ne(t,4),s,l,gi)}function Ly(e,t,s){var a=me(e)?Vf:Mc,l=arguments.length<3;return a(e,ne(t,4),s,l,iu)}function Fy(e,t){var s=me(e)?li:su;return s(e,to(ne(t,3)))}function Dy(e){var t=me(e)?Zc:Cd;return t(e)}function $y(e,t,s){(s?Xt(e,t,s):t===r)?t=1:t=_e(t);var a=me(e)?sd:Od;return a(e,t)}function qy(e){var t=me(e)?nd:Ad;return t(e)}function My(e){if(e==null)return 0;if(nr(e))return io(e)?Zi(e):e.length;var t=Kt(e);return t==we||t==$e?e.size:la(e).length}function jy(e,t,s){var a=me(e)?Go:Td;return s&&Xt(e,t,s)&&(t=r),a(e,ne(t,3))}var Uy=Ie(function(e,t){if(e==null)return[];var s=t.length;return s>1&&Xt(e,t[0],t[1])?t=[]:s>2&&Xt(t[0],t[1],t[2])&&(t=[t[0]]),du(e,Ht(t,1),[])}),Zn=wp||function(){return Oe.Date.now()};function zy(e,t){if(typeof t!="function")throw new br(p);return e=_e(e),function(){if(--e<1)return t.apply(this,arguments)}}function ch(e,t,s){return t=s?r:t,t=e&&t==null?e.length:t,Xr(e,M,r,r,r,r,t)}function uh(e,t){var s;if(typeof t!="function")throw new br(p);return e=_e(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=r),s}}var Da=Ie(function(e,t,s){var a=ie;if(s.length){var l=pi(s,as(Da));a|=le}return Xr(e,a,t,s,l)}),hh=Ie(function(e,t,s){var a=ie|Ee;if(s.length){var l=pi(s,as(hh));a|=le}return Xr(t,a,e,s,l)});function lh(e,t,s){t=s?r:t;var a=Xr(e,pe,r,r,r,r,r,t);return a.placeholder=lh.placeholder,a}function fh(e,t,s){t=s?r:t;var a=Xr(e,he,r,r,r,r,r,t);return a.placeholder=fh.placeholder,a}function ph(e,t,s){var a,l,d,m,w,P,F=0,D=!1,U=!1,J=!0;if(typeof e!="function")throw new br(p);t=Sr(t)||0,ut(s)&&(D=!!s.leading,U="maxWait"in s,d=U?qt(Sr(s.maxWait)||0,t):d,J="trailing"in s?!!s.trailing:J);function te(Et){var Fr=a,ii=l;return a=l=r,F=Et,m=e.apply(ii,Fr),m}function oe(Et){return F=Et,w=Fs(Pe,t),D?te(Et):m}function be(Et){var Fr=Et-P,ii=Et-F,Nh=t-Fr;return U?Vt(Nh,d-ii):Nh}function ae(Et){var Fr=Et-P,ii=Et-F;return P===r||Fr>=t||Fr<0||U&&ii>=d}function Pe(){var Et=Zn();if(ae(Et))return Re(Et);w=Fs(Pe,be(Et))}function Re(Et){return w=r,J&&a?te(Et):(a=l=r,m)}function gr(){w!==r&&xu(w),F=0,a=P=l=w=r}function Zt(){return w===r?m:Re(Zn())}function yr(){var Et=Zn(),Fr=ae(Et);if(a=arguments,l=this,P=Et,Fr){if(w===r)return oe(P);if(U)return xu(w),w=Fs(Pe,t),te(P)}return w===r&&(w=Fs(Pe,t)),m}return yr.cancel=gr,yr.flush=Zt,yr}var ky=Ie(function(e,t){return ru(e,1,t)}),Hy=Ie(function(e,t,s){return ru(e,Sr(t)||0,s)});function By(e){return Xr(e,ye)}function eo(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new br(p);var s=function(){var a=arguments,l=t?t.apply(this,a):a[0],d=s.cache;if(d.has(l))return d.get(l);var m=e.apply(this,a);return s.cache=d.set(l,m)||d,m};return s.cache=new(eo.Cache||Qr),s}eo.Cache=Qr;function to(e){if(typeof e!="function")throw new br(p);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function Vy(e){return uh(2,e)}var Ky=Nd(function(e,t){t=t.length==1&&me(t[0])?nt(t[0],fr(ne())):nt(Ht(t,1),fr(ne()));var s=t.length;return Ie(function(a){for(var l=-1,d=Vt(a.length,s);++l<d;)a[l]=t[l].call(this,a[l]);return jt(e,this,a)})}),$a=Ie(function(e,t){var s=pi(t,as($a));return Xr(e,le,r,t,s)}),dh=Ie(function(e,t){var s=pi(t,as(dh));return Xr(e,T,r,t,s)}),Gy=Zr(function(e,t){return Xr(e,G,r,r,r,t)});function Wy(e,t){if(typeof e!="function")throw new br(p);return t=t===r?t:_e(t),Ie(e,t)}function Jy(e,t){if(typeof e!="function")throw new br(p);return t=t==null?0:qt(_e(t),0),Ie(function(s){var a=s[t],l=mi(s,0,t);return a&&fi(l,a),jt(e,this,l)})}function Qy(e,t,s){var a=!0,l=!0;if(typeof e!="function")throw new br(p);return ut(s)&&(a="leading"in s?!!s.leading:a,l="trailing"in s?!!s.trailing:l),ph(e,t,{leading:a,maxWait:t,trailing:l})}function Yy(e){return ch(e,1)}function Xy(e,t){return $a(wa(t),e)}function Zy(){if(!arguments.length)return[];var e=arguments[0];return me(e)?e:[e]}function ev(e){return xr(e,K)}function tv(e,t){return t=typeof t=="function"?t:r,xr(e,K,t)}function rv(e){return xr(e,k|K)}function iv(e,t){return t=typeof t=="function"?t:r,xr(e,k|K,t)}function sv(e,t){return t==null||tu(e,t,Ut(t))}function Lr(e,t){return e===t||e!==e&&t!==t}var nv=Gn(ca),ov=Gn(function(e,t){return e>=t}),ji=au(function(){return arguments}())?au:function(e){return vt(e)&&je.call(e,"callee")&&!Gc.call(e,"callee")},me=O.isArray,av=Qt?fr(Qt):gd;function nr(e){return e!=null&&ro(e.length)&&!ti(e)}function bt(e){return vt(e)&&nr(e)}function cv(e){return e===!0||e===!1||vt(e)&&Yt(e)==R}var _i=Ep||Ga,uv=Ar?fr(Ar):yd;function hv(e){return vt(e)&&e.nodeType===1&&!Ds(e)}function lv(e){if(e==null)return!0;if(nr(e)&&(me(e)||typeof e=="string"||typeof e.splice=="function"||_i(e)||cs(e)||ji(e)))return!e.length;var t=Kt(e);if(t==we||t==$e)return!e.size;if(Ls(e))return!la(e).length;for(var s in e)if(je.call(e,s))return!1;return!0}function fv(e,t){return As(e,t)}function pv(e,t,s){s=typeof s=="function"?s:r;var a=s?s(e,t):r;return a===r?As(e,t,r,s):!!a}function qa(e){if(!vt(e))return!1;var t=Yt(e);return t==b||t==u||typeof e.message=="string"&&typeof e.name=="string"&&!Ds(e)}function dv(e){return typeof e=="number"&&Jc(e)}function ti(e){if(!ut(e))return!1;var t=Yt(e);return t==ee||t==fe||t==A||t==mt}function gh(e){return typeof e=="number"&&e==_e(e)}function ro(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=H}function ut(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function vt(e){return e!=null&&typeof e=="object"}var yh=_r?fr(_r):md;function gv(e,t){return e===t||ha(e,t,Ca(t))}function yv(e,t,s){return s=typeof s=="function"?s:r,ha(e,t,Ca(t),s)}function vv(e){return vh(e)&&e!=+e}function mv(e){if(tg(e))throw new de(h);return cu(e)}function _v(e){return e===null}function wv(e){return e==null}function vh(e){return typeof e=="number"||vt(e)&&Yt(e)==Ne}function Ds(e){if(!vt(e)||Yt(e)!=Se)return!1;var t=Rn(e);if(t===null)return!0;var s=je.call(t,"constructor")&&t.constructor;return typeof s=="function"&&s instanceof s&&Pn.call(s)==yp}var Ma=Ur?fr(Ur):_d;function bv(e){return gh(e)&&e>=-H&&e<=H}var mh=ws?fr(ws):wd;function io(e){return typeof e=="string"||!me(e)&&vt(e)&&Yt(e)==Xe}function dr(e){return typeof e=="symbol"||vt(e)&&Yt(e)==Ze}var cs=Ti?fr(Ti):bd;function Ev(e){return e===r}function xv(e){return vt(e)&&Kt(e)==ze}function Iv(e){return vt(e)&&Yt(e)==et}var Pv=Gn(fa),Sv=Gn(function(e,t){return e<=t});function _h(e){if(!e)return[];if(nr(e))return io(e)?Tr(e):sr(e);if(Es&&e[Es])return sp(e[Es]());var t=Kt(e),s=t==we?Zo:t==$e?En:us;return s(e)}function ri(e){if(!e)return e===0?e:0;if(e=Sr(e),e===ce||e===-ce){var t=e<0?-1:1;return t*j}return e===e?e:0}function _e(e){var t=ri(e),s=t%1;return t===t?s?t-s:t:0}function wh(e){return e?Di(_e(e),0,V):0}function Sr(e){if(typeof e=="number")return e;if(dr(e))return z;if(ut(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ut(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=jc(e);var s=Oo.test(e);return s||Ao.test(e)?ve(e.slice(2),s?2:8):Co.test(e)?z:+e}function bh(e){return kr(e,or(e))}function Cv(e){return e?Di(_e(e),-H,H):e===0?e:0}function qe(e){return e==null?"":pr(e)}var Ov=ns(function(e,t){if(Ls(t)||nr(t)){kr(t,Ut(t),e);return}for(var s in t)je.call(t,s)&&Cs(e,s,t[s])}),Eh=ns(function(e,t){kr(t,or(t),e)}),so=ns(function(e,t,s,a){kr(t,or(t),e,a)}),Rv=ns(function(e,t,s,a){kr(t,Ut(t),e,a)}),Av=Zr(na);function Tv(e,t){var s=ss(e);return t==null?s:eu(s,t)}var Nv=Ie(function(e,t){e=Je(e);var s=-1,a=t.length,l=a>2?t[2]:r;for(l&&Xt(t[0],t[1],l)&&(a=1);++s<a;)for(var d=t[s],m=or(d),w=-1,P=m.length;++w<P;){var F=m[w],D=e[F];(D===r||Lr(D,ts[F])&&!je.call(e,F))&&(e[F]=d[F])}return e}),Lv=Ie(function(e){return e.push(r,ju),jt(xh,r,e)});function Fv(e,t){return Dc(e,ne(t,3),zr)}function Dv(e,t){return Dc(e,ne(t,3),aa)}function $v(e,t){return e==null?e:oa(e,ne(t,3),or)}function qv(e,t){return e==null?e:nu(e,ne(t,3),or)}function Mv(e,t){return e&&zr(e,ne(t,3))}function jv(e,t){return e&&aa(e,ne(t,3))}function Uv(e){return e==null?[]:jn(e,Ut(e))}function zv(e){return e==null?[]:jn(e,or(e))}function ja(e,t,s){var a=e==null?r:$i(e,t);return a===r?s:a}function kv(e,t){return e!=null&&ku(e,t,ld)}function Ua(e,t){return e!=null&&ku(e,t,fd)}var Hv=Fu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=Sn.call(t)),e[t]=s},ka(ar)),Bv=Fu(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=Sn.call(t)),je.call(e,t)?e[t].push(s):e[t]=[s]},ne),Vv=Ie(Rs);function Ut(e){return nr(e)?Xc(e):la(e)}function or(e){return nr(e)?Xc(e,!0):Ed(e)}function Kv(e,t){var s={};return t=ne(t,3),zr(e,function(a,l,d){Yr(s,t(a,l,d),a)}),s}function Gv(e,t){var s={};return t=ne(t,3),zr(e,function(a,l,d){Yr(s,l,t(a,l,d))}),s}var Wv=ns(function(e,t,s){Un(e,t,s)}),xh=ns(function(e,t,s,a){Un(e,t,s,a)}),Jv=Zr(function(e,t){var s={};if(e==null)return s;var a=!1;t=nt(t,function(d){return d=vi(d,e),a||(a=d.length>1),d}),kr(e,Pa(e),s),a&&(s=xr(s,k|B|K,Hd));for(var l=t.length;l--;)va(s,t[l]);return s});function Qv(e,t){return Ih(e,to(ne(t)))}var Yv=Zr(function(e,t){return e==null?{}:Id(e,t)});function Ih(e,t){if(e==null)return{};var s=nt(Pa(e),function(a){return[a]});return t=ne(t),gu(e,s,function(a,l){return t(a,l[0])})}function Xv(e,t,s){t=vi(t,e);var a=-1,l=t.length;for(l||(l=1,e=r);++a<l;){var d=e==null?r:e[Hr(t[a])];d===r&&(a=l,d=s),e=ti(d)?d.call(e):d}return e}function Zv(e,t,s){return e==null?e:Ts(e,t,s)}function e0(e,t,s,a){return a=typeof a=="function"?a:r,e==null?e:Ts(e,t,s,a)}var Ph=qu(Ut),Sh=qu(or);function t0(e,t,s){var a=me(e),l=a||_i(e)||cs(e);if(t=ne(t,4),s==null){var d=e&&e.constructor;l?s=a?new d:[]:ut(e)?s=ti(d)?ss(Rn(e)):{}:s={}}return(l?wr:zr)(e,function(m,w,P){return t(s,m,w,P)}),s}function r0(e,t){return e==null?!0:va(e,t)}function i0(e,t,s){return e==null?e:wu(e,t,wa(s))}function s0(e,t,s,a){return a=typeof a=="function"?a:r,e==null?e:wu(e,t,wa(s),a)}function us(e){return e==null?[]:Xo(e,Ut(e))}function n0(e){return e==null?[]:Xo(e,or(e))}function o0(e,t,s){return s===r&&(s=t,t=r),s!==r&&(s=Sr(s),s=s===s?s:0),t!==r&&(t=Sr(t),t=t===t?t:0),Di(Sr(e),t,s)}function a0(e,t,s){return t=ri(t),s===r?(s=t,t=0):s=ri(s),e=Sr(e),pd(e,t,s)}function c0(e,t,s){if(s&&typeof s!="boolean"&&Xt(e,t,s)&&(t=s=r),s===r&&(typeof t=="boolean"?(s=t,t=r):typeof e=="boolean"&&(s=e,e=r)),e===r&&t===r?(e=0,t=1):(e=ri(e),t===r?(t=e,e=0):t=ri(t)),e>t){var a=e;e=t,t=a}if(s||e%1||t%1){var l=Qc();return Vt(e+l*(t-e+Ge("1e-"+((l+"").length-1))),t)}return da(e,t)}var u0=os(function(e,t,s){return t=t.toLowerCase(),e+(s?Ch(t):t)});function Ch(e){return za(qe(e).toLowerCase())}function Oh(e){return e=qe(e),e&&e.replace(Gr,Zf).replace(Ho,"")}function h0(e,t,s){e=qe(e),t=pr(t);var a=e.length;s=s===r?a:Di(_e(s),0,a);var l=s;return s-=t.length,s>=0&&e.slice(s,l)==t}function l0(e){return e=qe(e),e&&it.test(e)?e.replace(Si,ep):e}function f0(e){return e=qe(e),e&&Rt.test(e)?e.replace(dt,"\\$&"):e}var p0=os(function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}),d0=os(function(e,t,s){return e+(s?" ":"")+t.toLowerCase()}),g0=Tu("toLowerCase");function y0(e,t,s){e=qe(e),t=_e(t);var a=t?Zi(e):0;if(!t||a>=t)return e;var l=(t-a)/2;return Kn(Ln(l),s)+e+Kn(Nn(l),s)}function v0(e,t,s){e=qe(e),t=_e(t);var a=t?Zi(e):0;return t&&a<t?e+Kn(t-a,s):e}function m0(e,t,s){e=qe(e),t=_e(t);var a=t?Zi(e):0;return t&&a<t?Kn(t-a,s)+e:e}function _0(e,t,s){return s||t==null?t=0:t&&(t=+t),Sp(qe(e).replace(gt,""),t||0)}function w0(e,t,s){return(s?Xt(e,t,s):t===r)?t=1:t=_e(t),ga(qe(e),t)}function b0(){var e=arguments,t=qe(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var E0=os(function(e,t,s){return e+(s?"_":"")+t.toLowerCase()});function x0(e,t,s){return s&&typeof s!="number"&&Xt(e,t,s)&&(t=s=r),s=s===r?V:s>>>0,s?(e=qe(e),e&&(typeof t=="string"||t!=null&&!Ma(t))&&(t=pr(t),!t&&Xi(e))?mi(Tr(e),0,s):e.split(t,s)):[]}var I0=os(function(e,t,s){return e+(s?" ":"")+za(t)});function P0(e,t,s){return e=qe(e),s=s==null?0:Di(_e(s),0,e.length),t=pr(t),e.slice(s,s+t.length)==t}function S0(e,t,s){var a=f.templateSettings;s&&Xt(e,t,s)&&(t=r),e=qe(e),t=so({},t,a,Mu);var l=so({},t.imports,a.imports,Mu),d=Ut(l),m=Xo(l,d),w,P,F=0,D=t.interpolate||Bi,U="__p += '",J=ea((t.escape||Bi).source+"|"+D.source+"|"+(D===ct?So:Bi).source+"|"+(t.evaluate||Bi).source+"|$","g"),te="//# sourceURL="+(je.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Bo+"]")+`
`;e.replace(J,function(ae,Pe,Re,gr,Zt,yr){return Re||(Re=gr),U+=e.slice(F,yr).replace(No,tp),Pe&&(w=!0,U+=`' +
__e(`+Pe+`) +
'`),Zt&&(P=!0,U+=`';
`+Zt+`;
__p += '`),Re&&(U+=`' +
((__t = (`+Re+`)) == null ? '' : __t) +
'`),F=yr+ae.length,ae}),U+=`';
`;var oe=je.call(t,"variable")&&t.variable;if(!oe)U=`with (obj) {
`+U+`
}
`;else if(Io.test(oe))throw new de(y);U=(P?U.replace(Mr,""):U).replace(Jt,"$1").replace(Kr,"$1;"),U="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(P?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+U+`return __p
}`;var be=Ah(function(){return De(d,te+"return "+U).apply(r,m)});if(be.source=U,qa(be))throw be;return be}function C0(e){return qe(e).toLowerCase()}function O0(e){return qe(e).toUpperCase()}function R0(e,t,s){if(e=qe(e),e&&(s||t===r))return jc(e);if(!e||!(t=pr(t)))return e;var a=Tr(e),l=Tr(t),d=Uc(a,l),m=zc(a,l)+1;return mi(a,d,m).join("")}function A0(e,t,s){if(e=qe(e),e&&(s||t===r))return e.slice(0,Hc(e)+1);if(!e||!(t=pr(t)))return e;var a=Tr(e),l=zc(a,Tr(t))+1;return mi(a,0,l).join("")}function T0(e,t,s){if(e=qe(e),e&&(s||t===r))return e.replace(gt,"");if(!e||!(t=pr(t)))return e;var a=Tr(e),l=Uc(a,Tr(t));return mi(a,l).join("")}function N0(e,t){var s=re,a=ue;if(ut(t)){var l="separator"in t?t.separator:l;s="length"in t?_e(t.length):s,a="omission"in t?pr(t.omission):a}e=qe(e);var d=e.length;if(Xi(e)){var m=Tr(e);d=m.length}if(s>=d)return e;var w=s-Zi(a);if(w<1)return a;var P=m?mi(m,0,w).join(""):e.slice(0,w);if(l===r)return P+a;if(m&&(w+=P.length-w),Ma(l)){if(e.slice(w).search(l)){var F,D=P;for(l.global||(l=ea(l.source,qe(mr.exec(l))+"g")),l.lastIndex=0;F=l.exec(D);)var U=F.index;P=P.slice(0,U===r?w:U)}}else if(e.indexOf(pr(l),w)!=w){var J=P.lastIndexOf(l);J>-1&&(P=P.slice(0,J))}return P+a}function L0(e){return e=qe(e),e&&lt.test(e)?e.replace(ui,cp):e}var F0=os(function(e,t,s){return e+(s?" ":"")+t.toUpperCase()}),za=Tu("toUpperCase");function Rh(e,t,s){return e=qe(e),t=s?r:t,t===r?ip(e)?lp(e):Wf(e):e.match(t)||[]}var Ah=Ie(function(e,t){try{return jt(e,r,t)}catch(s){return qa(s)?s:new de(s)}}),D0=Zr(function(e,t){return wr(t,function(s){s=Hr(s),Yr(e,s,Da(e[s],e))}),e});function $0(e){var t=e==null?0:e.length,s=ne();return e=t?nt(e,function(a){if(typeof a[1]!="function")throw new br(p);return[s(a[0]),a[1]]}):[],Ie(function(a){for(var l=-1;++l<t;){var d=e[l];if(jt(d[0],this,a))return jt(d[1],this,a)}})}function q0(e){return cd(xr(e,k))}function ka(e){return function(){return e}}function M0(e,t){return e==null||e!==e?t:e}var j0=Lu(),U0=Lu(!0);function ar(e){return e}function Ha(e){return uu(typeof e=="function"?e:xr(e,k))}function z0(e){return lu(xr(e,k))}function k0(e,t){return fu(e,xr(t,k))}var H0=Ie(function(e,t){return function(s){return Rs(s,e,t)}}),B0=Ie(function(e,t){return function(s){return Rs(e,s,t)}});function Ba(e,t,s){var a=Ut(t),l=jn(t,a);s==null&&!(ut(t)&&(l.length||!a.length))&&(s=t,t=e,e=this,l=jn(t,Ut(t)));var d=!(ut(s)&&"chain"in s)||!!s.chain,m=ti(e);return wr(l,function(w){var P=t[w];e[w]=P,m&&(e.prototype[w]=function(){var F=this.__chain__;if(d||F){var D=e(this.__wrapped__),U=D.__actions__=sr(this.__actions__);return U.push({func:P,args:arguments,thisArg:e}),D.__chain__=F,D}return P.apply(e,fi([this.value()],arguments))})}),e}function V0(){return Oe._===this&&(Oe._=vp),this}function Va(){}function K0(e){return e=_e(e),Ie(function(t){return pu(t,e)})}var G0=Ea(nt),W0=Ea(Fc),J0=Ea(Go);function Th(e){return Ra(e)?Wo(Hr(e)):Pd(e)}function Q0(e){return function(t){return e==null?r:$i(e,t)}}var Y0=Du(),X0=Du(!0);function Ka(){return[]}function Ga(){return!1}function Z0(){return{}}function e1(){return""}function t1(){return!0}function r1(e,t){if(e=_e(e),e<1||e>H)return[];var s=V,a=Vt(e,V);t=ne(t),e-=V;for(var l=Yo(a,t);++s<e;)t(s);return l}function i1(e){return me(e)?nt(e,Hr):dr(e)?[e]:sr(Yu(qe(e)))}function s1(e){var t=++gp;return qe(e)+t}var n1=Vn(function(e,t){return e+t},0),o1=xa("ceil"),a1=Vn(function(e,t){return e/t},1),c1=xa("floor");function u1(e){return e&&e.length?Mn(e,ar,ca):r}function h1(e,t){return e&&e.length?Mn(e,ne(t,2),ca):r}function l1(e){return qc(e,ar)}function f1(e,t){return qc(e,ne(t,2))}function p1(e){return e&&e.length?Mn(e,ar,fa):r}function d1(e,t){return e&&e.length?Mn(e,ne(t,2),fa):r}var g1=Vn(function(e,t){return e*t},1),y1=xa("round"),v1=Vn(function(e,t){return e-t},0);function m1(e){return e&&e.length?Qo(e,ar):0}function _1(e,t){return e&&e.length?Qo(e,ne(t,2)):0}return f.after=zy,f.ary=ch,f.assign=Ov,f.assignIn=Eh,f.assignInWith=so,f.assignWith=Rv,f.at=Av,f.before=uh,f.bind=Da,f.bindAll=D0,f.bindKey=hh,f.castArray=Zy,f.chain=nh,f.chunk=cg,f.compact=ug,f.concat=hg,f.cond=$0,f.conforms=q0,f.constant=ka,f.countBy=my,f.create=Tv,f.curry=lh,f.curryRight=fh,f.debounce=ph,f.defaults=Nv,f.defaultsDeep=Lv,f.defer=ky,f.delay=Hy,f.difference=lg,f.differenceBy=fg,f.differenceWith=pg,f.drop=dg,f.dropRight=gg,f.dropRightWhile=yg,f.dropWhile=vg,f.fill=mg,f.filter=wy,f.flatMap=xy,f.flatMapDeep=Iy,f.flatMapDepth=Py,f.flatten=th,f.flattenDeep=_g,f.flattenDepth=wg,f.flip=By,f.flow=j0,f.flowRight=U0,f.fromPairs=bg,f.functions=Uv,f.functionsIn=zv,f.groupBy=Sy,f.initial=xg,f.intersection=Ig,f.intersectionBy=Pg,f.intersectionWith=Sg,f.invert=Hv,f.invertBy=Bv,f.invokeMap=Oy,f.iteratee=Ha,f.keyBy=Ry,f.keys=Ut,f.keysIn=or,f.map=Xn,f.mapKeys=Kv,f.mapValues=Gv,f.matches=z0,f.matchesProperty=k0,f.memoize=eo,f.merge=Wv,f.mergeWith=xh,f.method=H0,f.methodOf=B0,f.mixin=Ba,f.negate=to,f.nthArg=K0,f.omit=Jv,f.omitBy=Qv,f.once=Vy,f.orderBy=Ay,f.over=G0,f.overArgs=Ky,f.overEvery=W0,f.overSome=J0,f.partial=$a,f.partialRight=dh,f.partition=Ty,f.pick=Yv,f.pickBy=Ih,f.property=Th,f.propertyOf=Q0,f.pull=Ag,f.pullAll=ih,f.pullAllBy=Tg,f.pullAllWith=Ng,f.pullAt=Lg,f.range=Y0,f.rangeRight=X0,f.rearg=Gy,f.reject=Fy,f.remove=Fg,f.rest=Wy,f.reverse=La,f.sampleSize=$y,f.set=Zv,f.setWith=e0,f.shuffle=qy,f.slice=Dg,f.sortBy=Uy,f.sortedUniq=kg,f.sortedUniqBy=Hg,f.split=x0,f.spread=Jy,f.tail=Bg,f.take=Vg,f.takeRight=Kg,f.takeRightWhile=Gg,f.takeWhile=Wg,f.tap=uy,f.throttle=Qy,f.thru=Yn,f.toArray=_h,f.toPairs=Ph,f.toPairsIn=Sh,f.toPath=i1,f.toPlainObject=bh,f.transform=t0,f.unary=Yy,f.union=Jg,f.unionBy=Qg,f.unionWith=Yg,f.uniq=Xg,f.uniqBy=Zg,f.uniqWith=ey,f.unset=r0,f.unzip=Fa,f.unzipWith=sh,f.update=i0,f.updateWith=s0,f.values=us,f.valuesIn=n0,f.without=ty,f.words=Rh,f.wrap=Xy,f.xor=ry,f.xorBy=iy,f.xorWith=sy,f.zip=ny,f.zipObject=oy,f.zipObjectDeep=ay,f.zipWith=cy,f.entries=Ph,f.entriesIn=Sh,f.extend=Eh,f.extendWith=so,Ba(f,f),f.add=n1,f.attempt=Ah,f.camelCase=u0,f.capitalize=Ch,f.ceil=o1,f.clamp=o0,f.clone=ev,f.cloneDeep=rv,f.cloneDeepWith=iv,f.cloneWith=tv,f.conformsTo=sv,f.deburr=Oh,f.defaultTo=M0,f.divide=a1,f.endsWith=h0,f.eq=Lr,f.escape=l0,f.escapeRegExp=f0,f.every=_y,f.find=by,f.findIndex=Zu,f.findKey=Fv,f.findLast=Ey,f.findLastIndex=eh,f.findLastKey=Dv,f.floor=c1,f.forEach=oh,f.forEachRight=ah,f.forIn=$v,f.forInRight=qv,f.forOwn=Mv,f.forOwnRight=jv,f.get=ja,f.gt=nv,f.gte=ov,f.has=kv,f.hasIn=Ua,f.head=rh,f.identity=ar,f.includes=Cy,f.indexOf=Eg,f.inRange=a0,f.invoke=Vv,f.isArguments=ji,f.isArray=me,f.isArrayBuffer=av,f.isArrayLike=nr,f.isArrayLikeObject=bt,f.isBoolean=cv,f.isBuffer=_i,f.isDate=uv,f.isElement=hv,f.isEmpty=lv,f.isEqual=fv,f.isEqualWith=pv,f.isError=qa,f.isFinite=dv,f.isFunction=ti,f.isInteger=gh,f.isLength=ro,f.isMap=yh,f.isMatch=gv,f.isMatchWith=yv,f.isNaN=vv,f.isNative=mv,f.isNil=wv,f.isNull=_v,f.isNumber=vh,f.isObject=ut,f.isObjectLike=vt,f.isPlainObject=Ds,f.isRegExp=Ma,f.isSafeInteger=bv,f.isSet=mh,f.isString=io,f.isSymbol=dr,f.isTypedArray=cs,f.isUndefined=Ev,f.isWeakMap=xv,f.isWeakSet=Iv,f.join=Cg,f.kebabCase=p0,f.last=Pr,f.lastIndexOf=Og,f.lowerCase=d0,f.lowerFirst=g0,f.lt=Pv,f.lte=Sv,f.max=u1,f.maxBy=h1,f.mean=l1,f.meanBy=f1,f.min=p1,f.minBy=d1,f.stubArray=Ka,f.stubFalse=Ga,f.stubObject=Z0,f.stubString=e1,f.stubTrue=t1,f.multiply=g1,f.nth=Rg,f.noConflict=V0,f.noop=Va,f.now=Zn,f.pad=y0,f.padEnd=v0,f.padStart=m0,f.parseInt=_0,f.random=c0,f.reduce=Ny,f.reduceRight=Ly,f.repeat=w0,f.replace=b0,f.result=Xv,f.round=y1,f.runInContext=I,f.sample=Dy,f.size=My,f.snakeCase=E0,f.some=jy,f.sortedIndex=$g,f.sortedIndexBy=qg,f.sortedIndexOf=Mg,f.sortedLastIndex=jg,f.sortedLastIndexBy=Ug,f.sortedLastIndexOf=zg,f.startCase=I0,f.startsWith=P0,f.subtract=v1,f.sum=m1,f.sumBy=_1,f.template=S0,f.times=r1,f.toFinite=ri,f.toInteger=_e,f.toLength=wh,f.toLower=C0,f.toNumber=Sr,f.toSafeInteger=Cv,f.toString=qe,f.toUpper=O0,f.trim=R0,f.trimEnd=A0,f.trimStart=T0,f.truncate=N0,f.unescape=L0,f.uniqueId=s1,f.upperCase=F0,f.upperFirst=za,f.each=oh,f.eachRight=ah,f.first=rh,Ba(f,function(){var e={};return zr(f,function(t,s){je.call(f.prototype,s)||(e[s]=t)}),e}(),{chain:!1}),f.VERSION=n,wr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),wr(["drop","take"],function(e,t){Ce.prototype[e]=function(s){s=s===r?1:qt(_e(s),0);var a=this.__filtered__&&!t?new Ce(this):this.clone();return a.__filtered__?a.__takeCount__=Vt(s,a.__takeCount__):a.__views__.push({size:Vt(s,V),type:e+(a.__dir__<0?"Right":"")}),a},Ce.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),wr(["filter","map","takeWhile"],function(e,t){var s=t+1,a=s==v||s==Y;Ce.prototype[e]=function(l){var d=this.clone();return d.__iteratees__.push({iteratee:ne(l,3),type:s}),d.__filtered__=d.__filtered__||a,d}}),wr(["head","last"],function(e,t){var s="take"+(t?"Right":"");Ce.prototype[e]=function(){return this[s](1).value()[0]}}),wr(["initial","tail"],function(e,t){var s="drop"+(t?"":"Right");Ce.prototype[e]=function(){return this.__filtered__?new Ce(this):this[s](1)}}),Ce.prototype.compact=function(){return this.filter(ar)},Ce.prototype.find=function(e){return this.filter(e).head()},Ce.prototype.findLast=function(e){return this.reverse().find(e)},Ce.prototype.invokeMap=Ie(function(e,t){return typeof e=="function"?new Ce(this):this.map(function(s){return Rs(s,e,t)})}),Ce.prototype.reject=function(e){return this.filter(to(ne(e)))},Ce.prototype.slice=function(e,t){e=_e(e);var s=this;return s.__filtered__&&(e>0||t<0)?new Ce(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==r&&(t=_e(t),s=t<0?s.dropRight(-t):s.take(t-e)),s)},Ce.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ce.prototype.toArray=function(){return this.take(V)},zr(Ce.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),a=/^(?:head|last)$/.test(t),l=f[a?"take"+(t=="last"?"Right":""):t],d=a||/^find/.test(t);l&&(f.prototype[t]=function(){var m=this.__wrapped__,w=a?[1]:arguments,P=m instanceof Ce,F=w[0],D=P||me(m),U=function(Pe){var Re=l.apply(f,fi([Pe],w));return a&&J?Re[0]:Re};D&&s&&typeof F=="function"&&F.length!=1&&(P=D=!1);var J=this.__chain__,te=!!this.__actions__.length,oe=d&&!J,be=P&&!te;if(!d&&D){m=be?m:new Ce(this);var ae=e.apply(m,w);return ae.__actions__.push({func:Yn,args:[U],thisArg:r}),new Er(ae,J)}return oe&&be?e.apply(this,w):(ae=this.thru(U),oe?a?ae.value()[0]:ae.value():ae)})}),wr(["pop","push","shift","sort","splice","unshift"],function(e){var t=xn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",a=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var l=arguments;if(a&&!this.__chain__){var d=this.value();return t.apply(me(d)?d:[],l)}return this[s](function(m){return t.apply(me(m)?m:[],l)})}}),zr(Ce.prototype,function(e,t){var s=f[t];if(s){var a=s.name+"";je.call(is,a)||(is[a]=[]),is[a].push({name:t,func:s})}}),is[Bn(r,Ee).name]=[{name:"wrapper",func:r}],Ce.prototype.clone=Lp,Ce.prototype.reverse=Fp,Ce.prototype.value=Dp,f.prototype.at=hy,f.prototype.chain=ly,f.prototype.commit=fy,f.prototype.next=py,f.prototype.plant=gy,f.prototype.reverse=yy,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=vy,f.prototype.first=f.prototype.head,Es&&(f.prototype[Es]=dy),f},es=fp();wt?((wt.exports=es)._=es,We._=es):Oe._=es}).call(Vs)})(gc,gc.exports);var _E=Object.defineProperty,wE=Object.defineProperties,bE=Object.getOwnPropertyDescriptors,$l=Object.getOwnPropertySymbols,EE=Object.prototype.hasOwnProperty,xE=Object.prototype.propertyIsEnumerable,ql=(c,i,r)=>i in c?_E(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,ao=(c,i)=>{for(var r in i||(i={}))EE.call(i,r)&&ql(c,r,i[r]);if($l)for(var r of $l(i))xE.call(i,r)&&ql(c,r,i[r]);return c},IE=(c,i)=>wE(c,bE(i));function Or(c,i,r){let n;const o=yc(c);return i.rpcMap&&(n=i.rpcMap[o]),n||(n=`${mE}?chainId=eip155:${o}&projectId=${r}`),n}function yc(c){return c.includes("eip155")?Number(c.split(":")[1]):Number(c)}function zf(c){return c.map(i=>`${i.split(":")[0]}:${i.split(":")[1]}`)}function PE(c,i){const r=Object.keys(i.namespaces).filter(o=>o.includes(c));if(!r.length)return[];const n=[];return r.forEach(o=>{const h=i.namespaces[o].accounts;n.push(...h)}),n}function SE(c={},i={}){const r=Ml(c),n=Ml(i);return gc.exports.merge(r,n)}function Ml(c){var i,r,n,o;const h={};if(!ho(c))return h;for(const[p,y]of Object.entries(c)){const _=Yl(p)?[p]:y.chains,C=y.methods||[],L=y.events||[],k=y.rpcMap||{},B=Ks(p);h[B]=IE(ao(ao({},h[B]),y),{chains:Ja(_,(i=h[B])==null?void 0:i.chains),methods:Ja(C,(r=h[B])==null?void 0:r.methods),events:Ja(L,(n=h[B])==null?void 0:n.events),rpcMap:ao(ao({},k),(o=h[B])==null?void 0:o.rpcMap)})}return h}function CE(c){return c.includes(":")?c.split(":")[2]:c}function OE(c){const i={};for(const[r,n]of Object.entries(c)){const o=n.methods||[],h=n.events||[],p=n.accounts||[],y=Yl(r)?[r]:n.chains?n.chains:zf(n.accounts);i[r]={chains:y,methods:o,events:h,accounts:p}}return i}function oc(c){return typeof c=="number"?c:c.includes("0x")?parseInt(c,16):c.includes(":")?Number(c.split(":")[1]):Number(c)}const kf={},xt=c=>kf[c],ac=(c,i)=>{kf[c]=i};class RE{constructor(i){this.name="polkadot",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const n=r||Or(`${this.name}:${i}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Or(i,this.namespace);return typeof n>"u"?void 0:new Ii(new Hi(n,xt("disableProviderPing")))}}class AE{constructor(i){this.name="eip155",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(i){switch(i.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(i);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(i.request.method)?await this.client.request(i):this.getHttpProvider().request(i.request)}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}setDefaultChain(i,r){const n=yc(i);if(!this.httpProviders[n]){const o=r||Or(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,o)}this.chainId=n,this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}createHttpProvider(i,r){const n=r||Or(`${this.name}:${i}`,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ii(new Hi(n,xt("disableProviderPing")))}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;const o=yc(r);i[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const i=this.chainId,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}async handleSwitchChain(i){var r,n;let o=i.request.params?(r=i.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const h=parseInt(o,16);if(this.isChainApproved(h))this.setDefaultChain(`${h}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:i.topic,request:{method:i.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${h}`);else throw new Error(`Failed to switch to chain 'eip155:${h}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(i){return this.namespace.chains.includes(`${this.name}:${i}`)}}class TE{constructor(i){this.name="solana",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(!this.httpProviders[i]){const n=r||Or(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.chainId=i,this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Or(i,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ii(new Hi(n,xt("disableProviderPing")))}}class NE{constructor(i){this.name="cosmos",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const n=r||Or(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Or(i,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ii(new Hi(n,xt("disableProviderPing")))}}class LE{constructor(i){this.name="cip34",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(this.chainId=i,!this.httpProviders[i]){const n=r||this.getCardanoRPCUrl(i);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r);i[r]=this.createHttpProvider(r,n)}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}getCardanoRPCUrl(i){const r=this.namespace.rpcMap;if(r)return r[i]}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||this.getCardanoRPCUrl(i);return typeof n>"u"?void 0:new Ii(new Hi(n,xt("disableProviderPing")))}}class FE{constructor(i){this.name="elrond",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(!this.httpProviders[i]){const n=r||Or(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.chainId=i,this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Or(i,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ii(new Hi(n,xt("disableProviderPing")))}}class DE{constructor(i){this.name="multiversx",this.namespace=i.namespace,this.events=xt("events"),this.client=xt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(i){this.namespace=Object.assign(this.namespace,i)}requestAccounts(){return this.getAccounts()}request(i){return this.namespace.methods.includes(i.request.method)?this.client.request(i):this.getHttpProvider().request(i.request)}setDefaultChain(i,r){if(!this.httpProviders[i]){const n=r||Or(`${this.name}:${i}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${i}`);this.setHttpProvider(i,n)}this.chainId=i,this.events.emit(Pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const i=this.namespace.chains[0];if(!i)throw new Error("ChainId not found");return i.split(":")[1]}getAccounts(){const i=this.namespace.accounts;return i?[...new Set(i.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const i={};return this.namespace.chains.forEach(r=>{var n;i[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),i}getHttpProvider(){const i=`${this.name}:${this.chainId}`,r=this.httpProviders[i];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${i} not found`);return r}setHttpProvider(i,r){const n=this.createHttpProvider(i,r);n&&(this.httpProviders[i]=n)}createHttpProvider(i,r){const n=r||Or(i,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ii(new Hi(n,xt("disableProviderPing")))}}var $E=Object.defineProperty,qE=Object.defineProperties,ME=Object.getOwnPropertyDescriptors,jl=Object.getOwnPropertySymbols,jE=Object.prototype.hasOwnProperty,UE=Object.prototype.propertyIsEnumerable,Ul=(c,i,r)=>i in c?$E(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,co=(c,i)=>{for(var r in i||(i={}))jE.call(i,r)&&Ul(c,r,i[r]);if(jl)for(var r of jl(i))UE.call(i,r)&&Ul(c,r,i[r]);return c},cc=(c,i)=>qE(c,ME(i));class Nc{constructor(i){this.events=new Ec,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=i,this.logger=typeof(i==null?void 0:i.logger)<"u"&&typeof(i==null?void 0:i.logger)!="string"?i.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:(i==null?void 0:i.logger)||Fl})),this.disableProviderPing=(i==null?void 0:i.disableProviderPing)||!1}static async init(i){const r=new Nc(i);return await r.initialize(),r}async request(i,r){const[n,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:co({},i),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(i,r,n){this.request(i,n).then(o=>r(null,o)).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var i;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(i=this.session)==null?void 0:i.topic,reason:tr("USER_DISCONNECTED")}),await this.cleanup()}async connect(i){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(i),await this.cleanupPendingPairings(),!i.skipPairing)return await this.pair(i.pairingTopic)}on(i,r){this.events.on(i,r)}once(i,r){this.events.once(i,r)}removeListener(i,r){this.events.removeListener(i,r)}off(i,r){this.events.off(i,r)}get isWalletConnect(){return!0}async pair(i){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:i,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(h=>{this.session=h,this.namespaces||(this.namespaces=OE(h.namespaces),this.persist("namespaces",this.namespaces))}).catch(h=>{if(h.message!==jf)throw h;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(i,r){try{if(!this.session)return;const[n,o]=this.validateChain(i);this.getProvider(n).setDefaultChain(o,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(i={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(gs(r)){for(const n of r)i.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const i=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[i]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await lE.init({logger:this.providerOpts.logger||Fl,relayUrl:this.providerOpts.relayUrl||gE,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const i=[...new Set(Object.keys(this.session.namespaces).map(r=>Ks(r)))];ac("client",this.client),ac("events",this.events),ac("disableProviderPing",this.disableProviderPing),i.forEach(r=>{if(!this.session)return;const n=PE(r,this.session),o=zf(n),h=SE(this.namespaces,this.optionalNamespaces),p=cc(co({},h[r]),{accounts:n,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new AE({namespace:p});break;case"solana":this.rpcProviders[r]=new TE({namespace:p});break;case"cosmos":this.rpcProviders[r]=new NE({namespace:p});break;case"polkadot":this.rpcProviders[r]=new RE({namespace:p});break;case"cip34":this.rpcProviders[r]=new LE({namespace:p});break;case"elrond":this.rpcProviders[r]=new FE({namespace:p});break;case"multiversx":this.rpcProviders[r]=new DE({namespace:p});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",i=>{this.events.emit("session_ping",i)}),this.client.on("session_event",i=>{const{params:r}=i,{event:n}=r;if(n.name==="accountsChanged"){const o=n.data;o&&gs(o)&&this.events.emit("accountsChanged",o.map(CE))}else if(n.name==="chainChanged"){const o=r.chainId,h=r.event.data,p=Ks(o),y=oc(o)!==oc(h)?`${p}:${oc(h)}`:o;this.onChainChanged(y)}else this.events.emit(n.name,n.data);this.events.emit("session_event",i)}),this.client.on("session_update",({topic:i,params:r})=>{var n;const{namespaces:o}=r,h=(n=this.client)==null?void 0:n.session.get(i);this.session=cc(co({},h),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:i,params:r})}),this.client.on("session_delete",async i=>{await this.cleanup(),this.events.emit("session_delete",i),this.events.emit("disconnect",cc(co({},tr("USER_DISCONNECTED")),{data:i.topic}))}),this.on(Pi.DEFAULT_CHAIN_CHANGED,i=>{this.onChainChanged(i,!0)})}getProvider(i){if(!this.rpcProviders[i])throw new Error(`Provider not found: ${i}`);return this.rpcProviders[i]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(i=>{var r;this.getProvider(i).updateNamespace((r=this.session)==null?void 0:r.namespaces[i])})}setNamespaces(i){const{namespaces:r,optionalNamespaces:n,sessionProperties:o}=i;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(i){const[r,n]=(i==null?void 0:i.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(p=>Ks(p)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const o=Ks(Object.keys(this.namespaces)[0]),h=this.rpcProviders[o].getDefaultChain();return[o,h]}async requestAccounts(){const[i]=this.validateChain();return await this.getProvider(i).requestAccounts()}onChainChanged(i,r=!1){var n;if(!this.namespaces)return;const[o,h]=this.validateChain(i);r||this.getProvider(o).setDefaultChain(h),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${h}`]).defaultChain=h,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",h)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(i,r){this.client.core.storage.setItem(`${Dl}/${i}`,r)}async getFromStore(i){return await this.client.core.storage.getItem(`${Dl}/${i}`)}}const zE=Nc,kE="wc",HE="ethereum_provider",BE=`${kE}@2:${HE}:`,VE="https://rpc.walletconnect.com/v1/",vc=["eth_sendTransaction","personal_sign"],KE=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],mc=["chainChanged","accountsChanged"],GE=["message","disconnect","connect"];var WE=Object.defineProperty,JE=Object.defineProperties,QE=Object.getOwnPropertyDescriptors,zl=Object.getOwnPropertySymbols,YE=Object.prototype.hasOwnProperty,XE=Object.prototype.propertyIsEnumerable,kl=(c,i,r)=>i in c?WE(c,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):c[i]=r,Gs=(c,i)=>{for(var r in i||(i={}))YE.call(i,r)&&kl(c,r,i[r]);if(zl)for(var r of zl(i))XE.call(i,r)&&kl(c,r,i[r]);return c},Hl=(c,i)=>JE(c,QE(i));function yo(c){return Number(c[0].split(":")[1])}function uc(c){return`0x${c.toString(16)}`}function ZE(c){const{chains:i,optionalChains:r,methods:n,optionalMethods:o,events:h,optionalEvents:p,rpcMap:y}=c;if(!gs(i))throw new Error("Invalid chains");const _={chains:i,methods:n||vc,events:h||mc,rpcMap:Gs({},i.length?{[yo(i)]:y[yo(i)]}:{})},C=h==null?void 0:h.filter(K=>!mc.includes(K)),L=n==null?void 0:n.filter(K=>!vc.includes(K));if(!r&&!p&&!o&&!(C!=null&&C.length)&&!(L!=null&&L.length))return{required:i.length?_:void 0};const k=(C==null?void 0:C.length)&&(L==null?void 0:L.length)||!r,B={chains:[...new Set(k?_.chains.concat(r||[]):r)],methods:[...new Set(_.methods.concat(o!=null&&o.length?o:KE))],events:[...new Set(_.events.concat(p||GE))],rpcMap:y};return{required:i.length?_:void 0,optional:r.length?B:void 0}}class Lc{constructor(){this.events=new vr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=BE,this.on=(i,r)=>(this.events.on(i,r),this),this.once=(i,r)=>(this.events.once(i,r),this),this.removeListener=(i,r)=>(this.events.removeListener(i,r),this),this.off=(i,r)=>(this.events.off(i,r),this),this.parseAccount=i=>this.isCompatibleChainId(i)?this.parseAccountId(i).address:i,this.signer={},this.rpc={}}static async init(i){const r=new Lc;return await r.initialize(i),r}async request(i){return await this.signer.request(i,this.formatChainId(this.chainId))}sendAsync(i,r){this.signer.sendAsync(i,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(i){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(i);const{required:r,optional:n}=ZE(this.rpc);try{const o=await new Promise(async(p,y)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(C=>{!C.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),y(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Hl(Gs({namespaces:Gs({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:i==null?void 0:i.pairingTopic})).then(C=>{p(C)}).catch(C=>{y(new Error(C.message))})});if(!o)return;const h=nm(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:h),this.setAccounts(h),this.events.emit("connect",{chainId:uc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",i=>{const{params:r}=i,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",i)}),this.signer.on("chainChanged",i=>{const r=parseInt(i);this.chainId=r,this.events.emit("chainChanged",uc(this.chainId)),this.persist()}),this.signer.on("session_update",i=>{this.events.emit("session_update",i)}),this.signer.on("session_delete",i=>{this.reset(),this.events.emit("session_delete",i),this.events.emit("disconnect",Hl(Gs({},tr("USER_DISCONNECTED")),{data:i.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",i=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:i})),this.events.emit("display_uri",i)})}switchEthereumChain(i){this.request({method:"wallet_switchEthereumChain",params:[{chainId:i.toString(16)}]})}isCompatibleChainId(i){return typeof i=="string"?i.startsWith(`${this.namespace}:`):!1}formatChainId(i){return`${this.namespace}:${i}`}parseChainId(i){return Number(i.split(":")[1])}setChainIds(i){const r=i.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",uc(this.chainId)),this.persist())}setChainId(i){if(this.isCompatibleChainId(i)){const r=this.parseChainId(i);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(i){const[r,n,o]=i.split(":");return{chainId:`${r}:${n}`,address:o}}setAccounts(i){this.accounts=i.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(i){var r,n;const o=(r=i==null?void 0:i.chains)!=null?r:[],h=(n=i==null?void 0:i.optionalChains)!=null?n:[],p=o.concat(h);if(!p.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const y=o.length?(i==null?void 0:i.methods)||vc:[],_=o.length?(i==null?void 0:i.events)||mc:[],C=(i==null?void 0:i.optionalMethods)||[],L=(i==null?void 0:i.optionalEvents)||[],k=(i==null?void 0:i.rpcMap)||this.buildRpcMap(p,i.projectId),B=(i==null?void 0:i.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(K=>this.formatChainId(K)),optionalChains:h.map(K=>this.formatChainId(K)),methods:y,events:_,optionalMethods:C,optionalEvents:L,rpcMap:k,showQrModal:!!(i!=null&&i.showQrModal),qrModalOptions:B,projectId:i.projectId,metadata:i.metadata}}buildRpcMap(i,r){const n={};return i.forEach(o=>{n[o]=this.getRpcUrl(o,r)}),n}async initialize(i){if(this.rpc=this.getRpcConfig(i),this.chainId=this.rpc.chains.length?yo(this.rpc.chains):yo(this.rpc.optionalChains),this.signer=await zE.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:i.disableProviderPing,relayUrl:i.relayUrl,storageOptions:i.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await om(()=>import("./index-b76d9f60.js").then(o=>o.i),["assets/index-b76d9f60.js","assets/index-de26da20.js","assets/index-7562716b.css"]);r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Gs({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(i){if(!i)return;const{chains:r,optionalChains:n,rpcMap:o}=i;r&&gs(r)&&(this.rpc.chains=r.map(h=>this.formatChainId(h)),r.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)})),n&&gs(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(h=>this.formatChainId(h)),n.forEach(h=>{this.rpc.rpcMap[h]=(o==null?void 0:o[h])||this.getRpcUrl(h)}))}getRpcUrl(i,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[i])||`${VE}?chainId=eip155:${i}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const i=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${i}`]?this.session.namespaces[`${this.namespace}:${i}`]:this.session.namespaces[this.namespace];this.setChainIds(i?[this.formatChainId(i)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(i){return typeof i=="string"||i instanceof String?[this.parseAccount(i)]:i.map(r=>this.parseAccount(r))}}const ux=Lc;export{ux as EthereumProvider,GE as OPTIONAL_EVENTS,KE as OPTIONAL_METHODS,mc as REQUIRED_EVENTS,vc as REQUIRED_METHODS,Lc as default};
